<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>pandas3ed7</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<link href="../https://assets.qiufei.site/personal/profile.jpg" rel="icon" type="image/jpeg">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-8ea72dc5fed832574809a9c94082fbbb.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-681fbf911679f9b3dbf9743eb275ba49.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-7e49aeac8059a213a463aa1a739e8272.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://qiufei.github.io"> 
<span class="menu-text">È¶ñÈ°µ</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://qiufei.github.io/web-slide"> 
<span class="menu-text">ËØæ‰ª∂</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">```qmd</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>title: ‚ÄúChapter 7: Data Cleaning and Preparation‚Äù author: ‚ÄúYour Name‚Äù format: revealjs: theme: sky slide-number: true show-slide-number: all preview-links: auto</p>
<hr>
<section id="introduction-why-data-cleaning-matters" class="level2">
<h2 class="anchored" data-anchor-id="introduction-why-data-cleaning-matters">Introduction: Why Data Cleaning Matters</h2>
<div class="incremental">
<ul class="incremental">
<li>Data analysis and modeling require significant data preparation.</li>
<li><strong>Loading, cleaning, transforming, and rearranging</strong> data consumes a large portion of an analyst‚Äôs time (often 80% or more! üòÆ).</li>
<li>Data isn‚Äôt always in the right format. Real-world data is messy!</li>
<li>Pandas, combined with Python‚Äôs built-in features, offers powerful tools for data manipulation.</li>
</ul>
</div>
</section>
<section id="introduction-pandas-for-data-manipulation" class="level2">
<h2 class="anchored" data-anchor-id="introduction-pandas-for-data-manipulation">Introduction: Pandas for Data Manipulation</h2>
<ul>
<li>Pandas provides high-level, flexible, and fast tools for data manipulation.</li>
<li>It‚Äôs designed to handle real-world data challenges effectively.</li>
<li>This chapter covers tools for:
<ul>
<li>Handling missing data.</li>
<li>Dealing with duplicate data.</li>
<li>String manipulation.</li>
<li>Other analytical data transformations.</li>
</ul></li>
</ul>
</section>
<section id="handling-missing-data" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-data">7.1 Handling Missing Data</h2>
<ul>
<li>Missing data is common in data analysis.</li>
<li>Pandas aims to make working with missing data as easy as possible.</li>
<li>Descriptive statistics in pandas exclude missing data by default.</li>
<li>Pandas uses <code>NaN</code> (Not a Number), a floating-point value, to represent missing data,especially for <code>float64</code> type.</li>
</ul>
</section>
<section id="handling-missing-data-the-nan-sentinel" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-data-the-nan-sentinel">7.1 Handling Missing Data: The <code>NaN</code> Sentinel</h2>
<div id="85319a67" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>float_data <span class="op">=</span> pd.Series([<span class="fl">1.2</span>, <span class="op">-</span><span class="fl">3.5</span>, np.nan, <span class="dv">0</span>])</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>float_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>0    1.2
1   -3.5
2    NaN
3    0.0
dtype: float64</code></pre>
</div>
</div>
<ul>
<li><code>np.nan</code> is a special floating-point value indicating missing data.</li>
<li>It‚Äôs a <em>sentinel value</em> ‚Äì its presence signals a missing or null value.</li>
</ul>
</section>
<section id="handling-missing-data-detecting-with-.isna" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-data-detecting-with-.isna">7.1 Handling Missing Data: Detecting with <code>.isna()</code></h2>
<div id="296a4f12" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>float_data.isna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>0    False
1    False
2     True
3    False
dtype: bool</code></pre>
</div>
</div>
<ul>
<li>The <code>.isna()</code> method returns a Boolean Series.</li>
<li><code>True</code> indicates a missing value (NaN), and <code>False</code> indicates a non-missing value.</li>
</ul>
</section>
<section id="handling-missing-data-na-convention" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-data-na-convention">7.1 Handling Missing Data: NA Convention</h2>
<ul>
<li>Pandas adopts the R convention: missing data is referred to as <strong>NA</strong> (not available).</li>
<li>NA can mean:
<ul>
<li>Data doesn‚Äôt exist.</li>
<li>Data exists but wasn‚Äôt observed (e.g., data collection issues).</li>
</ul></li>
<li>Analyzing missing data itself can reveal data collection problems or potential biases. ü§î</li>
</ul>
</section>
<section id="handling-missing-data-none-is-also-na" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-data-none-is-also-na">7.1 Handling Missing Data: <code>None</code> is also NA</h2>
<div id="7f3d4a2e" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>string_data <span class="op">=</span> pd.Series([<span class="st">"aardvark"</span>, np.nan, <span class="va">None</span>, <span class="st">"avocado"</span>])</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>string_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>0    aardvark
1         NaN
2        None
3     avocado
dtype: object</code></pre>
</div>
</div>
<div id="d3733d6b" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>string_data.isna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>0    False
1     True
2     True
3    False
dtype: bool</code></pre>
</div>
</div>
<ul>
<li>Python‚Äôs built-in <code>None</code> value is also treated as NA in pandas.</li>
<li>Both string and numeric Series can hold <code>None</code> and <code>NaN</code> as NA.</li>
</ul>
</section>
<section id="handling-missing-data-consistent-handling" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-data-consistent-handling">7.1 Handling Missing Data: Consistent Handling</h2>
<div id="801c5e02" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>float_data <span class="op">=</span> pd.Series([<span class="dv">1</span>, <span class="dv">2</span>, <span class="va">None</span>], dtype<span class="op">=</span><span class="st">'float64'</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>float_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>0    1.0
1    2.0
2    NaN
dtype: float64</code></pre>
</div>
</div>
<div id="6adda7fd" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>float_data.isna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>0    False
1    False
2     True
dtype: bool</code></pre>
</div>
</div>
<ul>
<li>Pandas strives for consistent missing data handling across data types.</li>
<li><code>float_data</code> use <code>NaN</code> represents missing value.</li>
</ul>
</section>
<section id="handling-missing-data-na-handling-methods" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-data-na-handling-methods">7.1 Handling Missing Data: NA Handling Methods</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 92%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>dropna</code></td>
<td style="text-align: left;">Filters out axis labels (rows/columns) based on missing values, with options for thresholds.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>fillna</code></td>
<td style="text-align: left;">Fills in missing data with a specified value or using interpolation methods (e.g., ‚Äúffill‚Äù, ‚Äúbfill‚Äù).</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>isna</code></td>
<td style="text-align: left;">Returns a Boolean array/Series indicating which values are missing/NA.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>notna</code></td>
<td style="text-align: left;">The negation of <code>isna</code>: returns <code>True</code> for non-NA values, <code>False</code> for NA values.</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>These methods provide the foundation for handling missing data in pandas.</p>
</div>
</div>
</section>
<section id="handling-missing-data-dropna-on-series" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-data-dropna-on-series">7.1 Handling Missing Data: <code>dropna</code> on Series</h2>
<div id="677f9d73" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.Series([<span class="dv">1</span>, np.nan, <span class="fl">3.5</span>, np.nan, <span class="dv">7</span>])</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>data.dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>0    1.0
2    3.5
4    7.0
dtype: float64</code></pre>
</div>
</div>
<ul>
<li><code>dropna()</code> on a Series returns a new Series with only non-null data and index labels.</li>
<li>Equivalent to Boolean indexing: <code>data[data.notna()]</code>.</li>
</ul>
</section>
<section id="handling-missing-data-dropna-on-dataframes" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-data-dropna-on-dataframes">7.1 Handling Missing Data: <code>dropna</code> on DataFrames</h2>
<div id="fc7996dd" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame([[<span class="fl">1.</span>, <span class="fl">6.5</span>, <span class="fl">3.</span>], [<span class="fl">1.</span>, np.nan, np.nan],</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                     [np.nan, np.nan, np.nan], [np.nan, <span class="fl">6.5</span>, <span class="fl">3.</span>]])</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.0</td>
<td>6.5</td>
<td>3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>6.5</td>
<td>3.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="213811b1" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>data.dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.0</td>
<td>6.5</td>
<td>3.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>By default, <code>dropna()</code> drops any <em>row</em> containing <em>any</em> NA value.</li>
<li>This can be very strict.</li>
</ul>
</section>
<section id="handling-missing-data-dropna-with-howall" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-data-dropna-with-howall">7.1 Handling Missing Data: <code>dropna</code> with <code>how='all'</code></h2>
<div id="6baf44fa" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>data.dropna(how<span class="op">=</span><span class="st">"all"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.0</td>
<td>6.5</td>
<td>3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>6.5</td>
<td>3.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><code>how="all"</code> drops only rows that are <em>all</em> NA.</li>
<li>More lenient than the default behavior.</li>
</ul>
</section>
<section id="handling-missing-data-dropping-columns" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-data-dropping-columns">7.1 Handling Missing Data: Dropping Columns</h2>
<div id="1039d9da" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>data[<span class="dv">4</span>] <span class="op">=</span> np.nan</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.0</td>
<td>6.5</td>
<td>3.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>6.5</td>
<td>3.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="16f79914" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>data.dropna(axis<span class="op">=</span><span class="st">"columns"</span>, how<span class="op">=</span><span class="st">"all"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.0</td>
<td>6.5</td>
<td>3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>6.5</td>
<td>3.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>To drop columns, use <code>axis="columns"</code> (or <code>axis=1</code>).</li>
<li><code>how="all"</code> with <code>axis="columns"</code> drops columns that are <em>all</em> NA.</li>
</ul>
</section>
<section id="handling-missing-data-dropna-with-thresh" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-data-dropna-with-thresh">7.1 Handling Missing Data: <code>dropna</code> with <code>thresh</code></h2>
<div id="7672df28" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.random.standard_normal((<span class="dv">7</span>, <span class="dv">3</span>)))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df.iloc[:<span class="dv">4</span>, <span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>df.iloc[:<span class="dv">2</span>, <span class="dv">2</span>] <span class="op">=</span> np.nan</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.172337</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.126801</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.226928</td>
<td>NaN</td>
<td>-0.835414</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-1.147772</td>
<td>NaN</td>
<td>0.258556</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.473312</td>
<td>-0.807942</td>
<td>0.149569</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>0.783235</td>
<td>-1.270142</td>
<td>1.006268</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2.002823</td>
<td>2.249397</td>
<td>-1.036528</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="9db2967a" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df.dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.473312</td>
<td>-0.807942</td>
<td>0.149569</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>0.783235</td>
<td>-1.270142</td>
<td>1.006268</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2.002823</td>
<td>2.249397</td>
<td>-1.036528</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="1ee5389f" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df.dropna(thresh<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.226928</td>
<td>NaN</td>
<td>-0.835414</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-1.147772</td>
<td>NaN</td>
<td>0.258556</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.473312</td>
<td>-0.807942</td>
<td>0.149569</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>0.783235</td>
<td>-1.270142</td>
<td>1.006268</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2.002823</td>
<td>2.249397</td>
<td>-1.036528</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>The <code>thresh</code> argument keeps rows with at least <code>thresh</code> non-NA values.</li>
<li>Fine-grained control over which rows to keep.</li>
</ul>
</section>
<section id="handling-missing-data-filling-with-fillna" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-data-filling-with-fillna">7.1 Handling Missing Data: Filling with <code>fillna</code></h2>
<div id="cbcf27ca" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df.fillna(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.172337</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.126801</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.226928</td>
<td>0.000000</td>
<td>-0.835414</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-1.147772</td>
<td>0.000000</td>
<td>0.258556</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.473312</td>
<td>-0.807942</td>
<td>0.149569</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>0.783235</td>
<td>-1.270142</td>
<td>1.006268</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2.002823</td>
<td>2.249397</td>
<td>-1.036528</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><code>fillna(value)</code> replaces all NA values with the specified <code>value</code>.</li>
<li>A common choice is 0, but this depends on the context.</li>
</ul>
</section>
<section id="handling-missing-data-fillna-with-a-dictionary" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-data-fillna-with-a-dictionary">7.1 Handling Missing Data: <code>fillna</code> with a Dictionary</h2>
<div id="fc1fbdca" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df.fillna({<span class="dv">1</span>: <span class="fl">0.5</span>, <span class="dv">2</span>: <span class="dv">0</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.172337</td>
<td>0.500000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.126801</td>
<td>0.500000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.226928</td>
<td>0.500000</td>
<td>-0.835414</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-1.147772</td>
<td>0.500000</td>
<td>0.258556</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.473312</td>
<td>-0.807942</td>
<td>0.149569</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>0.783235</td>
<td>-1.270142</td>
<td>1.006268</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2.002823</td>
<td>2.249397</td>
<td>-1.036528</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>Use a dictionary to specify different fill values for each column.</li>
<li>The dictionary keys are column labels; values are the fill values.</li>
</ul>
</section>
<section id="handling-missing-data-interpolation-with-fillna" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-data-interpolation-with-fillna">7.1 Handling Missing Data: Interpolation with <code>fillna</code></h2>
<div id="e2826a8e" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.random.standard_normal((<span class="dv">6</span>, <span class="dv">3</span>)))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>df.iloc[<span class="dv">2</span>:, <span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>df.iloc[<span class="dv">4</span>:, <span class="dv">2</span>] <span class="op">=</span> np.nan</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.747697</td>
<td>-1.094361</td>
<td>-0.150607</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.229561</td>
<td>0.806236</td>
<td>-0.739724</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.112941</td>
<td>NaN</td>
<td>-0.936409</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.294874</td>
<td>NaN</td>
<td>-1.449678</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.860861</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-0.040511</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="066118b3" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df.fillna(method<span class="op">=</span><span class="st">"ffill"</span>) <span class="co"># Forward fill</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_2635/64151187.py:1: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method="ffill") # Forward fill</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.747697</td>
<td>-1.094361</td>
<td>-0.150607</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.229561</td>
<td>0.806236</td>
<td>-0.739724</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.112941</td>
<td>0.806236</td>
<td>-0.936409</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.294874</td>
<td>0.806236</td>
<td>-1.449678</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.860861</td>
<td>0.806236</td>
<td>-1.449678</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-0.040511</td>
<td>0.806236</td>
<td>-1.449678</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><code>method="ffill"</code> (forward fill) propagates the last valid observation forward.</li>
<li><code>method="bfill"</code> (backward fill) uses the next valid observation to fill the gap.</li>
<li>Suitable for time series or ordered data.</li>
</ul>
</section>
<section id="handling-missing-data-fillna-with-limit" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-data-fillna-with-limit">7.1 Handling Missing Data: <code>fillna</code> with <code>limit</code></h2>
<div id="91315de6" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df.fillna(method<span class="op">=</span><span class="st">"ffill"</span>, limit<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_2635/1627181726.py:1: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method="ffill", limit=2)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.747697</td>
<td>-1.094361</td>
<td>-0.150607</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.229561</td>
<td>0.806236</td>
<td>-0.739724</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.112941</td>
<td>0.806236</td>
<td>-0.936409</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.294874</td>
<td>0.806236</td>
<td>-1.449678</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.860861</td>
<td>NaN</td>
<td>-1.449678</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-0.040511</td>
<td>NaN</td>
<td>-1.449678</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><code>limit</code> restricts the number of consecutive NA values filled by <code>ffill</code> or <code>bfill</code>.</li>
</ul>
</section>
<section id="handling-missing-data-imputation-with-fillna" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-data-imputation-with-fillna">7.1 Handling Missing Data: Imputation with <code>fillna</code></h2>
<div id="96ef739e" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.Series([<span class="fl">1.</span>, np.nan, <span class="fl">3.5</span>, np.nan, <span class="dv">7</span>])</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>data.fillna(data.mean())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>0    1.000000
1    3.833333
2    3.500000
3    3.833333
4    7.000000
dtype: float64</code></pre>
</div>
</div>
<ul>
<li>Replace missing values with the mean, median, or other statistics.</li>
<li>This is a simple form of <em>imputation</em>.</li>
</ul>
</section>
<section id="data-transformation" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation">7.2 Data Transformation</h2>
<ul>
<li>Filtering and cleaning are essential, but data often needs further transformation.</li>
<li>This section covers:
<ul>
<li>Removing duplicates.</li>
<li>Transforming data using functions or mappings.</li>
<li>Replacing values.</li>
<li>Renaming axis indexes.</li>
<li>Discretization and binning.</li>
<li>Detecting and filtering outliers.</li>
<li>Permutation and random sampling.</li>
<li>Computing indicator/dummy variables.</li>
</ul></li>
</ul>
</section>
<section id="data-transformation-removing-duplicates" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-removing-duplicates">7.2 Data Transformation: Removing Duplicates</h2>
<div id="e090e635" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame({<span class="st">"k1"</span>: [<span class="st">"one"</span>, <span class="st">"two"</span>] <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> [<span class="st">"two"</span>],</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"k2"</span>: [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>]})</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">k1</th>
<th data-quarto-table-cell-role="th">k2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>one</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>two</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>one</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>two</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>one</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>two</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>two</td>
<td>4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>Duplicate rows can occur for various reasons.</li>
</ul>
</section>
<section id="data-transformation-identifying-duplicates-with-duplicated" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-identifying-duplicates-with-duplicated">7.2 Data Transformation: Identifying Duplicates with <code>duplicated()</code></h2>
<div id="a5e60702" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>data.duplicated()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>0    False
1    False
2    False
3    False
4    False
5    False
6     True
dtype: bool</code></pre>
</div>
</div>
<ul>
<li><code>duplicated()</code> returns a Boolean Series indicating whether each row is a duplicate (has appeared earlier).</li>
</ul>
</section>
<section id="data-transformation-removing-duplicates-with-drop_duplicates" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-removing-duplicates-with-drop_duplicates">7.2 Data Transformation: Removing Duplicates with <code>drop_duplicates()</code></h2>
<div id="7b5e4f49" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>data.drop_duplicates()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">k1</th>
<th data-quarto-table-cell-role="th">k2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>one</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>two</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>one</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>two</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>one</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>two</td>
<td>4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><code>drop_duplicates()</code> returns a DataFrame with duplicate rows removed.</li>
<li>Keeps the <em>first</em> occurrence of each unique row.</li>
</ul>
</section>
<section id="data-transformation-drop_duplicates-on-a-subset-of-columns" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-drop_duplicates-on-a-subset-of-columns">7.2 Data Transformation: <code>drop_duplicates()</code> on a Subset of Columns</h2>
<div id="fa81fd50" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"v1"</span>] <span class="op">=</span> <span class="bu">range</span>(<span class="dv">7</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">k1</th>
<th data-quarto-table-cell-role="th">k2</th>
<th data-quarto-table-cell-role="th">v1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>one</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>two</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>one</td>
<td>2</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>two</td>
<td>3</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>one</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>two</td>
<td>4</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>two</td>
<td>4</td>
<td>6</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="657579b0" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>data.drop_duplicates(subset<span class="op">=</span>[<span class="st">"k1"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">k1</th>
<th data-quarto-table-cell-role="th">k2</th>
<th data-quarto-table-cell-role="th">v1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>one</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>two</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>Specify a subset of columns to check for duplicates using the <code>subset</code> argument.</li>
<li>Here, only the <code>"k1"</code> column is considered.</li>
</ul>
</section>
<section id="data-transformation-drop_duplicates-with-keeplast" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-drop_duplicates-with-keeplast">7.2 Data Transformation: <code>drop_duplicates()</code> with <code>keep='last'</code></h2>
<div id="ad34f8cb" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>data.drop_duplicates([<span class="st">"k1"</span>, <span class="st">"k2"</span>], keep<span class="op">=</span><span class="st">"last"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">k1</th>
<th data-quarto-table-cell-role="th">k2</th>
<th data-quarto-table-cell-role="th">v1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>one</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>two</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>one</td>
<td>2</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>two</td>
<td>3</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>one</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>two</td>
<td>4</td>
<td>6</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><code>keep="last"</code> keeps the <em>last</em> occurrence of each unique row (or combination of columns).</li>
<li>The default is <code>keep="first"</code>.</li>
</ul>
</section>
<section id="data-transformation-transforming-data-using-a-function-or-mapping" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-transforming-data-using-a-function-or-mapping">7.2 Data Transformation: Transforming Data Using a Function or Mapping</h2>
<div id="b35b1cec" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame({<span class="st">"food"</span>: [<span class="st">"bacon"</span>, <span class="st">"pulled pork"</span>, <span class="st">"bacon"</span>,</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"pastrami"</span>, <span class="st">"corned beef"</span>, <span class="st">"bacon"</span>,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"pastrami"</span>, <span class="st">"honey ham"</span>, <span class="st">"nova lox"</span>],</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"ounces"</span>: [<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">12</span>, <span class="dv">6</span>, <span class="fl">7.5</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>]})</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">food</th>
<th data-quarto-table-cell-role="th">ounces</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>bacon</td>
<td>4.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>pulled pork</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>bacon</td>
<td>12.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>pastrami</td>
<td>6.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>corned beef</td>
<td>7.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>bacon</td>
<td>8.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>pastrami</td>
<td>3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>honey ham</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>nova lox</td>
<td>6.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>Suppose we want to add a column indicating the animal type for each food.</li>
</ul>
</section>
<section id="data-transformation-using-a-mapping-dictionary" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-using-a-mapping-dictionary">7.2 Data Transformation: Using a Mapping Dictionary</h2>
<div id="7c191ff1" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>meat_to_animal <span class="op">=</span> {</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"bacon"</span>: <span class="st">"pig"</span>,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pulled pork"</span>: <span class="st">"pig"</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pastrami"</span>: <span class="st">"cow"</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"corned beef"</span>: <span class="st">"cow"</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"honey ham"</span>: <span class="st">"pig"</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"nova lox"</span>: <span class="st">"salmon"</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Create a dictionary mapping each food to its corresponding animal.</li>
</ul>
</section>
<section id="data-transformation-using-.map" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-using-.map">7.2 Data Transformation: Using <code>.map()</code></h2>
<div id="9dfc806b" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"animal"</span>] <span class="op">=</span> data[<span class="st">"food"</span>].<span class="bu">map</span>(meat_to_animal)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">food</th>
<th data-quarto-table-cell-role="th">ounces</th>
<th data-quarto-table-cell-role="th">animal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>bacon</td>
<td>4.0</td>
<td>pig</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>pulled pork</td>
<td>3.0</td>
<td>pig</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>bacon</td>
<td>12.0</td>
<td>pig</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>pastrami</td>
<td>6.0</td>
<td>cow</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>corned beef</td>
<td>7.5</td>
<td>cow</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>bacon</td>
<td>8.0</td>
<td>pig</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>pastrami</td>
<td>3.0</td>
<td>cow</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>honey ham</td>
<td>5.0</td>
<td>pig</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>nova lox</td>
<td>6.0</td>
<td>salmon</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>The <code>.map()</code> method of a Series accepts a function or a dictionary-like object (like our mapping).</li>
<li>It applies the mapping to each element of the Series.</li>
</ul>
</section>
<section id="data-transformation-using-a-function-with-.map" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-using-a-function-with-.map">7.2 Data Transformation: Using a Function with <code>.map()</code></h2>
<div id="d24e0f08" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_animal(x):</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> meat_to_animal[x]</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"food"</span>].<span class="bu">map</span>(get_animal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>0       pig
1       pig
2       pig
3       cow
4       cow
5       pig
6       cow
7       pig
8    salmon
Name: food, dtype: object</code></pre>
</div>
</div>
<ul>
<li>We could also use a function with <code>.map()</code>.</li>
<li>The function takes a single element from the Series as input and returns the transformed value.</li>
</ul>
</section>
<section id="data-transformation-replacing-values" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-replacing-values">7.2 Data Transformation: Replacing Values</h2>
<div id="7d013c87" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.Series([<span class="fl">1.</span>, <span class="op">-</span><span class="fl">999.</span>, <span class="fl">2.</span>, <span class="op">-</span><span class="fl">999.</span>, <span class="op">-</span><span class="fl">1000.</span>, <span class="fl">3.</span>])</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>0       1.0
1    -999.0
2       2.0
3    -999.0
4   -1000.0
5       3.0
dtype: float64</code></pre>
</div>
</div>
<ul>
<li>Suppose -999 and -1000 are sentinel values for missing data.</li>
</ul>
</section>
<section id="data-transformation-replace-for-single-value" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-replace-for-single-value">7.2 Data Transformation: <code>replace()</code> for Single Value</h2>
<div id="cb5bec88" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>data.replace(<span class="op">-</span><span class="dv">999</span>, np.nan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>0       1.0
1       NaN
2       2.0
3       NaN
4   -1000.0
5       3.0
dtype: float64</code></pre>
</div>
</div>
<ul>
<li><code>replace(old_value, new_value)</code> replaces occurrences of <code>old_value</code> with <code>new_value</code>.</li>
</ul>
</section>
<section id="data-transformation-replace-for-multiple-values" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-replace-for-multiple-values">7.2 Data Transformation: <code>replace()</code> for Multiple Values</h2>
<div id="636f71ab" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>data.replace([<span class="op">-</span><span class="dv">999</span>, <span class="op">-</span><span class="dv">1000</span>], np.nan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>0    1.0
1    NaN
2    2.0
3    NaN
4    NaN
5    3.0
dtype: float64</code></pre>
</div>
</div>
<ul>
<li>Pass a list of old values to replace multiple values at once.</li>
</ul>
</section>
<section id="data-transformation-different-replacements-for-each-value" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-different-replacements-for-each-value">7.2 Data Transformation: Different Replacements for Each Value</h2>
<div id="e24fca25" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>data.replace([<span class="op">-</span><span class="dv">999</span>, <span class="op">-</span><span class="dv">1000</span>], [np.nan, <span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>0    1.0
1    NaN
2    2.0
3    NaN
4    0.0
5    3.0
dtype: float64</code></pre>
</div>
</div>
<ul>
<li>Provide a list of replacement values corresponding to the list of old values.</li>
</ul>
</section>
<section id="data-transformation-using-a-dictionary-with-replace" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-using-a-dictionary-with-replace">7.2 Data Transformation: Using a Dictionary with <code>replace()</code></h2>
<div id="d1e68aa8" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>data.replace({<span class="op">-</span><span class="dv">999</span>: np.nan, <span class="op">-</span><span class="dv">1000</span>: <span class="dv">0</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>0    1.0
1    NaN
2    2.0
3    NaN
4    0.0
5    3.0
dtype: float64</code></pre>
</div>
</div>
<ul>
<li>A dictionary can also be used with <code>replace()</code>.</li>
<li>Keys are old values; values are new values.</li>
</ul>
</section>
<section id="data-transformation-renaming-axis-indexes" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-renaming-axis-indexes">7.2 Data Transformation: Renaming Axis Indexes</h2>
<div id="8f72bbb1" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame(np.arange(<span class="dv">12</span>).reshape((<span class="dv">3</span>, <span class="dv">4</span>)),</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                    index<span class="op">=</span>[<span class="st">"Ohio"</span>, <span class="st">"Colorado"</span>, <span class="st">"New York"</span>],</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                    columns<span class="op">=</span>[<span class="st">"one"</span>, <span class="st">"two"</span>, <span class="st">"three"</span>, <span class="st">"four"</span>])</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">one</th>
<th data-quarto-table-cell-role="th">two</th>
<th data-quarto-table-cell-role="th">three</th>
<th data-quarto-table-cell-role="th">four</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Ohio</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Colorado</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">New York</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>Axis labels (row and column indexes) can also be transformed.</li>
</ul>
</section>
<section id="data-transformation-modifying-indexes-with-.map" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-modifying-indexes-with-.map">7.2 Data Transformation: Modifying Indexes with <code>.map()</code></h2>
<div id="2d4f8995" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> transform(x):</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x[:<span class="dv">4</span>].upper()</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>data.index.<span class="bu">map</span>(transform)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>Index(['OHIO', 'COLO', 'NEW '], dtype='object')</code></pre>
</div>
</div>
<div id="05a6ee5c" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>data.index <span class="op">=</span> data.index.<span class="bu">map</span>(transform)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">one</th>
<th data-quarto-table-cell-role="th">two</th>
<th data-quarto-table-cell-role="th">three</th>
<th data-quarto-table-cell-role="th">four</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">OHIO</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">COLO</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">NEW</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>Like Series, axis indexes have a <code>.map()</code> method.</li>
<li>We apply a function to transform each index label.</li>
<li>Assigning to <code>data.index</code> modifies the DataFrame in place.</li>
</ul>
</section>
<section id="data-transformation-rename-for-creating-a-transformed-copy" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-rename-for-creating-a-transformed-copy">7.2 Data Transformation: <code>rename()</code> for Creating a Transformed Copy</h2>
<div id="6b8ffc08" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>data.rename(index<span class="op">=</span><span class="bu">str</span>.title, columns<span class="op">=</span><span class="bu">str</span>.upper)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ONE</th>
<th data-quarto-table-cell-role="th">TWO</th>
<th data-quarto-table-cell-role="th">THREE</th>
<th data-quarto-table-cell-role="th">FOUR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Ohio</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Colo</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">New</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><code>rename()</code> creates a <em>transformed copy</em> without modifying the original DataFrame.</li>
<li><code>index</code> and <code>columns</code> arguments can take functions, dictionaries, or Series.</li>
</ul>
</section>
<section id="data-transformation-rename-with-a-dictionary" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-rename-with-a-dictionary">7.2 Data Transformation: <code>rename()</code> with a Dictionary</h2>
<div id="393cdb43" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>data.rename(index<span class="op">=</span>{<span class="st">"OHIO"</span>: <span class="st">"INDIANA"</span>},</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>            columns<span class="op">=</span>{<span class="st">"three"</span>: <span class="st">"peekaboo"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">one</th>
<th data-quarto-table-cell-role="th">two</th>
<th data-quarto-table-cell-role="th">peekaboo</th>
<th data-quarto-table-cell-role="th">four</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">INDIANA</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">COLO</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">NEW</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>Use dictionaries with <code>rename()</code> to modify a subset of axis labels.</li>
</ul>
</section>
<section id="data-transformation-discretization-and-binning" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-discretization-and-binning">7.2 Data Transformation: Discretization and Binning</h2>
<ul>
<li>Continuous data is often discretized or binned for analysis.</li>
<li>Example: Grouping ages into age ranges.</li>
</ul>
<div id="c9b25642" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>ages <span class="op">=</span> [<span class="dv">20</span>, <span class="dv">22</span>, <span class="dv">25</span>, <span class="dv">27</span>, <span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">37</span>, <span class="dv">31</span>, <span class="dv">61</span>, <span class="dv">45</span>, <span class="dv">41</span>, <span class="dv">32</span>]</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> [<span class="dv">18</span>, <span class="dv">25</span>, <span class="dv">35</span>, <span class="dv">60</span>, <span class="dv">100</span>]  <span class="co"># Define bin edges</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>age_categories <span class="op">=</span> pd.cut(ages, bins)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>age_categories</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>[(18, 25], (18, 25], (18, 25], (25, 35], (18, 25], ..., (25, 35], (60, 100], (35, 60], (35, 60], (25, 35]]
Length: 12
Categories (4, interval[int64, right]): [(18, 25] &lt; (25, 35] &lt; (35, 60] &lt; (60, 100]]</code></pre>
</div>
</div>
<ul>
<li><code>pd.cut(data, bins)</code> divides the data into bins based on the specified <code>bins</code> edges.</li>
<li>Returns a special <code>Categorical</code> object.</li>
</ul>
</section>
<section id="data-transformation-understanding-the-categorical-object" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-understanding-the-categorical-object">7.2 Data Transformation: Understanding the <code>Categorical</code> Object</h2>
<div id="fd992236" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>age_categories.codes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>array([0, 0, 0, 1, 0, 0, 2, 1, 3, 2, 2, 1], dtype=int8)</code></pre>
</div>
</div>
<div id="4954bb9a" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>age_categories.categories</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>IntervalIndex([(18, 25], (25, 35], (35, 60], (60, 100]], dtype='interval[int64, right]')</code></pre>
</div>
</div>
<div id="d9be35f9" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>age_categories.categories[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>Interval(18, 25, closed='right')</code></pre>
</div>
</div>
<ul>
<li><code>codes</code>: An array of integers representing the bin each value belongs to (starting from 0).</li>
<li><code>categories</code>: An <code>IntervalIndex</code> object holding the bin intervals.</li>
</ul>
</section>
<section id="data-transformation-value_counts-on-categorical" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-value_counts-on-categorical">7.2 Data Transformation: <code>value_counts()</code> on <code>Categorical</code></h2>
<div id="2a02f9f2" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>pd.value_counts(age_categories)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_2635/3010498523.py:1: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  pd.value_counts(age_categories)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>(18, 25]     5
(25, 35]     3
(35, 60]     3
(60, 100]    1
Name: count, dtype: int64</code></pre>
</div>
</div>
<ul>
<li><code>pd.value_counts(categorical)</code> gives the bin counts for the result of <code>pd.cut()</code>.</li>
</ul>
</section>
<section id="data-transformation-open-vs.-closed-intervals" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-open-vs.-closed-intervals">7.2 Data Transformation: Open vs.&nbsp;Closed Intervals</h2>
<ul>
<li>Parentheses <code>()</code> mean the side is <em>open</em> (exclusive).</li>
<li>Square brackets <code>[]</code> mean the side is <em>closed</em> (inclusive).</li>
<li><code>(18, 25]</code> means ‚Äúgreater than 18, up to and including 25.‚Äù</li>
</ul>
<div id="9cff8c8b" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>pd.cut(ages, bins, right<span class="op">=</span><span class="va">False</span>) <span class="co"># Change which side is closed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>[[18, 25), [18, 25), [25, 35), [25, 35), [18, 25), ..., [25, 35), [60, 100), [35, 60), [35, 60), [25, 35)]
Length: 12
Categories (4, interval[int64, left]): [[18, 25) &lt; [25, 35) &lt; [35, 60) &lt; [60, 100)]</code></pre>
</div>
</div>
<ul>
<li><code>right=False</code> changes the closed side of the interval.</li>
</ul>
</section>
<section id="data-transformation-labeling-bins" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-labeling-bins">7.2 Data Transformation: Labeling Bins</h2>
<div id="d787626c" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>group_names <span class="op">=</span> [<span class="st">"Youth"</span>, <span class="st">"YoungAdult"</span>, <span class="st">"MiddleAged"</span>, <span class="st">"Senior"</span>]</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>pd.cut(ages, bins, labels<span class="op">=</span>group_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>['Youth', 'Youth', 'Youth', 'YoungAdult', 'Youth', ..., 'YoungAdult', 'Senior', 'MiddleAged', 'MiddleAged', 'YoungAdult']
Length: 12
Categories (4, object): ['Youth' &lt; 'YoungAdult' &lt; 'MiddleAged' &lt; 'Senior']</code></pre>
</div>
</div>
<ul>
<li><code>labels</code> argument assigns custom names to the bins.</li>
<li>More informative than the default interval labels.</li>
</ul>
</section>
<section id="data-transformation-pd.cut-with-number-of-bins" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-pd.cut-with-number-of-bins">7.2 Data Transformation: <code>pd.cut()</code> with Number of Bins</h2>
<div id="35758980" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.random.uniform(size<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>pd.cut(data, <span class="dv">4</span>, precision<span class="op">=</span><span class="dv">2</span>) <span class="co"># Cut into 4 equal-length bins</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>[(0.45, 0.68], (0.68, 0.9], (0.68, 0.9], (0.005, 0.23], (0.68, 0.9], ..., (0.45, 0.68], (0.45, 0.68], (0.45, 0.68], (0.45, 0.68], (0.68, 0.9]]
Length: 20
Categories (4, interval[float64, right]): [(0.005, 0.23] &lt; (0.23, 0.45] &lt; (0.45, 0.68] &lt; (0.68, 0.9]]</code></pre>
</div>
</div>
<ul>
<li>Pass an integer number of bins to <code>pd.cut()</code> to compute equal-length bins based on min/max values.</li>
<li><code>precision</code> limits the decimal precision of the bin labels.</li>
</ul>
</section>
<section id="data-transformation-pd.qcut-for-quantile-binning" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-pd.qcut-for-quantile-binning">7.2 Data Transformation: <code>pd.qcut()</code> for Quantile Binning</h2>
<div id="8dd5759a" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.random.standard_normal(<span class="dv">1000</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>quartiles <span class="op">=</span> pd.qcut(data, <span class="dv">4</span>, precision<span class="op">=</span><span class="dv">2</span>)  <span class="co"># Cut into quartiles</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>quartiles</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>[(-0.031, 0.66], (-0.77, -0.031], (-2.8899999999999997, -0.77], (-2.8899999999999997, -0.77], (-2.8899999999999997, -0.77], ..., (-0.77, -0.031], (-0.77, -0.031], (0.66, 3.92], (-2.8899999999999997, -0.77], (-2.8899999999999997, -0.77]]
Length: 1000
Categories (4, interval[float64, right]): [(-2.8899999999999997, -0.77] &lt; (-0.77, -0.031] &lt; (-0.031, 0.66] &lt; (0.66, 3.92]]</code></pre>
</div>
</div>
<ul>
<li><code>pd.qcut()</code> bins data based on <em>sample quantiles</em>.</li>
<li>Aims for (roughly) equal-sized bins.</li>
<li>Useful for dividing data into percentiles.</li>
</ul>
</section>
<section id="data-transformation-pd.qcut-with-custom-quantiles" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-pd.qcut-with-custom-quantiles">7.2 Data Transformation: <code>pd.qcut()</code> with Custom Quantiles</h2>
<div id="42504dca" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>pd.qcut(data, [<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>, <span class="fl">1.</span>]).value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>(-2.8819999999999997, -1.276]    100
(-1.276, -0.0312]                400
(-0.0312, 1.294]                 400
(1.294, 3.916]                   100
Name: count, dtype: int64</code></pre>
</div>
</div>
<ul>
<li>Pass custom quantiles (values between 0 and 1) to <code>pd.qcut()</code>.</li>
<li>Example: Dividing into deciles (0.1, 0.2, ‚Ä¶, 0.9).</li>
</ul>
</section>
<section id="data-transformation-detecting-and-filtering-outliers" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-detecting-and-filtering-outliers">7.2 Data Transformation: Detecting and Filtering Outliers</h2>
<ul>
<li>Outlier filtering/transformation is often an array operation.</li>
</ul>
<div id="78d560f3" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame(np.random.standard_normal((<span class="dv">1000</span>, <span class="dv">4</span>)))</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>data.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>1000.000000</td>
<td>1000.000000</td>
<td>1000.000000</td>
<td>1000.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>0.033010</td>
<td>0.056401</td>
<td>-0.052707</td>
<td>-0.049544</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.954727</td>
<td>1.017465</td>
<td>0.985551</td>
<td>0.994715</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>-2.808208</td>
<td>-3.087440</td>
<td>-2.873478</td>
<td>-3.123682</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>-0.585381</td>
<td>-0.645806</td>
<td>-0.749786</td>
<td>-0.737607</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>-0.020575</td>
<td>0.061019</td>
<td>-0.033416</td>
<td>-0.036930</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>0.631171</td>
<td>0.750258</td>
<td>0.615955</td>
<td>0.642344</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>3.037782</td>
<td>3.009782</td>
<td>2.775777</td>
<td>3.235134</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>Example DataFrame with normally distributed data.</li>
</ul>
</section>
<section id="data-transformation-finding-values-exceeding-a-threshold" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-finding-values-exceeding-a-threshold">7.2 Data Transformation: Finding Values Exceeding a Threshold</h2>
<div id="4bae7529" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> data[<span class="dv">2</span>]</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>col[col.<span class="bu">abs</span>() <span class="op">&gt;</span> <span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>Series([], Name: 2, dtype: float64)</code></pre>
</div>
</div>
<ul>
<li>Find values in column 2 with an absolute value greater than 3.</li>
</ul>
</section>
<section id="data-transformation-selecting-rows-based-on-outliers" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-selecting-rows-based-on-outliers">7.2 Data Transformation: Selecting Rows Based on Outliers</h2>
<div id="0c3c4cae" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>data[(data.<span class="bu">abs</span>() <span class="op">&gt;</span> <span class="dv">3</span>).<span class="bu">any</span>(axis<span class="op">=</span><span class="st">"columns"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">271</td>
<td>-0.756527</td>
<td>-3.087440</td>
<td>-0.113955</td>
<td>1.595461</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">335</td>
<td>0.245135</td>
<td>3.009782</td>
<td>0.421811</td>
<td>-1.247871</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">428</td>
<td>-0.655529</td>
<td>2.288183</td>
<td>0.948956</td>
<td>-3.123682</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">455</td>
<td>3.037782</td>
<td>-1.050033</td>
<td>1.124002</td>
<td>0.042943</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">480</td>
<td>-0.911604</td>
<td>-0.695740</td>
<td>0.096534</td>
<td>3.064375</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">523</td>
<td>0.295908</td>
<td>0.908946</td>
<td>0.040304</td>
<td>3.023940</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">614</td>
<td>-0.176705</td>
<td>-3.017098</td>
<td>0.785747</td>
<td>-1.239167</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">667</td>
<td>2.169624</td>
<td>-1.567369</td>
<td>0.204976</td>
<td>3.235134</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><code>data.abs() &gt; 3</code>: Boolean DataFrame indicating values exceeding 3 or -3.</li>
<li><code>any(axis="columns")</code>: Checks if <em>any</em> value in a row is <code>True</code>.</li>
<li>Selects all rows containing at least one outlier value.</li>
</ul>
</section>
<section id="data-transformation-capping-values" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-capping-values">7.2 Data Transformation: Capping Values</h2>
<div id="c02cf8fc" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>data[data.<span class="bu">abs</span>() <span class="op">&gt;</span> <span class="dv">3</span>] <span class="op">=</span> np.sign(data) <span class="op">*</span> <span class="dv">3</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>data.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>1000.000000</td>
<td>1000.000000</td>
<td>1000.000000</td>
<td>1000.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>0.032972</td>
<td>0.056496</td>
<td>-0.052707</td>
<td>-0.049744</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.954609</td>
<td>1.017118</td>
<td>0.985551</td>
<td>0.993316</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>-2.808208</td>
<td>-3.000000</td>
<td>-2.873478</td>
<td>-3.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>-0.585381</td>
<td>-0.645806</td>
<td>-0.749786</td>
<td>-0.737607</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>-0.020575</td>
<td>0.061019</td>
<td>-0.033416</td>
<td>-0.036930</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>0.631171</td>
<td>0.750258</td>
<td>0.615955</td>
<td>0.642344</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>3.000000</td>
<td>3.000000</td>
<td>2.775777</td>
<td>3.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><code>np.sign(data)</code>: Returns -1 for negative values, 1 for positive values.</li>
<li>Cap values outside the interval [-3, 3] to -3 and 3.</li>
</ul>
</section>
<section id="data-transformation-permutation-and-random-sampling" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-permutation-and-random-sampling">7.2 Data Transformation: Permutation and Random Sampling</h2>
<ul>
<li>Permuting (randomly reordering) rows or columns.</li>
<li>Selecting a random subset of data.</li>
</ul>
<div id="f1e53a79" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.arange(<span class="dv">5</span> <span class="op">*</span> <span class="dv">7</span>).reshape((<span class="dv">5</span>, <span class="dv">7</span>)))</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
<td>13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>14</td>
<td>15</td>
<td>16</td>
<td>17</td>
<td>18</td>
<td>19</td>
<td>20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>21</td>
<td>22</td>
<td>23</td>
<td>24</td>
<td>25</td>
<td>26</td>
<td>27</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>28</td>
<td>29</td>
<td>30</td>
<td>31</td>
<td>32</td>
<td>33</td>
<td>34</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>Create a sample DataFrame.</li>
</ul>
</section>
<section id="data-transformation-permuting-rows-with-permutation" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-permuting-rows-with-permutation">7.2 Data Transformation: Permuting Rows with <code>permutation()</code></h2>
<div id="30064906" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> np.random.permutation(<span class="dv">5</span>) <span class="co"># Random permutation of integers 0-4</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>sampler</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>array([4, 2, 1, 3, 0])</code></pre>
</div>
</div>
<div id="e1b76f44" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>df.take(sampler)  <span class="co"># or df.iloc[sampler]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>28</td>
<td>29</td>
<td>30</td>
<td>31</td>
<td>32</td>
<td>33</td>
<td>34</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>14</td>
<td>15</td>
<td>16</td>
<td>17</td>
<td>18</td>
<td>19</td>
<td>20</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
<td>13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>21</td>
<td>22</td>
<td>23</td>
<td>24</td>
<td>25</td>
<td>26</td>
<td>27</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><code>np.random.permutation(n)</code> generates a random permutation of integers 0 to n-1.</li>
<li><code>take()</code> or <code>iloc[]</code> can be used with the permutation to reorder rows.</li>
</ul>
</section>
<section id="data-transformation-permuting-columns" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-permuting-columns">7.2 Data Transformation: Permuting Columns</h2>
<div id="c3ccba38" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>column_sampler <span class="op">=</span> np.random.permutation(<span class="dv">7</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>column_sampler</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>array([4, 3, 2, 6, 1, 0, 5])</code></pre>
</div>
</div>
<div id="efcf8ae9" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>df.take(column_sampler, axis<span class="op">=</span><span class="st">"columns"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>4</td>
<td>3</td>
<td>2</td>
<td>6</td>
<td>1</td>
<td>0</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>11</td>
<td>10</td>
<td>9</td>
<td>13</td>
<td>8</td>
<td>7</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>18</td>
<td>17</td>
<td>16</td>
<td>20</td>
<td>15</td>
<td>14</td>
<td>19</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>25</td>
<td>24</td>
<td>23</td>
<td>27</td>
<td>22</td>
<td>21</td>
<td>26</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>32</td>
<td>31</td>
<td>30</td>
<td>34</td>
<td>29</td>
<td>28</td>
<td>33</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>Permute columns similarly, using <code>axis="columns"</code> with <code>take()</code>.</li>
</ul>
</section>
<section id="data-transformation-random-sampling-without-replacement" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-random-sampling-without-replacement">7.2 Data Transformation: Random Sampling without Replacement</h2>
<div id="cefdd698" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>df.sample(n<span class="op">=</span><span class="dv">3</span>)  <span class="co"># Select 3 random rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
<td>13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>28</td>
<td>29</td>
<td>30</td>
<td>31</td>
<td>32</td>
<td>33</td>
<td>34</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>21</td>
<td>22</td>
<td>23</td>
<td>24</td>
<td>25</td>
<td>26</td>
<td>27</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><code>sample(n=k)</code> selects <code>k</code> random rows <em>without</em> replacement.</li>
</ul>
</section>
<section id="data-transformation-random-sampling-with-replacement" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-random-sampling-with-replacement">7.2 Data Transformation: Random Sampling with Replacement</h2>
<div id="5a32ab38" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>choices <span class="op">=</span> pd.Series([<span class="dv">5</span>, <span class="dv">7</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">4</span>])</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>choices.sample(n<span class="op">=</span><span class="dv">10</span>, replace<span class="op">=</span><span class="va">True</span>) <span class="co"># Sample with replacement</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>4    4
2   -1
1    7
1    7
2   -1
1    7
4    4
2   -1
2   -1
2   -1
dtype: int64</code></pre>
</div>
</div>
<ul>
<li><code>replace=True</code> allows sampling <em>with</em> replacement (the same row can be chosen multiple times).</li>
</ul>
</section>
<section id="data-transformation-computing-indicatordummy-variables" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-computing-indicatordummy-variables">7.2 Data Transformation: Computing Indicator/Dummy Variables</h2>
<ul>
<li>Converting a categorical variable into a ‚Äúdummy‚Äù or ‚Äúindicator‚Äù matrix.</li>
<li>Used in statistical modeling and machine learning.</li>
</ul>
<div id="0ab730dc" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">"key"</span>: [<span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"c"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>],</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"data1"</span>: <span class="bu">range</span>(<span class="dv">6</span>)})</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">data1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>b</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>b</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>a</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>c</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>a</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>b</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>Example DataFrame with a categorical column ‚Äúkey‚Äù.</li>
</ul>
</section>
<section id="data-transformation-get_dummies" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-get_dummies">7.2 Data Transformation: <code>get_dummies()</code></h2>
<div id="2b1cdf5d" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>pd.get_dummies(df[<span class="st">"key"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
<th data-quarto-table-cell-role="th">c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><code>pd.get_dummies(categorical_column)</code> creates a DataFrame where:
<ul>
<li>Each unique value in the original column becomes a new column.</li>
<li>Values are 1 if the original row had that category, 0 otherwise.</li>
</ul></li>
</ul>
</section>
<section id="data-transformation-adding-a-prefix-to-dummy-variables" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-adding-a-prefix-to-dummy-variables">7.2 Data Transformation: Adding a Prefix to Dummy Variables</h2>
<div id="9dda2371" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>dummies <span class="op">=</span> pd.get_dummies(df[<span class="st">"key"</span>], prefix<span class="op">=</span><span class="st">"key"</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>df_with_dummy <span class="op">=</span> df[[<span class="st">"data1"</span>]].join(dummies)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>df_with_dummy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">data1</th>
<th data-quarto-table-cell-role="th">key_a</th>
<th data-quarto-table-cell-role="th">key_b</th>
<th data-quarto-table-cell-role="th">key_c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>5</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><code>prefix</code> argument adds a prefix to the dummy variable column names.</li>
<li>Useful when joining with the original DataFrame.</li>
</ul>
</section>
<section id="data-transformation-handling-multiple-categories-movielens-example" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-handling-multiple-categories-movielens-example">7.2 Data Transformation: Handling Multiple Categories (MovieLens Example)</h2>
<div id="c9c68d5b" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>mnames <span class="op">=</span> [<span class="st">"movie_id"</span>, <span class="st">"title"</span>, <span class="st">"genres"</span>]</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>movies <span class="op">=</span> pd.read_table(<span class="st">"https://raw.githubusercontent.com/wesm/pydata-book/3rd-edition/datasets/movielens/movies.dat"</span>, sep<span class="op">=</span><span class="st">"::"</span>,</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>                       header<span class="op">=</span><span class="va">None</span>, names<span class="op">=</span>mnames, engine<span class="op">=</span><span class="st">"python"</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>movies[:<span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">movie_id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">genres</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Toy Story (1995)</td>
<td>Animation|Children's|Comedy</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>Jumanji (1995)</td>
<td>Adventure|Children's|Fantasy</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>Grumpier Old Men (1995)</td>
<td>Comedy|Romance</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>Waiting to Exhale (1995)</td>
<td>Comedy|Drama</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>Father of the Bride Part II (1995)</td>
<td>Comedy</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>6</td>
<td>Heat (1995)</td>
<td>Action|Crime|Thriller</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>7</td>
<td>Sabrina (1995)</td>
<td>Comedy|Romance</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>8</td>
<td>Tom and Huck (1995)</td>
<td>Adventure|Children's</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>9</td>
<td>Sudden Death (1995)</td>
<td>Action</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>10</td>
<td>GoldenEye (1995)</td>
<td>Action|Adventure|Thriller</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>MovieLens dataset: ‚Äúgenres‚Äù column contains pipe-separated (|) genre strings.</li>
<li>A movie can belong to multiple genres.</li>
</ul>
</section>
<section id="data-transformation-str.get_dummies-for-multiple-categories" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-str.get_dummies-for-multiple-categories">7.2 Data Transformation: <code>str.get_dummies()</code> for Multiple Categories</h2>
<div id="68ca9ced" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>dummies <span class="op">=</span> movies[<span class="st">"genres"</span>].<span class="bu">str</span>.get_dummies(<span class="st">"|"</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>dummies.iloc[:<span class="dv">10</span>, :<span class="dv">6</span>]  <span class="co"># Show first 10 rows and 6 columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Action</th>
<th data-quarto-table-cell-role="th">Adventure</th>
<th data-quarto-table-cell-role="th">Animation</th>
<th data-quarto-table-cell-role="th">Children's</th>
<th data-quarto-table-cell-role="th">Comedy</th>
<th data-quarto-table-cell-role="th">Crime</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><code>str.get_dummies(separator)</code> handles multiple categories separated by a delimiter.</li>
</ul>
</section>
<section id="data-transformation-combining-with-the-original-dataframe" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-combining-with-the-original-dataframe">7.2 Data Transformation: Combining with the Original DataFrame</h2>
<div id="81159dae" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>movies_windic <span class="op">=</span> movies.join(dummies.add_prefix(<span class="st">"Genre_"</span>))</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>movies_windic.iloc[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>movie_id                                       1
title                           Toy Story (1995)
genres               Animation|Children's|Comedy
Genre_Action                                   0
Genre_Adventure                                0
Genre_Animation                                1
Genre_Children's                               1
Genre_Comedy                                   1
Genre_Crime                                    0
Genre_Documentary                              0
Genre_Drama                                    0
Genre_Fantasy                                  0
Genre_Film-Noir                                0
Genre_Horror                                   0
Genre_Musical                                  0
Genre_Mystery                                  0
Genre_Romance                                  0
Genre_Sci-Fi                                   0
Genre_Thriller                                 0
Genre_War                                      0
Genre_Western                                  0
Name: 0, dtype: object</code></pre>
</div>
</div>
<ul>
<li><code>add_prefix()</code> adds a prefix to the dummy variable columns.</li>
<li><code>join()</code> combines the dummy variables with the original DataFrame.</li>
</ul>
</section>
<section id="data-transformation-combining-get_dummies-and-cut" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-combining-get_dummies-and-cut">7.2 Data Transformation: Combining <code>get_dummies()</code> and <code>cut()</code></h2>
<div id="e3220da6" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">12345</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> np.random.uniform(size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>array([0.92961609, 0.31637555, 0.18391881, 0.20456028, 0.56772503,
       0.5955447 , 0.96451452, 0.6531771 , 0.74890664, 0.65356987])</code></pre>
</div>
</div>
<div id="415d8bd8" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> [<span class="dv">0</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="dv">1</span>]</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>pd.get_dummies(pd.cut(values, bins))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">(0.0, 0.2]</th>
<th data-quarto-table-cell-role="th">(0.2, 0.4]</th>
<th data-quarto-table-cell-role="th">(0.4, 0.6]</th>
<th data-quarto-table-cell-role="th">(0.6, 0.8]</th>
<th data-quarto-table-cell-role="th">(0.8, 1.0]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>A recipe for statistical applications: Combine <code>get_dummies()</code> with discretization functions like <code>cut()</code>.</li>
<li>Creates indicator variables for each bin.</li>
</ul>
</section>
<section id="extension-data-types" class="level2">
<h2 class="anchored" data-anchor-id="extension-data-types">7.3 Extension Data Types</h2>
<ul>
<li>Pandas‚Äô original reliance on NumPy had limitations:
<ul>
<li>Incomplete missing data handling for integers and Booleans.</li>
<li>String data was computationally expensive.</li>
<li>Some data types (time intervals, timedeltas) weren‚Äôt efficiently supported.</li>
</ul></li>
<li>Pandas now has an <em>extension type</em> system.
<ul>
<li>Allows adding new data types not natively supported by NumPy.</li>
<li>Treats these types as first-class citizens.</li>
</ul></li>
</ul>
</section>
<section id="extension-data-types-integer-example" class="level2">
<h2 class="anchored" data-anchor-id="extension-data-types-integer-example">7.3 Extension Data Types: Integer Example</h2>
<div id="0f35fb8a" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> pd.Series([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="va">None</span>])</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>0    1.0
1    2.0
2    3.0
3    NaN
dtype: float64</code></pre>
</div>
</div>
<div id="ac5e0929" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>s.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>dtype('float64')</code></pre>
</div>
</div>
<ul>
<li>Traditional behavior: Integer Series with missing values becomes <code>float64</code>.</li>
</ul>
</section>
<section id="extension-data-types-int64dtype" class="level2">
<h2 class="anchored" data-anchor-id="extension-data-types-int64dtype">7.3 Extension Data Types: <code>Int64Dtype</code></h2>
<div id="46d2b9a2" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> pd.Series([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="va">None</span>], dtype<span class="op">=</span>pd.Int64Dtype())</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>0       1
1       2
2       3
3    &lt;NA&gt;
dtype: Int64</code></pre>
</div>
</div>
<div id="4538ade0" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>s.isna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>0    False
1    False
2    False
3     True
dtype: bool</code></pre>
</div>
</div>
<div id="df5a27e9" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>s.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>Int64Dtype()</code></pre>
</div>
</div>
<ul>
<li><code>pd.Int64Dtype()</code> (or <code>"Int64"</code>) creates an integer Series with proper NA handling.</li>
<li>Uses <code>&lt;NA&gt;</code> to indicate missing values (pandas.NA sentinel value).</li>
</ul>
</section>
<section id="extension-data-types-string-example" class="level2">
<h2 class="anchored" data-anchor-id="extension-data-types-string-example">7.3 Extension Data Types: String Example</h2>
<div id="f1981da4" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> pd.Series([<span class="st">'one'</span>, <span class="st">'two'</span>, <span class="va">None</span>, <span class="st">'three'</span>], dtype<span class="op">=</span>pd.StringDtype())</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<pre><code>0      one
1      two
2     &lt;NA&gt;
3    three
dtype: string</code></pre>
</div>
</div>
<div id="840f9eac" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>s.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>string[python]</code></pre>
</div>
</div>
<ul>
<li><code>pd.StringDtype()</code> creates a specialized string data type.</li>
<li>More memory-efficient and computationally efficient for large datasets.</li>
<li>Requires the <code>pyarrow</code> library.</li>
</ul>
</section>
<section id="extension-data-types-astype" class="level2">
<h2 class="anchored" data-anchor-id="extension-data-types-astype">7.3 Extension Data Types: <code>astype()</code></h2>
<div id="eeb2b33f" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">"A"</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="va">None</span>, <span class="dv">4</span>],</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"B"</span>: [<span class="st">"one"</span>, <span class="st">"two"</span>, <span class="st">"three"</span>, <span class="va">None</span>],</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"C"</span>: [<span class="va">False</span>, <span class="va">None</span>, <span class="va">False</span>, <span class="va">True</span>]})</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.0</td>
<td>one</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2.0</td>
<td>two</td>
<td>None</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>three</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4.0</td>
<td>None</td>
<td>True</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="530f4efb" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"A"</span>] <span class="op">=</span> df[<span class="st">"A"</span>].astype(<span class="st">"Int64"</span>)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"B"</span>] <span class="op">=</span> df[<span class="st">"B"</span>].astype(<span class="st">"string"</span>)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"C"</span>] <span class="op">=</span> df[<span class="st">"C"</span>].astype(<span class="st">"boolean"</span>)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>one</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>two</td>
<td>&lt;NA&gt;</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>&lt;NA&gt;</td>
<td>three</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>&lt;NA&gt;</td>
<td>True</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>Extension types are well-integrated with existing tools. You can use astype() method to convert different types.</li>
</ul>
</section>
<section id="extension-data-types-1" class="level2">
<h2 class="anchored" data-anchor-id="extension-data-types-1">7.3 Extension Data Types</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 79%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Extension type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>BooleanDtype</code></td>
<td style="text-align: left;">Nullable Boolean data, use <code>"boolean"</code> when passing as string</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>CategoricalDtype</code></td>
<td style="text-align: left;">Categorical data type, use <code>"category"</code> when passing as string</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>DatetimeTZDtype</code></td>
<td style="text-align: left;">Datetime with time zone</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Float32Dtype</code></td>
<td style="text-align: left;">32-bit nullable floating point, use <code>"Float32"</code> when passing as string</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Float64Dtype</code></td>
<td style="text-align: left;">64-bit nullable floating point, use <code>"Float64"</code> when passing as string</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Int8Dtype</code></td>
<td style="text-align: left;">8-bit nullable signed integer, use <code>"Int8"</code> when passing as string</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Int16Dtype</code></td>
<td style="text-align: left;">16-bit nullable signed integer, use <code>"Int16"</code> when passing as string</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Int32Dtype</code></td>
<td style="text-align: left;">32-bit nullable signed integer, use <code>"Int32"</code> when passing as string</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Int64Dtype</code></td>
<td style="text-align: left;">64-bit nullable signed integer, use <code>"Int64"</code> when passing as string</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>UInt8Dtype</code></td>
<td style="text-align: left;">8-bit nullable unsigned integer, use <code>"UInt8"</code> when passing as string</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>UInt16Dtype</code></td>
<td style="text-align: left;">16-bit nullable unsigned integer, use <code>"UInt16"</code> when passing as string</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>UInt32Dtype</code></td>
<td style="text-align: left;">32-bit nullable unsigned integer, use <code>"UInt32"</code> when passing as string</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>UInt64Dtype</code></td>
<td style="text-align: left;">64-bit nullable unsigned integer, use <code>"UInt64"</code> when passing as string</td>
</tr>
</tbody>
</table>
<ul>
<li>A reasonably complete list of extension types available.</li>
</ul>
</section>
<section id="string-manipulation" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation">7.4 String Manipulation</h2>
<ul>
<li>Python is popular for string/text processing.</li>
<li>String object methods are often sufficient.</li>
<li>Regular expressions (regex) provide more power.</li>
<li>Pandas combines these, handling missing data gracefully.</li>
</ul>
</section>
<section id="string-manipulation-python-built-in-string-methods" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-python-built-in-string-methods">7.4 String Manipulation: Python Built-In String Methods</h2>
<div id="827a10a0" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>val <span class="op">=</span> <span class="st">"a,b,  guido"</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>val.split(<span class="st">","</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">
<pre><code>['a', 'b', '  guido']</code></pre>
</div>
</div>
<ul>
<li><code>split()</code>: Breaks a string into a list of substrings based on a delimiter.</li>
</ul>
<div id="4fd26228" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>pieces <span class="op">=</span> [x.strip() <span class="cf">for</span> x <span class="kw">in</span> val.split(<span class="st">","</span>)]</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>pieces</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">
<pre><code>['a', 'b', 'guido']</code></pre>
</div>
</div>
<ul>
<li><code>strip()</code>: Removes leading/trailing whitespace. Often used with <code>split()</code>.</li>
</ul>
</section>
<section id="string-manipulation-string-concatenation" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-string-concatenation">7.4 String Manipulation: String Concatenation</h2>
<div id="1ea0f6b9" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>first, second, third <span class="op">=</span> pieces</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>first <span class="op">+</span> <span class="st">"::"</span> <span class="op">+</span> second <span class="op">+</span> <span class="st">"::"</span> <span class="op">+</span> third  <span class="co"># Using + operator</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<pre><code>'a::b::guido'</code></pre>
</div>
</div>
<div id="5b28560a" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co">"::"</span>.join(pieces) <span class="co"># More Pythonic way,using join()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">
<pre><code>'a::b::guido'</code></pre>
</div>
</div>
<ul>
<li><code>join()</code>: A more Pythonic way to concatenate strings with a delimiter.</li>
</ul>
</section>
<section id="string-manipulation-substring-detection" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-substring-detection">7.4 String Manipulation: Substring Detection</h2>
<div id="45ab1707" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co">"guido"</span> <span class="kw">in</span> val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">
<pre><code>True</code></pre>
</div>
</div>
<div id="c68d458b" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>val.index(<span class="st">","</span>)  <span class="co"># Raises ValueError if not found</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">
<pre><code>1</code></pre>
</div>
</div>
<div id="881648ca" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>val.find(<span class="st">":"</span>)   <span class="co"># Returns -1 if not found</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>-1</code></pre>
</div>
</div>
<ul>
<li><code>in</code>: The best way to check if a substring exists.</li>
<li><code>index()</code>: Finds the first occurrence of a substring; raises an error if not found.</li>
<li><code>find()</code>: Similar to <code>index()</code>, but returns -1 if not found.</li>
</ul>
</section>
<section id="string-manipulation-count-and-replace" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-count-and-replace">7.4 String Manipulation: <code>count()</code> and <code>replace()</code></h2>
<div id="5c43c13b" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>val.count(<span class="st">","</span>) <span class="co"># Counts occurrences of a substring</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">
<pre><code>2</code></pre>
</div>
</div>
<div id="f47d32a1" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>val.replace(<span class="st">","</span>, <span class="st">"::"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="88">
<pre><code>'a::b::  guido'</code></pre>
</div>
</div>
<div id="9b2b3ba4" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>val.replace(<span class="st">","</span>, <span class="st">""</span>)  <span class="co"># Delete occurrences by replacing with empty string</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>'ab  guido'</code></pre>
</div>
</div>
<ul>
<li><code>count()</code>: Counts the number of occurrences of a substring.</li>
<li><code>replace()</code>: Substitutes occurrences of one pattern with another.</li>
</ul>
</section>
<section id="string-manipulation-python-built-in-string-methods-1" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-python-built-in-string-methods-1">7.4 String Manipulation: Python Built-in string methods</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 91%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>count</code></td>
<td style="text-align: left;">Return the number of nonoverlapping occurrences of substring in the string</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>endswith</code></td>
<td style="text-align: left;">Return <code>True</code> if string ends with suffix</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>startswith</code></td>
<td style="text-align: left;">Return <code>True</code> if string starts with prefix</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>join</code></td>
<td style="text-align: left;">Use string as delimiter for concatenating a sequence of other strings</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>index</code></td>
<td style="text-align: left;">Return starting index of the first occurrence of passed substring if found in the string; otherwise, raises <code>ValueError</code> if not found</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>find</code></td>
<td style="text-align: left;">Return position of first character of first occurrence of substring in the string; like index, but returns -1 if not found</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>rfind</code></td>
<td style="text-align: left;">Return position of first character of <em>last</em> occurrence of substring in the string; returns -1 if not found</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>replace</code></td>
<td style="text-align: left;">Replace occurrences of string with another string</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>strip</code></td>
<td style="text-align: left;">Trim whitespace, including newlines on <em>both</em> sides</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>rstrip</code></td>
<td style="text-align: left;">Trim whitespace on <em>right</em> side</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>lstrip</code></td>
<td style="text-align: left;">Trim whitespace on <em>left</em> side</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>split</code></td>
<td style="text-align: left;">Break string into list of substrings using passed delimiter</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>lower</code></td>
<td style="text-align: left;">Convert alphabet characters to lowercase</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>upper</code></td>
<td style="text-align: left;">Convert alphabet characters to uppercase</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>casefold</code></td>
<td style="text-align: left;">Convert characters to lowercase, handling region-specific variations</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ljust</code></td>
<td style="text-align: left;">Left justify; pad right side with spaces (or other fill character)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>rjust</code></td>
<td style="text-align: left;">Right justify; pad left side with spaces (or other fill character)</td>
</tr>
</tbody>
</table>
</section>
<section id="string-manipulation-regular-expressions" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-regular-expressions">7.4 String Manipulation: Regular Expressions</h2>
<ul>
<li>Regular expressions (regex) provide a powerful way to search, match, and manipulate text patterns.</li>
<li>Python‚Äôs built-in <code>re</code> module handles regular expressions.</li>
<li>Regex functions fall into three categories:
<ul>
<li>Pattern matching.</li>
<li>Substitution.</li>
<li>Splitting.</li>
</ul></li>
</ul>
</section>
<section id="string-manipulation-regex-example---splitting" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-regex-example---splitting">7.4 String Manipulation: Regex Example - Splitting</h2>
<div id="e8ed7814" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> <span class="st">"foo    bar</span><span class="ch">\t</span><span class="st"> baz  </span><span class="ch">\t</span><span class="st">qux"</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>re.split(<span class="vs">r"\s+"</span>, text)  <span class="co"># Split on one or more whitespace characters</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="90">
<pre><code>['foo', 'bar', 'baz', 'qux']</code></pre>
</div>
</div>
<p><code>\s+</code>: Regex for one or more whitespace characters. - <code>re.split(pattern, text)</code>: Splits the text based on the regex pattern.</p>
</section>
<section id="string-manipulation-compiling-regex-objects" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-compiling-regex-objects">7.4 String Manipulation: Compiling Regex Objects</h2>
<div id="8233fa36" class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>regex <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r"\s+"</span>)  <span class="co"># Compile the regex</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>regex.split(text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="91">
<pre><code>['foo', 'bar', 'baz', 'qux']</code></pre>
</div>
</div>
<ul>
<li><code>re.compile(pattern)</code>: Compiles a regex into a reusable regex object.</li>
<li>Recommended if you‚Äôll apply the same regex to multiple strings (saves CPU cycles).</li>
</ul>
</section>
<section id="string-manipulation-findall" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-findall">7.4 String Manipulation: <code>findall()</code></h2>
<div id="d24cdc5b" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>regex.findall(text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="92">
<pre><code>['    ', '\t ', '  \t']</code></pre>
</div>
</div>
<ul>
<li><code>findall()</code>: Returns a list of all non-overlapping matches of the pattern in the string.</li>
</ul>
</section>
<section id="string-manipulation-regex-example---email-matching" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-regex-example---email-matching">7.4 String Manipulation: Regex Example - Email Matching</h2>
<div id="39ddfd41" class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> <span class="st">"""Dave dave@google.com</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="st">Steve steve@gmail.com</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="st">Rob rob@gmail.com</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="st">Ryan ryan@yahoo.com"""</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>pattern <span class="op">=</span> <span class="vs">r"[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}"</span>  <span class="co"># Basic email regex</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="co"># re.IGNORECASE makes the regex case-insensitive</span></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>regex <span class="op">=</span> re.<span class="bu">compile</span>(pattern, flags<span class="op">=</span>re.IGNORECASE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>A more complex regex to match email addresses.</li>
<li><code>re.IGNORECASE</code> flag makes the match case-insensitive.</li>
</ul>
</section>
<section id="string-manipulation-findall-with-email-regex" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-findall-with-email-regex">7.4 String Manipulation: <code>findall()</code> with Email Regex</h2>
<div id="c5f58ee3" class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>regex.findall(text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="94">
<pre><code>['dave@google.com', 'steve@gmail.com', 'rob@gmail.com', 'ryan@yahoo.com']</code></pre>
</div>
</div>
<ul>
<li><code>findall()</code> returns a list of all matched email addresses.</li>
</ul>
</section>
<section id="string-manipulation-search" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-search">7.4 String Manipulation: <code>search()</code></h2>
<div id="8fe1699c" class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> regex.search(text)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="95">
<pre><code>&lt;re.Match object; span=(5, 20), match='dave@google.com'&gt;</code></pre>
</div>
</div>
<div id="a81c7ebf" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>text[m.start():m.end()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="96">
<pre><code>'dave@google.com'</code></pre>
</div>
</div>
<ul>
<li><code>search()</code>: Returns a <em>match object</em> for the <em>first</em> match in the string.</li>
<li>The match object gives the start and end positions of the match.</li>
<li><code>regex.match()</code> Returns <code>None</code>.</li>
</ul>
</section>
<section id="string-manipulation-sub" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-sub">7.4 String Manipulation: <code>sub()</code></h2>
<div id="7e79cd09" class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(regex.sub(<span class="st">"REDACTED"</span>, text))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Dave REDACTED
Steve REDACTED
Rob REDACTED
Ryan REDACTED</code></pre>
</div>
</div>
<ul>
<li><code>sub(replacement, text)</code>: Returns a new string with occurrences of the pattern replaced by the <code>replacement</code> string.</li>
</ul>
</section>
<section id="string-manipulation-regex-groups" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-regex-groups">7.4 String Manipulation: Regex Groups</h2>
<div id="9d20a9ad" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>pattern <span class="op">=</span> <span class="vs">r"([A-Z0-9._%+-]+)@([A-Z0-9.-]+)\.([A-Z]{2,4})"</span>  <span class="co"># Regex with groups</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>regex <span class="op">=</span> re.<span class="bu">compile</span>(pattern, flags<span class="op">=</span>re.IGNORECASE)</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> regex.match(<span class="st">"wesm@bright.net"</span>)</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>m.groups()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="98">
<pre><code>('wesm', 'bright', 'net')</code></pre>
</div>
</div>
<ul>
<li>Parentheses <code>()</code> in a regex define <em>capture groups</em>.</li>
<li><code>groups()</code> method of a match object returns a tuple of the captured group contents.</li>
</ul>
</section>
<section id="string-manipulation-findall-with-groups" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-findall-with-groups">7.4 String Manipulation: <code>findall()</code> with Groups</h2>
<div id="625ad7eb" class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>regex.findall(text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="99">
<pre><code>[('dave', 'google', 'com'),
 ('steve', 'gmail', 'com'),
 ('rob', 'gmail', 'com'),
 ('ryan', 'yahoo', 'com')]</code></pre>
</div>
</div>
<ul>
<li>When a regex has groups, <code>findall()</code> returns a list of <em>tuples</em>, where each tuple contains the captured groups.</li>
</ul>
</section>
<section id="string-manipulation-sub-with-group-references" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-sub-with-group-references">7.4 String Manipulation: <code>sub()</code> with Group References</h2>
<div id="56932e31" class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(regex.sub(<span class="vs">r"Username: \1, Domain: \2, Suffix: \3"</span>, text))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Dave Username: dave, Domain: google, Suffix: com
Steve Username: steve, Domain: gmail, Suffix: com
Rob Username: rob, Domain: gmail, Suffix: com
Ryan Username: ryan, Domain: yahoo, Suffix: com</code></pre>
</div>
</div>
<ul>
<li>In <code>sub()</code>, <code>\1</code>, <code>\2</code>, etc., refer to the captured groups (backreferences).</li>
</ul>
</section>
<section id="string-manipulation-regular-expression-methods" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-regular-expression-methods">7.4 String Manipulation: Regular expression methods</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 91%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>findall</code></td>
<td style="text-align: left;">Return all nonoverlapping matching patterns in a string as a list</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>finditer</code></td>
<td style="text-align: left;">Like <code>findall</code>, but returns an iterator</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>match</code></td>
<td style="text-align: left;">Match pattern at <em>start</em> of string and optionally segment pattern components into groups; if the pattern matches, return a match object, and otherwise <code>None</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>search</code></td>
<td style="text-align: left;">Scan string for match to pattern, returning a match object if so; unlike <code>match</code>, the match can be <em>anywhere</em> in the string</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>split</code></td>
<td style="text-align: left;">Break string into pieces at each occurrence of pattern</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>sub</code>, <code>subn</code></td>
<td style="text-align: left;">Replace all (<code>sub</code>) or first <em>n</em> occurrences (<code>subn</code>) of pattern in string with replacement expression; use symbols <code>\1</code>, <code>\2</code>, ‚Ä¶</td>
</tr>
</tbody>
</table>
</section>
<section id="string-manipulation-string-functions-in-pandas" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-string-functions-in-pandas">7.4 String Manipulation: String Functions in pandas</h2>
<ul>
<li>Pandas extends string manipulation to Series and DataFrames.</li>
<li>Handles missing data gracefully.</li>
</ul>
<div id="26041c64" class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">"Dave"</span>: <span class="st">"dave@google.com"</span>, <span class="st">"Steve"</span>: <span class="st">"steve@gmail.com"</span>,</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Rob"</span>: <span class="st">"rob@gmail.com"</span>, <span class="st">"Wes"</span>: np.nan}</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.Series(data)</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="101">
<pre><code>Dave     dave@google.com
Steve    steve@gmail.com
Rob        rob@gmail.com
Wes                  NaN
dtype: object</code></pre>
</div>
</div>
<div id="3f22f680" class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>data.isna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="102">
<pre><code>Dave     False
Steve    False
Rob      False
Wes       True
dtype: bool</code></pre>
</div>
</div>
<ul>
<li>Example Series with string data and a missing value.</li>
</ul>
</section>
<section id="string-manipulation-str-accessor" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-str-accessor">7.4 String Manipulation: <code>str</code> Accessor</h2>
<div id="2701f5cc" class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>data.<span class="bu">str</span>.contains(<span class="st">"gmail"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="103">
<pre><code>Dave     False
Steve     True
Rob       True
Wes        NaN
dtype: object</code></pre>
</div>
</div>
<ul>
<li>Series has a <code>str</code> attribute that provides access to string methods.</li>
<li>These methods skip over and propagate NA values.</li>
</ul>
</section>
<section id="string-manipulation-str.contains" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-str.contains">7.4 String Manipulation: <code>str.contains()</code></h2>
<ul>
<li><code>str.contains(substring)</code>: Checks if each string contains the given substring.</li>
<li>Returns a Boolean Series.</li>
</ul>
</section>
<section id="string-manipulation-using-regex-with-str-methods" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-using-regex-with-str-methods">7.4 String Manipulation: Using Regex with <code>str</code> Methods</h2>
<div id="68d8b1bd" class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>pattern <span class="op">=</span> <span class="vs">r"([A-Z0-9._%+-]+)@([A-Z0-9.-]+)\.([A-Z]{2,4})"</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>data.<span class="bu">str</span>.findall(pattern, flags<span class="op">=</span>re.IGNORECASE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="104">
<pre><code>Dave     [(dave, google, com)]
Steve    [(steve, gmail, com)]
Rob        [(rob, gmail, com)]
Wes                        NaN
dtype: object</code></pre>
</div>
</div>
<ul>
<li>Regular expressions can be used with <code>str</code> methods.</li>
<li><code>flags</code> (like <code>re.IGNORECASE</code>) can be passed.</li>
</ul>
</section>
<section id="string-manipulation-vectorized-element-retrieval" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-vectorized-element-retrieval">7.4 String Manipulation: Vectorized Element Retrieval</h2>
<div id="7fb6a8ff" class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>matches <span class="op">=</span> data.<span class="bu">str</span>.findall(pattern, flags<span class="op">=</span>re.IGNORECASE).<span class="bu">str</span>[<span class="dv">0</span>]</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>matches</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="105">
<pre><code>Dave     (dave, google, com)
Steve    (steve, gmail, com)
Rob        (rob, gmail, com)
Wes                      NaN
dtype: object</code></pre>
</div>
</div>
<div id="c5fd62c4" class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>matches.<span class="bu">str</span>.get(<span class="dv">1</span>) <span class="co"># Accessing the group</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="106">
<pre><code>Dave     google
Steve     gmail
Rob       gmail
Wes         NaN
dtype: object</code></pre>
</div>
</div>
<div id="6530fa92" class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>data.<span class="bu">str</span>[:<span class="dv">5</span>]  <span class="co"># String slicing</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="107">
<pre><code>Dave     dave@
Steve    steve
Rob      rob@g
Wes        NaN
dtype: object</code></pre>
</div>
</div>
<ul>
<li>Vectorized element retrieval: Use <code>str.get(i)</code> or index into the <code>str</code> attribute (<code>str[i]</code>).</li>
</ul>
</section>
<section id="string-manipulation-str.extract" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-str.extract">7.4 String Manipulation: <code>str.extract()</code></h2>
<div id="9a906213" class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>data.<span class="bu">str</span>.extract(pattern, flags<span class="op">=</span>re.IGNORECASE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="108">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dave</td>
<td>dave</td>
<td>google</td>
<td>com</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Steve</td>
<td>steve</td>
<td>gmail</td>
<td>com</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Rob</td>
<td>rob</td>
<td>gmail</td>
<td>com</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Wes</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><code>str.extract(pattern)</code>: Returns a <em>DataFrame</em> where each captured group in the regex becomes a column.</li>
</ul>
</section>
<section id="string-manipulation-partial-listing-of-series-string-methods" class="level2">
<h2 class="anchored" data-anchor-id="string-manipulation-partial-listing-of-series-string-methods">7.4 String Manipulation: Partial listing of <code>Series</code> string methods</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 91%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>cat</code></td>
<td style="text-align: left;">Concatenate strings element-wise with optional delimiter</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>contains</code></td>
<td style="text-align: left;">Return Boolean array if each string contains pattern/regex</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>count</code></td>
<td style="text-align: left;">Count occurrences of pattern</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>extract</code></td>
<td style="text-align: left;">Use a regular expression with groups to extract one or more strings from a Series of strings; the result will be a DataFrame with one column per group</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>endswith</code></td>
<td style="text-align: left;">Equivalent to <code>x.endswith(pattern)</code> for each element</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>startswith</code></td>
<td style="text-align: left;">Equivalent to <code>x.startswith(pattern)</code> for each element</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>findall</code></td>
<td style="text-align: left;">Compute list of all occurrences of pattern/regex for each string</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>get</code></td>
<td style="text-align: left;">Index into each element (retrieve <em>i</em>-th element)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>isalnum</code></td>
<td style="text-align: left;">Equivalent to built-in <code>str.isalnum</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>isalpha</code></td>
<td style="text-align: left;">Equivalent to built-in <code>str.isalpha</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>isdecimal</code></td>
<td style="text-align: left;">Equivalent to built-in <code>str.isdecimal</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>isdigit</code></td>
<td style="text-align: left;">Equivalent to built-in <code>str.isdigit</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>islower</code></td>
<td style="text-align: left;">Equivalent to built-in <code>str.islower</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>isnumeric</code></td>
<td style="text-align: left;">Equivalent to built-in <code>str.isnumeric</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>isupper</code></td>
<td style="text-align: left;">Equivalent to built-in <code>str.isupper</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>join</code></td>
<td style="text-align: left;">Join strings in each element of the Series with passed separator</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>len</code></td>
<td style="text-align: left;">Compute length of each string</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>lower, upper</code></td>
<td style="text-align: left;">Convert cases; equivalent to <code>x.lower()</code> or <code>x.upper()</code> for each element</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>match</code></td>
<td style="text-align: left;">Use <code>re.match</code> with the passed regular expression on each element, returning <code>True</code> or <code>False</code> whether it matches</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>pad</code></td>
<td style="text-align: left;">Add whitespace to left, right, or both sides of strings</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>center</code></td>
<td style="text-align: left;">Equivalent to <code>pad(side="both")</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>repeat</code></td>
<td style="text-align: left;">Duplicate values (e.g., <code>s.str.repeat(3)</code> is equivalent to <code>x * 3</code> for each string)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>replace</code></td>
<td style="text-align: left;">Replace occurrences of pattern/regex with some other string</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>slice</code></td>
<td style="text-align: left;">Slice each string in the Series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>split</code></td>
<td style="text-align: left;">Split strings on delimiter or regular expression</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>strip</code></td>
<td style="text-align: left;">Trim whitespace from both sides, including newlines</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>rstrip</code></td>
<td style="text-align: left;">Trim whitespace on right side</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>lstrip</code></td>
<td style="text-align: left;">Trim whitespace on left side</td>
</tr>
</tbody>
</table>
</section>
<section id="categorical-data" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data">7.5 Categorical Data</h2>
<ul>
<li>Introduces the pandas <code>Categorical</code> type.</li>
<li>Improves performance and memory use in some pandas operations.</li>
<li>Useful for statistical and machine learning applications.</li>
</ul>
</section>
<section id="categorical-data-background-and-motivation" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-background-and-motivation">7.5 Categorical Data: Background and Motivation</h2>
<ul>
<li>Columns often contain repeated instances of a smaller set of distinct values.</li>
<li><em>Dimension tables</em> are a common technique in data warehousing.
<ul>
<li>Distinct values are stored in the dimension table.</li>
<li>Primary observations are stored as integer keys referencing the dimension table.</li>
</ul></li>
<li>More efficient storage and computation.</li>
</ul>
<div id="deb550d3" class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> pd.Series([<span class="st">'apple'</span>, <span class="st">'orange'</span>, <span class="st">'apple'</span>,</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'apple'</span>] <span class="op">*</span> <span class="dv">2</span>)</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="109">
<pre><code>0     apple
1    orange
2     apple
3     apple
4     apple
5    orange
6     apple
7     apple
dtype: object</code></pre>
</div>
</div>
<div id="fcb57b97" class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>pd.unique(values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="110">
<pre><code>array(['apple', 'orange'], dtype=object)</code></pre>
</div>
</div>
<div id="be1f4c00" class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>pd.value_counts(values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_2635/3297668723.py:1: FutureWarning: pandas.value_counts is deprecated and will be removed in a future version. Use pd.Series(obj).value_counts() instead.
  pd.value_counts(values)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="111">
<pre><code>apple     6
orange    2
Name: count, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="categorical-data-dimension-table-representation" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-dimension-table-representation">7.5 Categorical Data: Dimension Table Representation</h2>
<div id="6ab8b24a" class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> pd.Series([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>] <span class="op">*</span> <span class="dv">2</span>)</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> pd.Series([<span class="st">'apple'</span>, <span class="st">'orange'</span>])</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="112">
<pre><code>0    0
1    1
2    0
3    0
4    0
5    1
6    0
7    0
dtype: int64</code></pre>
</div>
</div>
<div id="3672db66" class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>dim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="113">
<pre><code>0     apple
1    orange
dtype: object</code></pre>
</div>
</div>
<ul>
<li><code>values</code>: Integer keys referencing the dimension table.</li>
<li><code>dim</code>: Dimension table containing the distinct values.</li>
</ul>
</section>
<section id="categorical-data-restoring-original-data-with-take" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-restoring-original-data-with-take">7.5 Categorical Data: Restoring Original Data with <code>take()</code></h2>
<div id="1446a289" class="cell" data-execution_count="114">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>dim.take(values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="114">
<pre><code>0     apple
1    orange
0     apple
0     apple
0     apple
1    orange
0     apple
0     apple
dtype: object</code></pre>
</div>
</div>
<ul>
<li><code>take()</code> method can be used to restore the original Series of strings.</li>
</ul>
</section>
<section id="categorical-data-terminology" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-terminology">7.5 Categorical Data: Terminology</h2>
<ul>
<li><em>Categorical</em> or <em>dictionary-encoded</em> representation: Representing data with repeated values as integers.</li>
<li><em>Categories</em>, <em>dictionary</em>, or <em>levels</em>: The array of distinct values.</li>
<li><em>Category codes</em> or <em>codes</em>: The integer values referencing the categories.</li>
</ul>
</section>
<section id="categorical-data-benefits" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-benefits">7.5 Categorical Data: Benefits</h2>
<ul>
<li>Significant performance improvements in analytics.</li>
<li>Transformations on categories while leaving codes unmodified.
<ul>
<li>Renaming categories.</li>
<li>Appending new categories.</li>
</ul></li>
</ul>
</section>
<section id="categorical-data-categorical-extension-type-in-pandas" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-categorical-extension-type-in-pandas">7.5 Categorical Data: <code>Categorical</code> Extension Type in pandas</h2>
<div id="d691d181" class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>fruits <span class="op">=</span> [<span class="st">'apple'</span>, <span class="st">'orange'</span>, <span class="st">'apple'</span>, <span class="st">'apple'</span>] <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="bu">len</span>(fruits)</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> np.random.default_rng(seed<span class="op">=</span><span class="dv">12345</span>)</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'fruit'</span>: fruits,</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'basket_id'</span>: np.arange(N),</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'count'</span>: rng.integers(<span class="dv">3</span>, <span class="dv">15</span>, size<span class="op">=</span>N),</span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'weight'</span>: rng.uniform(<span class="dv">0</span>, <span class="dv">4</span>, size<span class="op">=</span>N)},</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>                  columns<span class="op">=</span>[<span class="st">'basket_id'</span>, <span class="st">'fruit'</span>, <span class="st">'count'</span>, <span class="st">'weight'</span>])</span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="115">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">basket_id</th>
<th data-quarto-table-cell-role="th">fruit</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>apple</td>
<td>11</td>
<td>1.564438</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>orange</td>
<td>5</td>
<td>1.331256</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>apple</td>
<td>12</td>
<td>2.393235</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>apple</td>
<td>6</td>
<td>0.746937</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>apple</td>
<td>5</td>
<td>2.691024</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>5</td>
<td>orange</td>
<td>12</td>
<td>3.767211</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>6</td>
<td>apple</td>
<td>10</td>
<td>0.992983</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>7</td>
<td>apple</td>
<td>11</td>
<td>3.795525</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>Example DataFrame with a ‚Äúfruit‚Äù column (string objects).</li>
</ul>
</section>
<section id="categorical-data-converting-to-categorical" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-converting-to-categorical">7.5 Categorical Data: Converting to Categorical</h2>
<div id="6d50d5e4" class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>fruit_cat <span class="op">=</span> df[<span class="st">'fruit'</span>].astype(<span class="st">'category'</span>)</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>fruit_cat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="116">
<pre><code>0     apple
1    orange
2     apple
3     apple
4     apple
5    orange
6     apple
7     apple
Name: fruit, dtype: category
Categories (2, object): ['apple', 'orange']</code></pre>
</div>
</div>
<ul>
<li><code>astype('category')</code>: Converts a column to the <code>Categorical</code> type.</li>
</ul>
</section>
<section id="categorical-data-accessing-the-categorical-object" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-accessing-the-categorical-object">7.5 Categorical Data: Accessing the <code>Categorical</code> Object</h2>
<div id="51a9c233" class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> fruit_cat.array</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="117">
<pre><code>pandas.core.arrays.categorical.Categorical</code></pre>
</div>
</div>
<ul>
<li>The <code>.array</code> attribute accesses the underlying <code>Categorical</code> object.</li>
</ul>
</section>
<section id="categorical-data-categories-and-codes-attributes" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-categories-and-codes-attributes">7.5 Categorical Data: <code>categories</code> and <code>codes</code> Attributes</h2>
<div id="2b497343" class="cell" data-execution_count="118">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>c.categories</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="118">
<pre><code>Index(['apple', 'orange'], dtype='object')</code></pre>
</div>
</div>
<div id="e1f5b727" class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>c.codes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="119">
<pre><code>array([0, 1, 0, 0, 0, 1, 0, 0], dtype=int8)</code></pre>
</div>
</div>
<ul>
<li><code>categories</code>: The distinct values.</li>
<li><code>codes</code>: Integer codes representing each value‚Äôs category.</li>
</ul>
</section>
<section id="categorical-data-converting-a-dataframe-column" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-converting-a-dataframe-column">7.5 Categorical Data: Converting a DataFrame Column</h2>
<div id="bdc9fec3" class="cell" data-execution_count="120">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'fruit'</span>] <span class="op">=</span> df[<span class="st">'fruit'</span>].astype(<span class="st">'category'</span>)</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"fruit"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="120">
<pre><code>0     apple
1    orange
2     apple
3     apple
4     apple
5    orange
6     apple
7     apple
Name: fruit, dtype: category
Categories (2, object): ['apple', 'orange']</code></pre>
</div>
</div>
<ul>
<li>Convert a DataFrame column to categorical by assigning the result of <code>astype('category')</code>.</li>
</ul>
</section>
<section id="categorical-data-creating-categorical-directly" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-creating-categorical-directly">7.5 Categorical Data: Creating <code>Categorical</code> Directly</h2>
<div id="177d19d1" class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>my_categories <span class="op">=</span> pd.Categorical([<span class="st">'foo'</span>, <span class="st">'bar'</span>, <span class="st">'baz'</span>, <span class="st">'foo'</span>, <span class="st">'bar'</span>])</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>my_categories</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="121">
<pre><code>['foo', 'bar', 'baz', 'foo', 'bar']
Categories (3, object): ['bar', 'baz', 'foo']</code></pre>
</div>
</div>
<ul>
<li>Create <code>Categorical</code> objects directly from Python sequences.</li>
</ul>
</section>
<section id="categorical-data-from_codes-constructor" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-from_codes-constructor">7.5 Categorical Data: <code>from_codes()</code> Constructor</h2>
<div id="15269ac5" class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> [<span class="st">'foo'</span>, <span class="st">'bar'</span>, <span class="st">'baz'</span>]</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>codes <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>my_cats_2 <span class="op">=</span> pd.Categorical.from_codes(codes, categories)</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>my_cats_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="122">
<pre><code>['foo', 'bar', 'baz', 'foo', 'foo', 'bar']
Categories (3, object): ['foo', 'bar', 'baz']</code></pre>
</div>
</div>
<ul>
<li><code>from_codes(codes, categories)</code>: Creates a <code>Categorical</code> from existing codes and categories.</li>
</ul>
</section>
<section id="categorical-data-ordered-categories" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-ordered-categories">7.5 Categorical Data: Ordered Categories</h2>
<div id="df11515a" class="cell" data-execution_count="123">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>ordered_cat <span class="op">=</span> pd.Categorical.from_codes(codes, categories,</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>                                        ordered<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>ordered_cat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="123">
<pre><code>['foo', 'bar', 'baz', 'foo', 'foo', 'bar']
Categories (3, object): ['foo' &lt; 'bar' &lt; 'baz']</code></pre>
</div>
</div>
<div id="15fdd697" class="cell" data-execution_count="124">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>my_cats_2.as_ordered() <span class="co"># unordered categorical instance can be made ordered</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="124">
<pre><code>['foo', 'bar', 'baz', 'foo', 'foo', 'bar']
Categories (3, object): ['foo' &lt; 'bar' &lt; 'baz']</code></pre>
</div>
</div>
<ul>
<li><code>ordered=True</code>: Indicates that the categories have a meaningful order.</li>
<li>By default, categories are unordered.</li>
</ul>
</section>
<section id="categorical-data-computations-with-categoricals" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-computations-with-categoricals">7.5 Categorical Data: Computations with Categoricals</h2>
<ul>
<li>Using <code>Categorical</code> generally behaves the same as the non-encoded version (e.g., string array).</li>
<li>Some pandas functions (like <code>groupby</code>) perform better with categoricals.</li>
</ul>
<div id="da444301" class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> np.random.default_rng(seed<span class="op">=</span><span class="dv">12345</span>)</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>draws <span class="op">=</span> rng.standard_normal(<span class="dv">1000</span>)</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>draws[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="125">
<pre><code>array([-1.42382504,  1.26372846, -0.87066174, -0.25917323, -0.07534331])</code></pre>
</div>
</div>
</section>
<section id="categorical-data-qcut-and-categoricals" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-qcut-and-categoricals">7.5 Categorical Data: <code>qcut()</code> and Categoricals</h2>
<div id="768da89a" class="cell" data-execution_count="126">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> pd.qcut(draws, <span class="dv">4</span>) <span class="co"># quartile binning</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>bins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="126">
<pre><code>[(-3.121, -0.675], (0.687, 3.211], (-3.121, -0.675], (-0.675, 0.0134], (-0.675, 0.0134], ..., (0.0134, 0.687], (0.0134, 0.687], (-0.675, 0.0134], (0.0134, 0.687], (-0.675, 0.0134]]
Length: 1000
Categories (4, interval[float64, right]): [(-3.121, -0.675] &lt; (-0.675, 0.0134] &lt; (0.0134, 0.687] &lt; (0.687, 3.211]]</code></pre>
</div>
</div>
<div id="4d2b047b" class="cell" data-execution_count="127">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> pd.qcut(draws, <span class="dv">4</span>, labels<span class="op">=</span>[<span class="st">'Q1'</span>, <span class="st">'Q2'</span>, <span class="st">'Q3'</span>, <span class="st">'Q4'</span>])</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>bins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="127">
<pre><code>['Q1', 'Q4', 'Q1', 'Q2', 'Q2', ..., 'Q3', 'Q3', 'Q2', 'Q3', 'Q2']
Length: 1000
Categories (4, object): ['Q1' &lt; 'Q2' &lt; 'Q3' &lt; 'Q4']</code></pre>
</div>
</div>
<div id="8065f455" class="cell" data-execution_count="128">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>bins.codes[:<span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="128">
<pre><code>array([0, 3, 0, 1, 1, 0, 0, 2, 2, 0], dtype=int8)</code></pre>
</div>
</div>
<ul>
<li><code>pd.qcut()</code> returns a <code>Categorical</code> object.</li>
<li><code>labels</code> argument to give names.</li>
</ul>
</section>
<section id="categorical-data-groupby-with-categoricals" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-groupby-with-categoricals">7.5 Categorical Data: <code>groupby()</code> with Categoricals</h2>
<div id="ce2b3ee0" class="cell" data-execution_count="129">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> pd.Series(bins, name<span class="op">=</span><span class="st">'quartile'</span>)</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> (pd.Series(draws)</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>           .groupby(bins)</span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>           .agg([<span class="st">'count'</span>, <span class="st">'min'</span>, <span class="st">'max'</span>])</span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>           .reset_index())</span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_2635/2483392743.py:3: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  .groupby(bins)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="129">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">quartile</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Q1</td>
<td>250</td>
<td>-3.119609</td>
<td>-0.678494</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Q2</td>
<td>250</td>
<td>-0.673305</td>
<td>0.008009</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Q3</td>
<td>250</td>
<td>0.018753</td>
<td>0.686183</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Q4</td>
<td>250</td>
<td>0.688282</td>
<td>3.211418</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="baae6b89" class="cell" data-execution_count="130">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>results[<span class="st">'quartile'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="130">
<pre><code>0    Q1
1    Q2
2    Q3
3    Q4
Name: quartile, dtype: category
Categories (4, object): ['Q1' &lt; 'Q2' &lt; 'Q3' &lt; 'Q4']</code></pre>
</div>
</div>
<ul>
<li>The ‚Äòquartile‚Äô column in the result retains the original categorical information.</li>
</ul>
</section>
<section id="categorical-data-performance-benefits" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-performance-benefits">7.5 Categorical Data: Performance Benefits</h2>
<div id="e8cb383f" class="cell" data-execution_count="131">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">10_000_000</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> pd.Series([<span class="st">'foo'</span>, <span class="st">'bar'</span>, <span class="st">'baz'</span>, <span class="st">'qux'</span>] <span class="op">*</span> (N <span class="op">//</span> <span class="dv">4</span>))</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> labels.astype(<span class="st">'category'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4dca6029" class="cell" data-execution_count="132">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>labels.memory_usage(deep<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="132">
<pre><code>520000132</code></pre>
</div>
</div>
<div id="58689447" class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>categories.memory_usage(deep<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="133">
<pre><code>10000512</code></pre>
</div>
</div>
<ul>
<li>Categoricals use significantly less memory than strings.</li>
</ul>
</section>
<section id="categorical-data-categorical-methods" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-categorical-methods">7.5 Categorical Data: Categorical Methods</h2>
<ul>
<li>Series containing categorical data have special methods (similar to <code>Series.str</code>).</li>
<li>Accessed via the <code>cat</code> accessor.</li>
</ul>
<div id="c0e874ba" class="cell" data-execution_count="134">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> pd.Series([<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>] <span class="op">*</span> <span class="dv">2</span>)</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>cat_s <span class="op">=</span> s.astype(<span class="st">'category'</span>)</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>cat_s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="134">
<pre><code>0    a
1    b
2    c
3    d
4    a
5    b
6    c
7    d
dtype: category
Categories (4, object): ['a', 'b', 'c', 'd']</code></pre>
</div>
</div>
</section>
<section id="categorical-data-cat-accessor" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-cat-accessor">7.5 Categorical Data: <code>cat</code> Accessor</h2>
<div id="7be34a73" class="cell" data-execution_count="135">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>cat_s.cat.codes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="135">
<pre><code>0    0
1    1
2    2
3    3
4    0
5    1
6    2
7    3
dtype: int8</code></pre>
</div>
</div>
<div id="fd2bd2ca" class="cell" data-execution_count="136">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>cat_s.cat.categories</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="136">
<pre><code>Index(['a', 'b', 'c', 'd'], dtype='object')</code></pre>
</div>
</div>
<ul>
<li>The <code>cat</code> accessor provides access to categorical methods and attributes.</li>
</ul>
</section>
<section id="categorical-data-set_categories" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-set_categories">7.5 Categorical Data: <code>set_categories()</code></h2>
<div id="285d267f" class="cell" data-execution_count="137">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>actual_categories <span class="op">=</span> [<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>, <span class="st">'e'</span>]</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>cat_s2 <span class="op">=</span> cat_s.cat.set_categories(actual_categories)</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>cat_s2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="137">
<pre><code>0    a
1    b
2    c
3    d
4    a
5    b
6    c
7    d
dtype: category
Categories (5, object): ['a', 'b', 'c', 'd', 'e']</code></pre>
</div>
</div>
<ul>
<li><code>set_categories()</code>: Changes the set of categories.</li>
<li>Useful when the data doesn‚Äôt include all possible categories.</li>
</ul>
</section>
<section id="categorical-data-value_counts-with-set_categories" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-value_counts-with-set_categories">7.5 Categorical Data: <code>value_counts()</code> with <code>set_categories()</code></h2>
<div id="738be526" class="cell" data-execution_count="138">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>cat_s.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="138">
<pre><code>a    2
b    2
c    2
d    2
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="2b9a9a50" class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>cat_s2.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="139">
<pre><code>a    2
b    2
c    2
d    2
e    0
Name: count, dtype: int64</code></pre>
</div>
</div>
<ul>
<li><code>value_counts()</code> respects the categories defined, even if some aren‚Äôt present in the data.</li>
</ul>
</section>
<section id="categorical-data-remove_unused_categories" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-remove_unused_categories">7.5 Categorical Data: <code>remove_unused_categories()</code></h2>
<div id="429eb195" class="cell" data-execution_count="140">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>cat_s3 <span class="op">=</span> cat_s[cat_s.isin([<span class="st">'a'</span>, <span class="st">'b'</span>])]</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>cat_s3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="140">
<pre><code>0    a
1    b
4    a
5    b
dtype: category
Categories (4, object): ['a', 'b', 'c', 'd']</code></pre>
</div>
</div>
<div id="815a533d" class="cell" data-execution_count="141">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>cat_s3.cat.remove_unused_categories()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="141">
<pre><code>0    a
1    b
4    a
5    b
dtype: category
Categories (2, object): ['a', 'b']</code></pre>
</div>
</div>
<ul>
<li><code>remove_unused_categories()</code>: Removes categories that don‚Äôt appear in the data.</li>
<li>Useful for memory savings after filtering.</li>
</ul>
</section>
<section id="categorical-data-categorical-methods-for-series-in-pandas" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-categorical-methods-for-series-in-pandas">7.5 Categorical Data: Categorical methods for Series in pandas</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 82%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>add_categories</code></td>
<td style="text-align: left;">Append new (unused) categories at end of existing categories</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>as_ordered</code></td>
<td style="text-align: left;">Make categories ordered</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>as_unordered</code></td>
<td style="text-align: left;">Make categories unordered</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>remove_categories</code></td>
<td style="text-align: left;">Remove categories, setting any removed values to null</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>remove_unused_categories</code></td>
<td style="text-align: left;">Remove any category values that do not appear in the data</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>rename_categories</code></td>
<td style="text-align: left;">Replace categories with indicated set of new category names; cannot change the <em>number</em> of categories</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>reorder_categories</code></td>
<td style="text-align: left;">Behaves like <code>rename_categories</code>, but can also change the result to have ordered categories</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>set_categories</code></td>
<td style="text-align: left;">Replace the categories with the indicated set of new categories; can <em>add</em> or <em>remove</em> categories</td>
</tr>
</tbody>
</table>
</section>
<section id="categorical-data-creating-dummy-variables" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-creating-dummy-variables">7.5 Categorical Data: Creating Dummy Variables</h2>
<ul>
<li>Converting categorical data into dummy variables (one-hot encoding).</li>
<li>Used in statistics and machine learning.</li>
</ul>
<div id="41a90aeb" class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>cat_s <span class="op">=</span> pd.Series([<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>] <span class="op">*</span> <span class="dv">2</span>, dtype<span class="op">=</span><span class="st">'category'</span>)</span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>pd.get_dummies(cat_s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="142">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
<th data-quarto-table-cell-role="th">c</th>
<th data-quarto-table-cell-role="th">d</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><code>pd.get_dummies(categorical_series)</code> creates a DataFrame with dummy variables.</li>
</ul>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">7.6 Conclusion</h2>
<ul>
<li>Effective data preparation is crucial for efficient data analysis.</li>
<li>This chapter covered many data cleaning and transformation techniques.</li>
<li>The next chapter explores joining and grouping functionality in pandas.</li>
</ul>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<ul>
<li>Data cleaning is a significant part of data analysis, often taking up 80% or more of an analyst‚Äôs time.</li>
<li>Pandas provides powerful tools for handling missing data (<code>NaN</code>, <code>None</code>), including <code>dropna</code>, <code>fillna</code>, <code>isna</code>, and <code>notna</code>.</li>
<li>Data transformation operations include removing duplicates (<code>duplicated</code>, <code>drop_duplicates</code>), mapping values (<code>map</code>), replacing values (<code>replace</code>), renaming indexes (<code>rename</code>), binning (<code>cut</code>, <code>qcut</code>), outlier detection, permutation, sampling (<code>sample</code>), and creating dummy variables (<code>get_dummies</code>).</li>
<li>Extension data types (<code>Int64Dtype</code>, <code>StringDtype</code>, <code>CategoricalDtype</code>, etc.) offer improved handling of specific data types and missing values.</li>
<li>String manipulation can be done efficiently with Python‚Äôs built-in string methods, regular expressions (<code>re</code> module), and pandas‚Äô <code>str</code> accessor.</li>
<li>The <code>Categorical</code> type provides memory and performance benefits for data with repeated values, offering methods like <code>cat.codes</code>, <code>cat.categories</code>, <code>set_categories</code>, and <code>remove_unused_categories</code>.</li>
</ul>
</section>
<section id="thoughts-and-discussion" class="level2">
<h2 class="anchored" data-anchor-id="thoughts-and-discussion">Thoughts and Discussion ü§î</h2>
<ul>
<li>Reflect on a time you encountered messy data. Which of the techniques discussed in this chapter would have been most helpful?</li>
<li>Why is it important to handle missing data appropriately? What are the potential consequences of ignoring or mishandling it?</li>
<li>How does the <code>Categorical</code> type improve efficiency compared to storing data as strings? When would you choose to use <code>Categorical</code> data?</li>
<li>Can you think of situations where you might <em>not</em> want to drop duplicate data?</li>
<li>Explore the documentation for the <code>re</code> module and pandas‚Äô <code>str</code> accessor. What other useful functions can you find?</li>
<li>Consider the tradeoffs between <code>cut()</code> and <code>qcut()</code>. When would you use one versus the other?</li>
<li>Discuss scenarios for using ordered vs.&nbsp;unordered categorical.</li>
<li>Why might you want to cap outlier to a certain range instead of simply remove all outliers?</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/qiufei\.github\.io\/web-slide-r");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>üîã<a href="https://posit.co"><img src="https://posit.co/wp-content/themes/Posit/assets/images/posit-logo-2024.svg" class="img-fluid" alt="Posit" width="65"></a></p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 ÈÇ±È£û ¬© 2025
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://beian.miit.gov.cn">
<p>ÊµôICPÂ§á 2024072710Âè∑-1</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33021202002511">
<p>ÊµôÂÖ¨ÁΩëÂÆâÂ§á 33021202002511Âè∑</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:hfutqiufei@163.com">
      <i class="bi bi-envelope-at-fill" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>