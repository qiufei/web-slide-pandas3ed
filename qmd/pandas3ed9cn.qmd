---
title: "Python æ•°æ®åˆ†æ"
subtitle: "ç¬¬ 9 ç« ï¼šç»˜å›¾ä¸å¯è§†åŒ–"
---

## å¼•è¨€ ğŸ“Š

> ç”Ÿæˆä¿¡æ¯ä¸°å¯Œçš„å¯è§†åŒ–å›¾å½¢ï¼ˆæœ‰æ—¶ç§°ä¸º*å›¾è¡¨*ï¼‰æ˜¯æ•°æ®åˆ†æä¸­æœ€é‡è¦çš„ä»»åŠ¡ä¹‹ä¸€ã€‚

-   **æ¢ç´¢æ€§è¿‡ç¨‹**ï¼šæœ‰åŠ©äºè¯†åˆ«å¼‚å¸¸å€¼æˆ–éœ€è¦çš„æ•°æ®è½¬æ¢ã€‚
-   **æ¨¡å‹ç”Ÿæˆ**ï¼šæœ‰åŠ©äºäº§ç”Ÿæ¨¡å‹æƒ³æ³•ã€‚
-   **Web å¯è§†åŒ–**ï¼šæ„å»ºäº¤äº’å¼å¯è§†åŒ–å¯èƒ½æ˜¯æœ€ç»ˆç›®æ ‡ã€‚

::: {.callout-note}
Python æœ‰è®¸å¤šç”¨äºå¯è§†åŒ–çš„é™„åŠ åº“ï¼Œä½†æˆ‘ä»¬å°†é‡ç‚¹å…³æ³¨ **matplotlib** ä»¥åŠæ„å»ºåœ¨å…¶ä¹‹ä¸Šçš„åº“ï¼Œä¾‹å¦‚ **seaborn**ã€‚
:::

## ä»€ä¹ˆæ˜¯ matplotlibï¼Ÿ ğŸ–¼ï¸

-   ä¸€ä¸ªæ¡Œé¢ç»˜å›¾åŒ…ï¼Œç”¨äºåˆ›å»ºå‡ºç‰ˆè´¨é‡çš„å›¾è¡¨ã€‚
-   ç”± John Hunter äº 2002 å¹´å‘èµ·ï¼Œæ—¨åœ¨ Python ä¸­æä¾›ç±»ä¼¼ MATLAB çš„ç»˜å›¾ç•Œé¢ã€‚
    -   **ä¸ºä»€ä¹ˆï¼Ÿ** ğŸ¤” ä¸ºäº†è®©ç§‘å­¦å®¶å’Œå·¥ç¨‹å¸ˆæ›´å®¹æ˜“åœ¨ Python ä¸­åˆ›å»ºå›¾è¡¨ï¼Œå°±åƒä»–ä»¬åœ¨ MATLAB ä¸­æ‰€åšçš„é‚£æ ·ï¼
-   ä¸ IPython åˆä½œç®€åŒ–äº¤äº’å¼ç»˜å›¾ã€‚
-   æ”¯æŒå„ç§ GUI åç«¯å’Œå¯¼å‡ºæ ¼å¼ï¼ˆPDFã€SVGã€JPGã€PNGã€BMPã€GIF ç­‰ï¼‰ã€‚
-   è®¸å¤šä¹¦ç±å’Œå‡ºç‰ˆç‰©ä¸­çš„å¤§å¤šæ•°å›¾å½¢éƒ½æ˜¯ä½¿ç”¨ matplotlib ç”Ÿæˆçš„ã€‚

::: {.callout-tip}
Matplotlib å‚¬ç”Ÿäº†åƒ **seaborn** è¿™æ ·çš„é™„åŠ å·¥å…·åŒ…ï¼Œå¢å¼ºäº†å…¶åŠŸèƒ½ã€‚
:::

## åœ¨ Jupyter ä¸­è®¾ç½® matplotlib âš™ï¸

è¦åœ¨ Jupyter Notebook ä¸­ä»¥å†…è”æ–¹å¼æ˜¾ç¤ºå›¾è¡¨ï¼Œè¯·ä½¿ç”¨é­”æœ¯å‘½ä»¤ï¼š

```{python}
%matplotlib inline 
# æ­¤å‘½ä»¤å‘Šè¯‰Jupyterç›´æ¥åœ¨notebookè¾“å‡ºä¸­æ˜¾ç¤ºmatplotlibå›¾è¡¨ã€‚
# æ²¡æœ‰å®ƒï¼Œæ‚¨å¯èƒ½çœ‹ä¸åˆ°æ‚¨çš„å›¾è¡¨ï¼
```

::: {.callout-note}
æ­¤å‘½ä»¤å‘Šè¯‰ Jupyter ç›´æ¥åœ¨ç¬”è®°æœ¬è¾“å‡ºä¸­æ˜¾ç¤º matplotlib å›¾è¡¨ã€‚æ²¡æœ‰å®ƒï¼Œæ‚¨å¯èƒ½çœ‹ä¸åˆ°æ‚¨çš„å›¾è¡¨ï¼
:::

## æ•°æ®å¯è§†åŒ–åº“çš„æ¼”å˜

-   è‡ª 2012 å¹´ä»¥æ¥ï¼Œå‡ºç°äº†è®¸å¤šæ–°çš„å¯è§†åŒ–åº“ã€‚
    -   **Bokeh** å’Œ **Altair**ï¼šåˆ©ç”¨ç°ä»£ Web æŠ€æœ¯è¿›è¡Œäº¤äº’å¼å¯è§†åŒ–ã€‚
-   æœ¬è¯¾ç¨‹é‡ç‚¹ä»‹ç» matplotlibï¼Œå› ä¸ºå®ƒå…·æœ‰åŸºç¡€æ€§å’Œä¸ pandas çš„é›†æˆæ€§ã€‚
    -   **ä¸ºä»€ä¹ˆé€‰æ‹© matplotlibï¼Ÿ** ğŸ¤” è¿™å°±åƒåœ¨è·‘æ­¥ä¹‹å‰å­¦ä¼šèµ°è·¯ï¼ç†è§£ matplotlib å¯ä»¥å¸®åŠ©æ‚¨æŒæ¡åŸºç¡€çŸ¥è¯†ï¼Œä»è€Œæ›´å®¹æ˜“å­¦ä¹ å…¶ä»–åº“ã€‚

::: {.callout-tip}
è¿™é‡Œå­¦åˆ°çš„åŸåˆ™å¯ä»¥é€‚ç”¨äºå…¶ä»–å¯è§†åŒ–åº“ã€‚
:::

## matplotlib API ç®€æ˜å…¥é—¨

matplotlib çš„å¯¼å…¥æƒ¯ä¾‹ï¼š

```{python}
import matplotlib.pyplot as plt 
# è¿™è¡Œä»£ç ä»matplotlibå¯¼å…¥pyplotæ¨¡å—ï¼Œå¹¶ç»™å®ƒä¸€ä¸ªæ›´çŸ­çš„åç§°pltã€‚
# è¿™æ˜¯ä¸€ç§å¸¸è§çš„åšæ³•ï¼Œå¯ä»¥ä½¿æ‚¨çš„ä»£ç æ›´ç®€æ´æ˜“è¯»ã€‚
```

::: {.callout-note}
è¿™è¡Œä»£ç ä» `matplotlib` å¯¼å…¥ `pyplot` æ¨¡å—ï¼Œå¹¶ç»™å®ƒä¸€ä¸ªæ›´çŸ­çš„åç§° `plt`ã€‚è¿™æ˜¯ä¸€ç§å¸¸è§çš„åšæ³•ï¼Œå¯ä»¥ä½¿æ‚¨çš„ä»£ç æ›´ç®€æ´æ˜“è¯»ã€‚
:::

## åˆ›å»ºä¸€ä¸ªç®€å•çš„å›¾è¡¨

```{python}
import numpy as np # å¯¼å…¥numpyåº“ï¼Œå¹¶å°†å…¶é‡å‘½åä¸ºnp
data = np.arange(10) # åˆ›å»ºä¸€ä¸ªåŒ…å«0åˆ°9çš„æ•´æ•°çš„æ•°ç»„
plt.plot(data) # ä½¿ç”¨plt.plot()å‡½æ•°ç»˜åˆ¶dataæ•°ç»„ä¸­çš„æ•°æ®
```

-   **`np.arange(10)`**ï¼šåˆ›å»ºä¸€ä¸ªä» 0 åˆ° 9 çš„æ•°å­—æ•°ç»„ã€‚
-   **`plt.plot(data)`**ï¼šå°†æ•°æ®ç»˜åˆ¶ä¸ºæŠ˜çº¿å›¾ã€‚

## ç®€å•æŠ˜çº¿å›¾ç»“æœ

::: {.callout-tip appearance="simple"}
![å›¾ 9-1. ç®€å•æŠ˜çº¿å›¾](fig9-1.png){width="80%"}
:::

## å›¾å½¢å’Œå­å›¾ ğŸ“

-   matplotlib ä¸­çš„å›¾è¡¨ä½äº **Figure** å¯¹è±¡ä¸­ã€‚

    -   **ä»€ä¹ˆæ˜¯ Figureï¼Ÿ** ğŸ¤” å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªç©ºç™½ç”»å¸ƒï¼Œæ‚¨å¯ä»¥åœ¨ä¸Šé¢ç»˜åˆ¶å›¾è¡¨ã€‚

-   ä½¿ç”¨ `plt.figure()` åˆ›å»ºä¸€ä¸ªæ–°å›¾å½¢ï¼š

```{python}
fig = plt.figure() # åˆ›å»ºä¸€ä¸ªç©ºç™½çš„matplotlibå›¾å½¢å¯¹è±¡
```

-   `plt.figure` é€‰é¡¹ï¼š
    -   `figsize`ï¼šä¿è¯å›¾å½¢å¤§å°å’Œçºµæ¨ªæ¯”ã€‚

## æ·»åŠ å­å›¾ â•

-   æ‚¨ä¸èƒ½åœ¨ç©ºç™½å›¾å½¢ä¸Šç»˜å›¾ï¼›ä½¿ç”¨ `add_subplot` åˆ›å»ºå­å›¾ï¼š

```{python}
ax1 = fig.add_subplot(2, 2, 1) 
# è¿™è¡Œä»£ç åœ¨å‰é¢åˆ›å»ºçš„figureå¯¹è±¡ä¸Šæ·»åŠ ä¸€ä¸ªå­å›¾ã€‚
# å‚æ•°(2, 2, 1)è¡¨ç¤ºï¼š
# åˆ›å»ºä¸€ä¸ª2x2çš„å­å›¾ç½‘æ ¼ï¼ˆæ€»å…±4ä¸ªå­å›¾ï¼‰ã€‚
# é€‰æ‹©ç¬¬ä¸€ä¸ªå­å›¾ï¼ˆç¼–å·ä»1å¼€å§‹ï¼‰ã€‚
# ç±»æ¯”ï¼šå°±åƒåœ¨Excelè¡¨æ ¼ä¸­é€‰æ‹©ä¸€ä¸ªå•å…ƒæ ¼åŒºåŸŸã€‚
```

-   **`add_subplot(2, 2, 1)`** è¡¨ç¤ºï¼š
    -   ä¸€ä¸ª 2x2 çš„å­å›¾ç½‘æ ¼ï¼ˆæ€»å…± 4 ä¸ªå›¾è¡¨ï¼‰ã€‚
    -   é€‰æ‹©ç¬¬ 1 ä¸ªå­å›¾ï¼ˆä» 1 å¼€å§‹ç¼–å·ï¼‰ã€‚
    -   **ç±»æ¯”**ï¼šå°±åƒåœ¨ Excel ä¸­é€‰æ‹©å•å…ƒæ ¼åŒºåŸŸä¸€æ ·ã€‚

## åˆ›å»ºå…¶ä»–å­å›¾

-   åˆ›å»ºå…¶ä»–å­å›¾ï¼š

```{python}
ax2 = fig.add_subplot(2, 2, 2) # åœ¨2x2ç½‘æ ¼ä¸­é€‰æ‹©ç¬¬2ä¸ªå­å›¾
ax3 = fig.add_subplot(2, 2, 3) # åœ¨2x2ç½‘æ ¼ä¸­é€‰æ‹©ç¬¬3ä¸ªå­å›¾
```

## ä¸€ä¸ªåŒ…å«ä¸‰ä¸ªå­å›¾çš„ç©ºå›¾å½¢

::: {.callout-tip appearance="simple"}
![å›¾ 9-2. ä¸€ä¸ªåŒ…å«ä¸‰ä¸ªå­å›¾çš„ç©º matplotlib å›¾å½¢](fig9-2.png)
:::

## Jupyter ä¸­çš„ç»˜å›¾å‘½ä»¤ ğŸ“

::: {.callout-note}
åœ¨ Jupyter Notebook ä¸­ï¼Œå›¾è¡¨åœ¨æ¯ä¸ªå•å…ƒæ ¼åé‡ç½®ã€‚å°†æ‰€æœ‰ç»˜å›¾å‘½ä»¤æ”¾åœ¨ä¸€ä¸ªå•å…ƒæ ¼ä¸­ã€‚

- **ä¸ºä»€ä¹ˆï¼Ÿ** ğŸ¤” Jupyter ç‹¬ç«‹è¿è¡Œæ¯ä¸ªå•å…ƒæ ¼ã€‚å¦‚æœæ‚¨æ‹†åˆ†ç»˜å›¾å‘½ä»¤ï¼Œæ‚¨å¯èƒ½åªä¼šçœ‹åˆ°æœ€åä¸€ä¸ªå›¾è¡¨ï¼
:::

```{python}
fig = plt.figure() # åˆ›å»ºä¸€ä¸ªå›¾å½¢å¯¹è±¡
ax1 = fig.add_subplot(2, 2, 1) # åœ¨å›¾å½¢ä¸­æ·»åŠ ç¬¬ä¸€ä¸ªå­å›¾
ax2 = fig.add_subplot(2, 2, 2) # åœ¨å›¾å½¢ä¸­æ·»åŠ ç¬¬äºŒä¸ªå­å›¾
ax3 = fig.add_subplot(2, 2, 3) # åœ¨å›¾å½¢ä¸­æ·»åŠ ç¬¬ä¸‰ä¸ªå­å›¾
```

## ä½¿ç”¨ Axes æ–¹æ³• ğŸ¯

-   **AxesSubplot** å¯¹è±¡å…·æœ‰åˆ›å»ºä¸åŒå›¾è¡¨ç±»å‹çš„æ–¹æ³•ã€‚
-   ä¼˜å…ˆäº `plt.plot` ç­‰é¡¶çº§å‡½æ•°ã€‚
-   ç¤ºä¾‹ï¼š

```{python}
ax3.plot(np.random.standard_normal(50).cumsum(), color="black", linestyle="dashed")
# åœ¨ç¬¬ä¸‰ä¸ªå­å›¾(ax3)ä¸Šç»˜åˆ¶ä¸€æ¡çº¿ã€‚
# np.random.standard_normal(50)ç”Ÿæˆ50ä¸ªæœä»æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„éšæœºæ•°ã€‚
# .cumsum()è®¡ç®—ç´¯ç§¯å’Œã€‚
# color="black"è®¾ç½®çº¿æ¡é¢œè‰²ä¸ºé»‘è‰²ã€‚
# linestyle="dashed"è®¾ç½®çº¿æ¡æ ·å¼ä¸ºè™šçº¿ã€‚
```

## å•ä¸ªå›¾è¡¨åçš„æ•°æ®å¯è§†åŒ–

::: {.callout-tip appearance="simple"}
![å›¾ 9-3. å•ä¸ªå›¾è¡¨åçš„æ•°æ®å¯è§†åŒ–](fig9-3.png)
:::

## ç†è§£ matplotlib è¾“å‡º ğŸ’¬

-   æ‚¨å¯èƒ½ä¼šçœ‹åˆ°ç±»ä¼¼ `<matplotlib.lines.Line2D at ...>` çš„è¾“å‡ºã€‚
    -   **è¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ** ğŸ¤” å®ƒæ˜¯å¯¹æ‚¨åˆšåˆšæ·»åŠ çš„å›¾è¡¨å…ƒç´ çš„å¼•ç”¨ã€‚æ‚¨é€šå¸¸å¯ä»¥å¿½ç•¥å®ƒã€‚
-   è¦æŠ‘åˆ¶è¾“å‡ºï¼Œè¯·åœ¨è¡Œå°¾æ·»åŠ åˆ†å· (`;`)ã€‚
    -   **ä¸ºä»€ä¹ˆè¦æŠ‘åˆ¶ï¼Ÿ** ğŸ§¹ ä¿æŒç¬”è®°æœ¬è¾“å‡ºå¹²å‡€ï¼Œä¸“æ³¨äºå›¾è¡¨ã€‚

```{python}
ax3.plot(np.random.standard_normal(50).cumsum(), color="black", linestyle="dashed"); # æ³¨æ„åˆ†å·ï¼Œç”¨äºæŠ‘åˆ¶è¾“å‡º
```

## å‘å­å›¾æ·»åŠ æ›´å¤šå›¾è¡¨ â•

```{python}
ax1.hist(np.random.standard_normal(100), bins=20, color="black", alpha=0.3)
# åœ¨ç¬¬ä¸€ä¸ªå­å›¾(ax1)ä¸Šåˆ›å»ºä¸€ä¸ªç›´æ–¹å›¾ã€‚
# np.random.standard_normal(100)ç”Ÿæˆ100ä¸ªæ ‡å‡†æ­£æ€åˆ†å¸ƒçš„éšæœºæ•°ã€‚
# bins=20å°†æ•°æ®åˆ†æˆ20ä¸ªæŸ±å­ã€‚
# color="black"è®¾ç½®æŸ±å­é¢œè‰²ä¸ºé»‘è‰²ã€‚
# alpha=0.3è®¾ç½®é€æ˜åº¦ä¸º0.3ã€‚

ax2.scatter(np.arange(30), np.arange(30) + 3 * np.random.standard_normal(30))
# åœ¨ç¬¬äºŒä¸ªå­å›¾(ax2)ä¸Šåˆ›å»ºä¸€ä¸ªæ•£ç‚¹å›¾ã€‚
# np.arange(30)åˆ›å»ºä»0åˆ°29çš„æ•´æ•°æ•°ç»„ä½œä¸ºxåæ ‡ã€‚
# np.arange(30) + 3 * np.random.standard_normal(30)åˆ›å»ºyåæ ‡ï¼Œå…¶ä¸­åŠ å…¥äº†ä¸€äº›éšæœºå™ªå£°ã€‚
```

-   **`ax1.hist(...)`**ï¼šåˆ›å»ºç›´æ–¹å›¾ã€‚
-   **`ax2.scatter(...)`**ï¼šåˆ›å»ºæ•£ç‚¹å›¾ã€‚
-   `alpha=0.3`ï¼šè®¾ç½®å›¾è¡¨çš„é€æ˜åº¦ã€‚

## å…¶ä»–å›¾è¡¨åçš„æ•°æ®å¯è§†åŒ–

::: {.callout-tip appearance="simple"}
![å›¾ 9-4. å…¶ä»–å›¾è¡¨åçš„æ•°æ®å¯è§†åŒ–](fig9-4.png)
:::

## ä½¿ç”¨ `plt.subplots` æ–¹ä¾¿åœ°åˆ›å»ºå­å›¾

-   `plt.subplots` åˆ›å»ºä¸€ä¸ªå›¾å½¢å’Œä¸€ä¸ªåŒ…å«å­å›¾å¯¹è±¡çš„ NumPy æ•°ç»„ï¼š

```{python}
fig, axes = plt.subplots(2, 3) # åˆ›å»ºä¸€ä¸ªåŒ…å«2è¡Œ3åˆ—å­å›¾çš„å›¾å½¢ï¼Œå¹¶è¿”å›å›¾å½¢å¯¹è±¡(fig)å’Œå­å›¾å¯¹è±¡æ•°ç»„(axes)
axes # æ˜¾ç¤ºå­å›¾å¯¹è±¡æ•°ç»„
```

-   åƒè®¿é—® 2D æ•°ç»„ä¸€æ ·è®¿é—®å­å›¾ï¼š`axes[0, 1]`ã€‚
-   `sharex` å’Œ `sharey`ï¼šå…±äº«ç›¸åŒçš„ x è½´æˆ– y è½´ä»¥æ¯”è¾ƒæ•°æ®ã€‚

## `plt.subplots` é€‰é¡¹ âš™ï¸

| å‚æ•°         | æè¿°                                                                                 |
| :----------- | :----------------------------------------------------------------------------------- |
| `nrows`      | å­å›¾çš„è¡Œæ•°                                                                           |
| `ncols`      | å­å›¾çš„åˆ—æ•°                                                                           |
| `sharex`     | æ‰€æœ‰å­å›¾ä½¿ç”¨ç›¸åŒçš„ x è½´åˆ»åº¦                                                         |
| `sharey`     | æ‰€æœ‰å­å›¾ä½¿ç”¨ç›¸åŒçš„ y è½´åˆ»åº¦                                                         |
| `subplot_kw` | ä¼ é€’ç»™ `add_subplot` çš„å…³é”®å­—å­—å…¸                                                     |
| `**fig_kw`   | ä¼ é€’ç»™ `subplots` çš„å…¶ä»–å…³é”®å­—ï¼ˆä¾‹å¦‚ï¼Œ`figsize=(8, 6)`ï¼‰                                |

::: {.callout-tip appearance="simple"}
è¡¨ 9-1. `matplotlib.pyplot.subplots` é€‰é¡¹
:::

## è°ƒæ•´å­å›¾å‘¨å›´çš„é—´è· ğŸ“

-   å­å›¾ä¹‹é—´æœ‰é»˜è®¤çš„å¡«å……å’Œé—´è·ã€‚
-   ä½¿ç”¨ `subplots_adjust` æ–¹æ³•æ›´æ”¹é—´è·ï¼š

```{python}
fig.subplots_adjust(left=None, bottom=None, right=None, top=None,
                    wspace=None, hspace=None)
# è°ƒæ•´å­å›¾ä¹‹é—´çš„é—´è·ã€‚
# left, bottom, right, top: æ§åˆ¶å›¾å½¢è¾¹ç¼˜ä¸å­å›¾ä¹‹é—´çš„è·ç¦»ã€‚
# wspace: æ§åˆ¶å­å›¾ä¹‹é—´çš„æ°´å¹³é—´è·ã€‚
# hspace: æ§åˆ¶å­å›¾ä¹‹é—´çš„å‚ç›´é—´è·ã€‚
```

-   `wspace` å’Œ `hspace`ï¼šæ§åˆ¶ç”¨äºé—´è·çš„å›¾å½¢å®½åº¦/é«˜åº¦çš„ç™¾åˆ†æ¯”ã€‚

## ç¤ºä¾‹ï¼šå°†é—´è·ç¼©å°åˆ°é›¶ ğŸš«

```{python}
fig, axes = plt.subplots(2, 2, sharex=True, sharey=True) # åˆ›å»ºä¸€ä¸ª2x2çš„å­å›¾ç½‘æ ¼ï¼Œå…±äº«xè½´å’Œyè½´
for i in range(2): # éå†è¡Œ
    for j in range(2): # éå†åˆ—
        axes[i, j].hist(np.random.standard_normal(500), bins=50,
                        color="black", alpha=0.5) # åœ¨æ¯ä¸ªå­å›¾ä¸Šç»˜åˆ¶ç›´æ–¹å›¾
fig.subplots_adjust(wspace=0, hspace=0) # å°†å­å›¾ä¹‹é—´çš„æ°´å¹³å’Œå‚ç›´é—´è·è®¾ç½®ä¸º0
```

## æ— å­å›¾é—´è·çš„æ•°æ®å¯è§†åŒ–

::: {.callout-tip appearance="simple"}
![å›¾ 9-5. æ— å­å›¾é—´è·çš„æ•°æ®å¯è§†åŒ–](fig9-5.png)
:::

## é‡å çš„è½´æ ‡ç­¾

-   matplotlib ä¸æ£€æŸ¥é‡å çš„æ ‡ç­¾ã€‚
-   é€šè¿‡æŒ‡å®šåˆ»åº¦ä½ç½®å’Œæ ‡ç­¾æ¥ä¿®å¤æ ‡ç­¾ã€‚
-   åœ¨â€œåˆ»åº¦ã€æ ‡ç­¾å’Œå›¾ä¾‹â€éƒ¨åˆ†ä¸­ä»‹ç»ã€‚

## é¢œè‰²ã€æ ‡è®°å’Œçº¿å‹ ğŸ¨

-   ä½¿ç”¨é¢œè‰²ã€æ ‡è®°å’Œçº¿å‹è‡ªå®šä¹‰æŠ˜çº¿å›¾ã€‚
-   ç¤ºä¾‹ï¼š

```{python}
#| eval: false
axes.plot(x, y, linestyle="--", color="green") # ä½¿ç”¨ç»¿è‰²è™šçº¿ç»˜åˆ¶(x, y)æ•°æ®
```

-   ä½¿ç”¨é¢œè‰²åç§°æˆ–åå…­è¿›åˆ¶ä»£ç ï¼ˆä¾‹å¦‚ï¼Œ`"#CECECE"`ï¼‰ã€‚
-   çº¿å‹ï¼šæ£€æŸ¥ `plt.plot` æ–‡æ¡£å­—ç¬¦ä¸²ï¼ˆä½¿ç”¨ `plt.plot?`ï¼‰ã€‚

## ç”¨äºçªå‡ºæ˜¾ç¤ºæ•°æ®ç‚¹çš„æ ‡è®° ğŸ“

-   æŠ˜çº¿å›¾å¯ä»¥æœ‰æ ‡è®°æ¥æ˜¾ç¤ºå®é™…æ•°æ®ç‚¹ã€‚
-   å½“æ’å€¼å¯èƒ½ä¼šæ©ç›–ç‚¹çš„ä½ç½®æ—¶å¾ˆæœ‰ç”¨ã€‚
-   ç¤ºä¾‹ï¼š

```{python}
#| eval: false
axes.plot(np.random.standard_normal(30).cumsum(), color="black",
        linestyle="dashed", marker="o")
# ç»˜åˆ¶ä¸€æ¡å¸¦æœ‰åœ†åœˆæ ‡è®°çš„é»‘è‰²è™šçº¿ã€‚
# np.random.standard_normal(30).cumsum()ç”Ÿæˆ30ä¸ªæ ‡å‡†æ­£æ€åˆ†å¸ƒéšæœºæ•°çš„ç´¯ç§¯å’Œã€‚
# marker="o"è®¾ç½®æ ‡è®°ä¸ºåœ†åœˆã€‚
```

## å¸¦æ ‡è®°çš„æŠ˜çº¿å›¾

::: {.callout-tip appearance="simple"}
![å›¾ 9-6. å¸¦æ ‡è®°çš„æŠ˜çº¿å›¾](fig9-6.png)
:::

## `drawstyle` é€‰é¡¹ ğŸ¨

-   çº¿æ€§æ’å€¼æ˜¯é»˜è®¤å€¼ã€‚
-   ä½¿ç”¨ `drawstyle` é€‰é¡¹æ›´æ”¹ï¼š

```{python}
#| eval: false
ax.plot(data, color="black", linestyle="dashed", label="Default") 
# ç»˜åˆ¶ä¸€æ¡é»‘è‰²è™šçº¿ï¼Œæ ‡ç­¾ä¸º"Default"ï¼ˆé»˜è®¤æ’å€¼æ–¹å¼ï¼‰ã€‚

ax.plot(data, color="black", linestyle="dashed",
        drawstyle="steps-post", label="steps-post")
# ç»˜åˆ¶ä¸€æ¡é»‘è‰²è™šçº¿ï¼Œæ ‡ç­¾ä¸º"steps-post"ï¼Œä½¿ç”¨é˜¶æ¢¯å›¾çš„åé˜¶è·ƒæ–¹å¼ã€‚

ax.legend() # æ˜¾ç¤ºå›¾ä¾‹
```

## å…·æœ‰ä¸åŒ `drawstyle` é€‰é¡¹çš„æŠ˜çº¿å›¾

::: {.callout-tip appearance="simple"}
![å›¾ 9-7. å…·æœ‰ä¸åŒ drawstyle é€‰é¡¹çš„æŠ˜çº¿å›¾](fig9-7.png)
:::

## åˆ»åº¦ã€æ ‡ç­¾å’Œå›¾ä¾‹ ğŸ·ï¸

-   å›¾è¡¨è£…é¥°é€šè¿‡ matplotlib åæ ‡è½´å¯¹è±¡æ–¹æ³•è®¿é—®ã€‚
-   `xlim`ã€`xticks`ã€`xticklabels`ï¼šæ§åˆ¶å›¾è¡¨èŒƒå›´ã€åˆ»åº¦ä½ç½®å’Œæ ‡ç­¾ã€‚
-   ä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼š
    -   æ— å‚æ•°ï¼šè¿”å›å½“å‰å€¼ï¼ˆä¾‹å¦‚ï¼Œ`ax.xlim()`ï¼‰ã€‚
    -   å¸¦å‚æ•°ï¼šè®¾ç½®å€¼ï¼ˆä¾‹å¦‚ï¼Œ`ax.xlim([0, 10])`ï¼‰ã€‚

## è‡ªå®šä¹‰åæ ‡è½´ ğŸ› ï¸

-   ç¤ºä¾‹ï¼šéšæœºæ¸¸èµ°å›¾ã€‚

```{python}
fig, ax = plt.subplots() # åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸€ä¸ªå­å›¾çš„å›¾å½¢
ax.plot(np.random.standard_normal(1000).cumsum()) # ç»˜åˆ¶1000ä¸ªæ ‡å‡†æ­£æ€åˆ†å¸ƒéšæœºæ•°çš„ç´¯ç§¯å’Œ
```

## ç”¨äºè¯´æ˜ `xticks` çš„ç®€å•å›¾è¡¨

::: {.callout-tip appearance="simple"}
![å›¾ 9-8. ç”¨äºè¯´æ˜ xticks çš„ç®€å•å›¾è¡¨ï¼ˆå¸¦æœ‰é»˜è®¤æ ‡ç­¾ï¼‰](fig9-8.png)
:::

## è®¾ç½®åˆ»åº¦å’Œåˆ»åº¦æ ‡ç­¾

```{python}
ticks = ax.set_xticks([0, 250, 500, 750, 1000]) # è®¾ç½®xè½´åˆ»åº¦ä½ç½®
labels = ax.set_xticklabels(["one", "two", "three", "four", "five"],
                            rotation=30, fontsize=8)
# è®¾ç½®xè½´åˆ»åº¦æ ‡ç­¾ã€‚
# rotation=30å°†æ ‡ç­¾æ—‹è½¬30åº¦ã€‚
# fontsize=8è®¾ç½®æ ‡ç­¾å­—ä½“å¤§å°ä¸º8ã€‚
```

## è®¾ç½®æ ‡é¢˜å’Œè½´æ ‡ç­¾ ğŸ“

```{python}
ax.set_xlabel("Stages") # è®¾ç½®xè½´æ ‡ç­¾ä¸º"Stages"
ax.set_title("My first matplotlib plot") # è®¾ç½®å­å›¾æ ‡é¢˜ä¸º"My first matplotlib plot"
```

## ç”¨äºè¯´æ˜è‡ªå®šä¹‰ `xticks` çš„ç®€å•å›¾è¡¨

::: {.callout-tip appearance="simple"}
![å›¾ 9-9. ç”¨äºè¯´æ˜è‡ªå®šä¹‰ xticks çš„ç®€å•å›¾è¡¨](fig9-9.png)
:::

-   `rotation`ï¼šè®¾ç½®åˆ»åº¦æ ‡ç­¾æ—‹è½¬ï¼ˆä¾‹å¦‚ï¼Œ30 åº¦ï¼‰ã€‚
-   `set_xlabel`ï¼šå‘½å x è½´ã€‚
-   `set_title`ï¼šè®¾ç½®å­å›¾æ ‡é¢˜ã€‚

## æ‰¹é‡è®¾ç½®å›¾è¡¨å±æ€§ âš™ï¸

-   Axes ç±»æœ‰ä¸€ä¸ª `set` æ–¹æ³•ï¼š

```{python}
ax.set(title="My first matplotlib plot", xlabel="Stages")
# ä½¿ç”¨setæ–¹æ³•ä¸€æ¬¡æ€§è®¾ç½®å¤šä¸ªå±æ€§ã€‚
# ç­‰åŒäºåˆ†åˆ«è°ƒç”¨ax.set_title()å’Œax.set_xlabel()ã€‚
```
## æ·»åŠ å›¾ä¾‹ â•

-   å›¾ä¾‹æ ‡è¯†å›¾è¡¨å…ƒç´ ã€‚
-   æ·»åŠ å›¾è¡¨å…ƒç´ æ—¶ä¼ é€’ `label` å‚æ•°ï¼š

```{python}
fig, ax = plt.subplots() # åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸€ä¸ªå­å›¾çš„å›¾å½¢
ax.plot(np.random.randn(1000).cumsum(), color="black", label="one")
# ç»˜åˆ¶ç¬¬ä¸€æ¡çº¿ï¼Œæ ‡ç­¾ä¸º"one"ã€‚

ax.plot(np.random.randn(1000).cumsum(), color="black", linestyle="dashed", label="two")
# ç»˜åˆ¶ç¬¬äºŒæ¡çº¿ï¼Œæ ‡ç­¾ä¸º"two"ï¼Œçº¿å‹ä¸ºè™šçº¿ã€‚

ax.plot(np.random.randn(1000).cumsum(), color="black", linestyle="dotted", label="three")
# ç»˜åˆ¶ç¬¬ä¸‰æ¡çº¿ï¼Œæ ‡ç­¾ä¸º"three"ï¼Œçº¿å‹ä¸ºç‚¹çº¿ã€‚

ax.legend() # æ˜¾ç¤ºå›¾ä¾‹
```

## å¸¦æœ‰ä¸‰æ¡çº¿å’Œå›¾ä¾‹çš„ç®€å•å›¾è¡¨

::: {.callout-tip appearance="simple"}
![å›¾ 9-10. å¸¦æœ‰ä¸‰æ¡çº¿å’Œå›¾ä¾‹çš„ç®€å•å›¾è¡¨](fig9-10.png)
:::

## `ax.legend()` é€‰é¡¹ âš™ï¸

-   `ax.legend()`ï¼šè‡ªåŠ¨åˆ›å»ºå›¾ä¾‹ã€‚
-   `loc`ï¼šæŒ‡å®šå›¾ä¾‹ä½ç½®ï¼ˆé»˜è®¤ä¸º `"best"`ï¼‰ã€‚
-   æ’é™¤å…ƒç´ ï¼šä¸ä¼ é€’æ ‡ç­¾æˆ–ä¼ é€’ `label="_nolegend_"`ã€‚

## æ³¨é‡Šå’Œåœ¨å­å›¾ä¸Šç»˜å›¾ âœï¸

-   æ·»åŠ è‡ªå®šä¹‰æ³¨é‡Šï¼šæ–‡æœ¬ã€ç®­å¤´ã€å½¢çŠ¶ã€‚
-   `text`ã€`arrow`ã€`annotate` å‡½æ•°ã€‚
-   `ax.text(x, y, "Hello world!", family="monospace", fontsize=10)`ï¼šåœ¨ (x, y) å¤„ç»˜åˆ¶æ–‡æœ¬ã€‚

## æ³¨é‡Šæ ‡å‡†æ™®å°” 500 æŒ‡æ•° ğŸ“ˆ

-   ç¤ºä¾‹ï¼šç»˜åˆ¶ 2007 å¹´ä»¥æ¥çš„æ ‡å‡†æ™®å°” 500 æŒ‡æ•°æ”¶ç›˜ä»·å¹¶æ·»åŠ æ³¨é‡Šã€‚

```{python}
import pandas as pd # å¯¼å…¥pandasåº“
from datetime import datetime # å¯¼å…¥datetimeæ¨¡å—

fig, ax = plt.subplots() # åˆ›å»ºä¸€ä¸ªå›¾å½¢å’Œä¸€ä¸ªå­å›¾

data = pd.read_csv("examples/spx.csv", index_col=0, parse_dates=True)
# ä»CSVæ–‡ä»¶è¯»å–æ•°æ®ã€‚
# index_col=0å°†ç¬¬ä¸€åˆ—è®¾ç½®ä¸ºç´¢å¼•ã€‚
# parse_dates=Trueå°è¯•å°†ç´¢å¼•è§£æä¸ºæ—¥æœŸã€‚

spx = data["SPX"] # è·å–"SPX"åˆ—ï¼ˆæ ‡å‡†æ™®å°”500æŒ‡æ•°ï¼‰

spx.plot(ax=ax, color="black") # ç»˜åˆ¶æ ‡å‡†æ™®å°”500æŒ‡æ•°ï¼Œé¢œè‰²ä¸ºé»‘è‰²
```
## æ³¨é‡Šæ ‡å‡†æ™®å°” 500 æŒ‡æ•°ï¼ˆç»­ï¼‰

```{python}
crisis_data = [
    (datetime(2007, 10, 11), "Peak of bull market"), # ç‰›å¸‚é«˜å³°
    (datetime(2008, 3, 12), "Bear Stearns Fails"),   # è´å°”æ–¯ç™»å€’é—­
    (datetime(2008, 9, 15), "Lehman Bankruptcy")      # é›·æ›¼å…„å¼Ÿç ´äº§
]

for date, label in crisis_data: # éå†å±æœºæ•°æ®
    ax.annotate(label, xy=(date, spx.asof(date) + 75),
                xytext=(date, spx.asof(date) + 225),
                arrowprops=dict(facecolor="black", headwidth=4, width=2,
                                headlength=4),
                horizontalalignment="left", verticalalignment="top")
# ä½¿ç”¨ax.annotate()æ·»åŠ æ³¨é‡Šã€‚
# label: æ³¨é‡Šæ–‡æœ¬ã€‚
# xy: ç®­å¤´æŒ‡å‘çš„åæ ‡(x, y)ã€‚
# xytext: æ–‡æœ¬çš„èµ·å§‹åæ ‡ã€‚
# arrowprops: ç®­å¤´å±æ€§ï¼ˆé¢œè‰²ã€å¤´éƒ¨å®½åº¦ã€ç®­å¤´å®½åº¦ã€å¤´éƒ¨é•¿åº¦ï¼‰ã€‚
# horizontalalignment, verticalalignment: æ–‡æœ¬å¯¹é½æ–¹å¼ã€‚
```
## æ³¨é‡Šæ ‡å‡†æ™®å°” 500 æŒ‡æ•°ï¼ˆç»­ï¼‰

```{python}
# æ”¾å¤§2007-2010å¹´
ax.set_xlim(["1/1/2007", "1/1/2011"]) # è®¾ç½®xè½´èŒƒå›´
ax.set_ylim([600, 1800]) # è®¾ç½®yè½´èŒƒå›´

ax.set_title("Important dates in the 2008-2009 financial crisis") # è®¾ç½®å›¾å½¢æ ‡é¢˜
```

## 2008-2009 å¹´é‡‘èå±æœºä¸­çš„é‡è¦æ—¥æœŸ

::: {.callout-tip appearance="simple"}
![å›¾ 9-11. 2008-2009 å¹´é‡‘èå±æœºä¸­çš„é‡è¦æ—¥æœŸ](fig9-11.png)
:::

## æ ‡å‡†æ™®å°” 500 æŒ‡æ•°å›¾è¡¨ä¸Šçš„é‡è¦ç‚¹

-   `ax.annotate`ï¼šåœ¨æŒ‡å®šçš„ (x, y) åæ ‡å¤„ç»˜åˆ¶æ ‡ç­¾ã€‚
-   `set_xlim`ã€`set_ylim`ï¼šæ‰‹åŠ¨è®¾ç½®å›¾è¡¨è¾¹ç•Œã€‚
-   `ax.set_title`ï¼šæ·»åŠ ä¸»æ ‡é¢˜ã€‚

## ç»˜åˆ¶å½¢çŠ¶ï¼ˆè¡¥ä¸ï¼‰ ğŸ”µğŸ”ºğŸŸ¥

-   matplotlib æœ‰ç§°ä¸º **patches** çš„å¯¹è±¡ï¼Œè¡¨ç¤ºå½¢çŠ¶ã€‚
-   `Rectangle`ã€`Circle`ï¼šåœ¨ `matplotlib.pyplot` ä¸­æ‰¾åˆ°ã€‚
-   å®Œæ•´é›†åˆï¼š`matplotlib.patches`ã€‚
-   ä½¿ç”¨ `ax.add_patch` æ·»åŠ åˆ°å›¾è¡¨ã€‚


```{python}
fig, ax = plt.subplots() # åˆ›å»ºä¸€ä¸ªå›¾å½¢å’Œä¸€ä¸ªå­å›¾
rect = plt.Rectangle((0.2, 0.75), 0.4, 0.15, color="black", alpha=0.3)
# åˆ›å»ºä¸€ä¸ªçŸ©å½¢å¯¹è±¡ã€‚
# (0.2, 0.75): å·¦ä¸‹è§’åæ ‡ã€‚
# 0.4: å®½åº¦ã€‚
# 0.15: é«˜åº¦ã€‚
# color="black": é¢œè‰²ä¸ºé»‘è‰²ã€‚
# alpha=0.3: é€æ˜åº¦ä¸º0.3ã€‚
circ = plt.Circle((0.7, 0.2), 0.15, color="blue", alpha=0.3)
# åˆ›å»ºä¸€ä¸ªåœ†å½¢å¯¹è±¡ã€‚
# (0.7, 0.2): åœ†å¿ƒåæ ‡ã€‚
# 0.15: åŠå¾„ã€‚
# color="blue": é¢œè‰²ä¸ºè“è‰²ã€‚
# alpha=0.3: é€æ˜åº¦ä¸º0.3ã€‚
pgon = plt.Polygon([[0.15, 0.15], [0.35, 0.4], [0.2, 0.6]],
                    color="green", alpha=0.5)
# åˆ›å»ºä¸€ä¸ªå¤šè¾¹å½¢å¯¹è±¡ã€‚
# [[0.15, 0.15], [0.35, 0.4], [0.2, 0.6]]: å¤šè¾¹å½¢é¡¶ç‚¹åæ ‡ã€‚
# color="green": é¢œè‰²ä¸ºç»¿è‰²ã€‚
# alpha=0.5: é€æ˜åº¦ä¸º0.5ã€‚
ax.add_patch(rect) # å°†çŸ©å½¢æ·»åŠ åˆ°å­å›¾
ax.add_patch(circ) # å°†åœ†å½¢æ·»åŠ åˆ°å­å›¾
ax.add_patch(pgon) # å°†å¤šè¾¹å½¢æ·»åŠ åˆ°å­å›¾

```

## ç”±ä¸‰ä¸ªä¸åŒè¡¥ä¸ç»„æˆçš„æ•°æ®å¯è§†åŒ–

::: {.callout-tip appearance="simple"}
![å›¾ 9-12. ç”±ä¸‰ä¸ªä¸åŒè¡¥ä¸ç»„æˆçš„æ•°æ®å¯è§†åŒ–](fig9-12.png)
:::

## å°†å›¾è¡¨ä¿å­˜åˆ°æ–‡ä»¶ ğŸ’¾

-   `savefig` å®ä¾‹æ–¹æ³•ï¼šä¿å­˜æ´»åŠ¨å›¾å½¢ã€‚
-   ç¤ºä¾‹ï¼š

```{python}
fig.savefig("figpath.svg") # å°†å›¾å½¢ä¿å­˜ä¸ºSVGæ–‡ä»¶
```

-   æ–‡ä»¶ç±»å‹ä»æ‰©å±•åæ¨æ–­ï¼ˆä¾‹å¦‚ï¼Œ`.pdf`ã€`.png`ï¼‰ã€‚
-   `dpi`ï¼šæ§åˆ¶æ¯è‹±å¯¸ç‚¹æ•°åˆ†è¾¨ç‡ã€‚

```{python}
fig.savefig("figpath.png", dpi=400) # å°†å›¾å½¢ä¿å­˜ä¸ºPNGæ–‡ä»¶ï¼Œåˆ†è¾¨ç‡ä¸º400 dpi
```

## `savefig` é€‰é¡¹ âš™ï¸

| å‚æ•°        | æè¿°                                                                              |
| :---------- | :-------------------------------------------------------------------------------- |
| `fname`     | æ–‡ä»¶è·¯å¾„æˆ– Python ç±»æ–‡ä»¶å¯¹è±¡ï¼›æ ¼å¼ä»æ‰©å±•åæ¨æ–­                                     |
| `dpi`       | æ¯è‹±å¯¸ç‚¹æ•°åˆ†è¾¨ç‡                                                                  |
| `facecolor` | å­å›¾å¤–éƒ¨çš„å›¾å½¢èƒŒæ™¯é¢œè‰²ï¼ˆé»˜è®¤å€¼ï¼š`"w"` - ç™½è‰²ï¼‰                                     |
|`edgecolor`  |  å›¾å½¢è¾¹ç¼˜çš„é¢œè‰²                                                |
| `format`    | æ˜¾å¼æ–‡ä»¶æ ¼å¼ï¼ˆä¾‹å¦‚ï¼Œ`"png"`ã€`"pdf"`ã€`"svg"`ï¼‰                                  |

::: {.callout-tip appearance="simple"}
è¡¨ 9-2. éƒ¨åˆ† `fig.savefig` é€‰é¡¹
:::

## matplotlib é…ç½® âš™ï¸

-   matplotlib å…·æœ‰é¢œè‰²æ–¹æ¡ˆå’Œé»˜è®¤å€¼çš„é…ç½®ã€‚
-   é€šè¿‡å…¨å±€å‚æ•°è‡ªå®šä¹‰ï¼šå›¾å½¢å¤§å°ã€å­å›¾é—´è·ã€é¢œè‰²ã€å­—ä½“ç­‰ã€‚
-   `rc` æ–¹æ³•ï¼šä»¥ç¼–ç¨‹æ–¹å¼ä¿®æ”¹é…ç½®ã€‚
-   ç¤ºä¾‹ï¼šå°†é»˜è®¤å›¾å½¢å¤§å°è®¾ç½®ä¸º 10x10ã€‚

```{python}
plt.rc("figure", figsize=(10, 10)) # è®¾ç½®é»˜è®¤å›¾å½¢å¤§å°ä¸º10x10è‹±å¯¸
```

## æ¢å¤é»˜è®¤é…ç½®å€¼ ğŸ”„

-   å½“å‰è®¾ç½®ï¼š`plt.rcParams` å­—å…¸ã€‚
-   æ¢å¤é»˜è®¤å€¼ï¼š`plt.rcdefaults()`ã€‚

## è‡ªå®šä¹‰ç‰¹å®šç»„ä»¶ ğŸ§©

-   ç¬¬ä¸€ä¸ª `rc` å‚æ•°ï¼šè¦è‡ªå®šä¹‰çš„ç»„ä»¶ï¼ˆä¾‹å¦‚ï¼Œ`"figure"`ã€`"axes"`ã€`"xtick"`ï¼‰ã€‚
-   åè·Ÿæ–°å‚æ•°çš„å…³é”®å­—å‚æ•°ã€‚
-   ç¤ºä¾‹ï¼š

```{python}
plt.rc("font", family="monospace", weight="bold", size=8)
# è®¾ç½®é»˜è®¤å­—ä½“ã€‚
# family="monospace": ä½¿ç”¨ç­‰å®½å­—ä½“ã€‚
# weight="bold": ä½¿ç”¨ç²—ä½“ã€‚
# size=8: å­—ä½“å¤§å°ä¸º8ã€‚
```

## `matplotlibrc` é…ç½®æ–‡ä»¶ ğŸ“

-   å¹¿æ³›è‡ªå®šä¹‰ï¼š`matplotlib/mpl-data` ä¸­çš„ `matplotlibrc` æ–‡ä»¶ã€‚
-   å°†è‡ªå®šä¹‰çš„ `matplotlibrc` æ”¾åœ¨æ‚¨çš„ä¸»ç›®å½•ä¸­ï¼Œå‘½åä¸º `.matplotlibrc`ã€‚
-   æ¯æ¬¡ä½¿ç”¨ matplotlib æ—¶åŠ è½½ã€‚

## seaborn å’Œ matplotlib é…ç½® ğŸ¨

-   seaborn åœ¨å†…éƒ¨ä½¿ç”¨ matplotlib çš„é…ç½®ç³»ç»Ÿã€‚
-   seaborn å…·æœ‰å†…ç½®çš„å›¾è¡¨ä¸»é¢˜å’Œæ ·å¼ã€‚

## ä½¿ç”¨ pandas å’Œ seaborn ç»˜å›¾

-   Matplotlib å¯èƒ½æ˜¯ä½çº§çš„ã€‚
-   pandasï¼šç”¨äºå¯è§†åŒ– `DataFrame` å’Œ `Series` å¯¹è±¡çš„å†…ç½®æ–¹æ³•ã€‚
-   seabornï¼šåŸºäº matplotlib æ„å»ºçš„é«˜çº§ç»Ÿè®¡å›¾å½¢åº“ã€‚
-   seaborn ç®€åŒ–äº†åˆ›å»ºå¸¸è§å¯è§†åŒ–ç±»å‹çš„è¿‡ç¨‹ã€‚

## ä½¿ç”¨ pandas çš„æŠ˜çº¿å›¾ ğŸ“ˆ

-   `Series` å’Œ `DataFrame` æœ‰ä¸€ä¸ª `plot` å±æ€§ã€‚
-   `plot()` é»˜è®¤åˆ›å»ºæŠ˜çº¿å›¾ï¼š

```{python}
s = pd.Series(np.random.standard_normal(10).cumsum(), index=np.arange(0, 100, 10))
# åˆ›å»ºä¸€ä¸ªSerieså¯¹è±¡ã€‚
# np.random.standard_normal(10).cumsum(): ç”Ÿæˆ10ä¸ªæ ‡å‡†æ­£æ€åˆ†å¸ƒéšæœºæ•°çš„ç´¯ç§¯å’Œã€‚
# index=np.arange(0, 100, 10): è®¾ç½®ç´¢å¼•ä¸º0, 10, 20, ..., 90ã€‚

s.plot() # ç»˜åˆ¶Seriesçš„æŠ˜çº¿å›¾
```
## ç®€å• Series å›¾è¡¨

::: {.callout-tip appearance="simple"}
![å›¾ 9-13. ç®€å• Series å›¾è¡¨](fig9-13.png)
:::

-   Series ç´¢å¼•ï¼šç”¨äº x è½´ï¼ˆä½¿ç”¨ `use_index=False` ç¦ç”¨ï¼‰ã€‚
-   `xticks`ã€`xlim`ã€`yticks`ã€`ylim`ï¼šè°ƒæ•´è½´åˆ»åº¦å’Œé™åˆ¶ã€‚

## `Series.plot` æ–¹æ³•å‚æ•° âš™ï¸

| å‚æ•°         | æè¿°                                                                  |
| :----------- | :--------------------------------------------------------------------------- |
| `label`      | å›¾ä¾‹æ ‡ç­¾                                                        |
| `ax`         | è¦ç»˜åˆ¶çš„ matplotlib å­å›¾å¯¹è±¡                                           |
| `style`      | æ ·å¼å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ï¼Œ`"ko--"`ï¼‰                                                 |
| `alpha`      | å›¾è¡¨å¡«å……ä¸é€æ˜åº¦ï¼ˆ0 åˆ° 1ï¼‰                                                   |
| `kind`       | å›¾è¡¨ç±»å‹ï¼š`"area"`ã€`"bar"`ã€`"barh"`ã€`"density"`ã€`"hist"`ã€`"kde"`ã€`"line"`ã€`"pie"` |
| `figsize`    | å›¾å½¢å¯¹è±¡çš„å¤§å°                                                    |
| `logx`       | x è½´ä¸Šçš„å¯¹æ•°ç¼©æ”¾                                                |
| `logy`       | y è½´ä¸Šçš„å¯¹æ•°ç¼©æ”¾                                                |
| `title`      | å›¾è¡¨æ ‡é¢˜                                                           |
| `use_index`  | ä½¿ç”¨å¯¹è±¡ç´¢å¼•ä½œä¸ºåˆ»åº¦æ ‡ç­¾                                             |
| `rot`        | åˆ»åº¦æ ‡ç­¾æ—‹è½¬ï¼ˆ0-360ï¼‰                                              |
| `xticks`     | x è½´åˆ»åº¦å€¼                                                      |
| `yticks`     | y è½´åˆ»åº¦å€¼                                                      |
| `xlim`       | x è½´é™åˆ¶ï¼ˆä¾‹å¦‚ï¼Œ`[0, 10]`)                                               |
| `ylim`       | y è½´é™åˆ¶                                                                |
| `grid`       | æ˜¾ç¤ºè½´ç½‘æ ¼ï¼ˆé»˜è®¤å…³é—­ï¼‰                                           |

::: {.callout-tip appearance="simple"}
è¡¨ 9-3. `Series.plot` æ–¹æ³•å‚æ•°
:::

-   pandas ç»˜å›¾æ–¹æ³•æ¥å—å¯é€‰çš„ `ax` å‚æ•°ï¼Œç”¨äºæŒ‡å®š matplotlib å­å›¾å¯¹è±¡ã€‚

## DataFrame æŠ˜çº¿å›¾ ğŸ“Š

```{python}
df = pd.DataFrame(np.random.standard_normal((10, 4)).cumsum(0),
                  columns=["A", "B", "C", "D"],
                  index=np.arange(0, 100, 10))
# åˆ›å»ºä¸€ä¸ªDataFrameå¯¹è±¡ã€‚
# np.random.standard_normal((10, 4)).cumsum(0): ç”Ÿæˆ10x4çš„æ ‡å‡†æ­£æ€åˆ†å¸ƒéšæœºæ•°ï¼Œå¹¶æ²¿åˆ—(axis=0)è®¡ç®—ç´¯ç§¯å’Œã€‚
# columns=["A", "B", "C", "D"]: è®¾ç½®åˆ—åä¸ºA, B, C, Dã€‚
# index=np.arange(0, 100, 10): è®¾ç½®ç´¢å¼•ä¸º0, 10, 20, ..., 90ã€‚
plt.style.use('grayscale') # ä½¿ç”¨ç°åº¦æ ·å¼ï¼Œä»¥é€‚åº”é»‘ç™½å‡ºç‰ˆç‰©
df.plot() # ç»˜åˆ¶DataFrameçš„æŠ˜çº¿å›¾ï¼Œæ¯åˆ—ä¸€æ¡çº¿
```

## ç®€å• DataFrame å›¾è¡¨

::: {.callout-tip appearance="simple"}
![å›¾ 9-14. ç®€å• DataFrame å›¾è¡¨](fig9-14.png)
:::

-   å°†æ¯åˆ—ç»˜åˆ¶ä¸ºåŒä¸€å­å›¾ä¸Šçš„å•ç‹¬çº¿æ¡ã€‚
-   è‡ªåŠ¨åˆ›å»ºå›¾ä¾‹ã€‚
-   `df.plot()` ç­‰åŒäº `df.plot.line()`.

## `DataFrame.plot` é€‰é¡¹ âš™ï¸

| å‚æ•°           | æè¿°                                                           |
| :------------- | :-------------------------------------------------------------------- |
| `subplots`     | åœ¨å•ç‹¬çš„å­å›¾ä¸­ç»˜åˆ¶æ¯ä¸ª DataFrame åˆ—                     |
|  `layout`        |  2 å…ƒç»„ï¼ˆè¡Œã€åˆ—ï¼‰ï¼Œç”¨äºå­å›¾å¸ƒå±€                            |
| `sharex`       | å¦‚æœ `subplots=True`ï¼Œå…±äº« x è½´åˆ»åº¦å’Œé™åˆ¶                    |
| `sharey`       | å¦‚æœ `subplots=True`ï¼Œå…±äº« y è½´                                      |
| `legend`       | æ·»åŠ å­å›¾å›¾ä¾‹ï¼ˆé»˜è®¤ä¸º Trueï¼‰                                |
| `sort_columns` | æŒ‰å­—æ¯é¡ºåºç»˜åˆ¶åˆ—ï¼ˆé»˜è®¤å€¼ï¼šä½¿ç”¨ç°æœ‰é¡ºåºï¼‰     |

::: {.callout-tip appearance="simple"}
è¡¨ 9-4. `DataFrame` ç‰¹å®šçš„å›¾è¡¨å‚æ•°
:::

-   å…¶ä»–å…³é”®å­—å‚æ•°å°†ä¼ é€’ç»™ matplotlib ç»˜å›¾å‡½æ•°ã€‚

## æ¡å½¢å›¾ ğŸ“Š

-   `plot.bar()`: å‚ç›´æ¡å½¢å›¾ã€‚
-   `plot.barh()`: æ°´å¹³æ¡å½¢å›¾ã€‚
-   Series/DataFrame ç´¢å¼•ï¼šç”¨äº x (bar) æˆ– y (barh) åˆ»åº¦ã€‚

```{python}
fig, axes = plt.subplots(2, 1) # åˆ›å»ºä¸€ä¸ªåŒ…å«2è¡Œ1åˆ—å­å›¾çš„å›¾å½¢
data = pd.Series(np.random.uniform(size=16), index=list("abcdefghijklmnop"))
# åˆ›å»ºä¸€ä¸ªSerieså¯¹è±¡ã€‚
# np.random.uniform(size=16): ç”Ÿæˆ16ä¸ªå‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°ã€‚
# index=list("abcdefghijklmnop"): è®¾ç½®ç´¢å¼•ä¸ºå­—æ¯aåˆ°pã€‚

data.plot.bar(ax=axes[0], color="black", alpha=0.7)
# åœ¨ç¬¬ä¸€ä¸ªå­å›¾(axes[0])ä¸Šç»˜åˆ¶å‚ç›´æ¡å½¢å›¾ã€‚
# color="black": è®¾ç½®æ¡å½¢é¢œè‰²ä¸ºé»‘è‰²ã€‚
# alpha=0.7: è®¾ç½®é€æ˜åº¦ä¸º0.7ã€‚
```

## æ¡å½¢å›¾ï¼ˆç»­ï¼‰

```{python}
data.plot.barh(ax=axes[1], color="black", alpha=0.7)
# åœ¨ç¬¬äºŒä¸ªå­å›¾(axes[1])ä¸Šç»˜åˆ¶æ°´å¹³æ¡å½¢å›¾ã€‚
# color="black": è®¾ç½®æ¡å½¢é¢œè‰²ä¸ºé»‘è‰²ã€‚
# alpha=0.7: è®¾ç½®é€æ˜åº¦ä¸º0.7ã€‚
```
## æ°´å¹³å’Œå‚ç›´æ¡å½¢å›¾

::: {.callout-tip appearance="simple"}
![å›¾ 9-15. æ°´å¹³å’Œå‚ç›´æ¡å½¢å›¾](fig9-15.png)
:::

## DataFrame æ¡å½¢å›¾ ğŸ“Š

```{python}
df = pd.DataFrame(np.random.uniform(size=(6, 4)),
                  index=["one", "two", "three", "four", "five", "six"],
                  columns=pd.Index(["A", "B", "C", "D"], name="Genus"))
# åˆ›å»ºä¸€ä¸ªDataFrameå¯¹è±¡ã€‚
# np.random.uniform(size=(6, 4)): ç”Ÿæˆ6x4çš„å‡åŒ€åˆ†å¸ƒéšæœºæ•°ã€‚
# index=["one", "two", "three", "four", "five", "six"]: è®¾ç½®è¡Œç´¢å¼•ã€‚
# columns=pd.Index(["A", "B", "C", "D"], name="Genus"): è®¾ç½®åˆ—ç´¢å¼•ï¼Œå¹¶å‘½åä¸º"Genus"ã€‚

df.plot.bar() # ç»˜åˆ¶DataFrameçš„æ¡å½¢å›¾ï¼Œæ¯è¡Œçš„æ•°æ®å¹¶æ’æ˜¾ç¤º
```

## DataFrame æ¡å½¢å›¾

::: {.callout-tip appearance="simple"}
![å›¾ 9-16. DataFrame æ¡å½¢å›¾](fig9-16.png)
:::

-   å°†æ¯è¡Œä¸­çš„å€¼åˆ†ç»„åœ¨æ¡å½¢ä¸­ï¼Œå¹¶æ’æ˜¾ç¤ºã€‚
-   DataFrame åˆ—åï¼šç”¨ä½œå›¾ä¾‹æ ‡é¢˜ã€‚

## å †å æ¡å½¢å›¾ ğŸ“š

-   `stacked=True`: åˆ›å»ºå †å æ¡å½¢å›¾ã€‚
-   æ¯è¡Œä¸­çš„å€¼å †å åœ¨ä¸€èµ·ã€‚

```{python}
df.plot.barh(stacked=True, alpha=0.5)
# ç»˜åˆ¶æ°´å¹³å †å æ¡å½¢å›¾ã€‚
# stacked=True: è®¾ç½®ä¸ºå †å æ¡å½¢å›¾ã€‚
# alpha=0.5: è®¾ç½®é€æ˜åº¦ä¸º0.5ã€‚
```

## DataFrame å †å æ¡å½¢å›¾

::: {.callout-tip appearance="simple"}
![å›¾ 9-17. DataFrame å †å æ¡å½¢å›¾](fig9-17.png)
:::

## ç¤ºä¾‹ï¼šé¤å…å°è´¹æ•°æ® ğŸ½ï¸

-   å¯è§†åŒ–å°è´¹æ•°æ®ï¼šæ¯ä¸ªèšä¼šè§„æ¨¡ã€æ¯å¤©çš„æ•°æ®ç‚¹ç™¾åˆ†æ¯”ã€‚
-   `read_csv`: åŠ è½½æ•°æ®ã€‚
-   `crosstab`: æŒ‰å¤©å’Œèšä¼šè§„æ¨¡è¿›è¡Œäº¤å‰è¡¨è®¡ç®—ã€‚

```{python}
tips = pd.read_csv("examples/tips.csv") # ä»CSVæ–‡ä»¶è¯»å–å°è´¹æ•°æ®
party_counts = pd.crosstab(tips["day"], tips["size"])
# ä½¿ç”¨crosstabè®¡ç®—æ¯å¤©(day)å’Œèšä¼šè§„æ¨¡(size)çš„äº¤å‰è¡¨ã€‚
# äº¤å‰è¡¨ç”¨äºç»Ÿè®¡æ¯ä¸ªç»„åˆçš„é¢‘æ•°ã€‚

party_counts = party_counts.reindex(index=["Thur", "Fri", "Sat", "Sun"])
# é‡æ–°ç´¢å¼•è¡Œï¼Œç¡®ä¿é¡ºåºä¸º"Thur", "Fri", "Sat", "Sun"ã€‚
```

## é¤å…å°è´¹æ•°æ®ï¼ˆç»­ï¼‰

- è®¡ç®—æ•°æ®æ¡†ä¸­ä¸¤åˆ—æ•°æ®çš„é¢‘æ•°ã€‚

```{python}
# åˆ é™¤1äººå’Œ6äººçš„èšä¼š
party_counts = party_counts.loc[:, 2:5]
# é€šè¿‡æ ‡ç­¾è¿›è¡Œé€‰æ‹©ï¼Œæ­¤å¤„é€‰æ‹©åˆ—æ ‡ç­¾ä»2åˆ°5ï¼ˆåŒ…æ‹¬ï¼‰çš„åˆ—ï¼Œå³èšä¼šè§„æ¨¡ä¸º2ã€3ã€4å’Œ5çš„æ•°æ®ã€‚

# å½’ä¸€åŒ–ï¼Œä½¿æ¯è¡Œçš„å’Œä¸º1
party_pcts = party_counts.div(party_counts.sum(axis="columns"), axis="index")
# è®¡ç®—æ¯ä¸ªèšä¼šè§„æ¨¡å å½“å¤©æ€»èšä¼šæ•°çš„ç™¾åˆ†æ¯”ã€‚
# party_counts.sum(axis="columns"): è®¡ç®—æ¯è¡Œçš„æ€»å’Œã€‚
# .div(): æ‰§è¡Œé™¤æ³•ï¼Œå°†æ¯è¡Œçš„æ¯ä¸ªå…ƒç´ é™¤ä»¥è¯¥è¡Œçš„æ€»å’Œã€‚
# axis="index": æŒ‡å®šé™¤æ³•è¿ç®—æŒ‰è¡Œè¿›è¡Œã€‚

party_pcts.plot.bar(stacked=True) # ç»˜åˆ¶å †å æ¡å½¢å›¾ï¼Œå±•ç¤ºæ¯ä¸ªèšä¼šè§„æ¨¡å å½“å¤©æ€»èšä¼šæ•°çš„ç™¾åˆ†æ¯”
```

## æ¯å¤©å„èšä¼šè§„æ¨¡çš„å æ¯”

::: {.callout-tip appearance="simple"}
![å›¾ 9-18. æ¯å¤©å„èšä¼šè§„æ¨¡çš„å æ¯”](fig9-18.png)
:::

## seaborn ç”¨äºæ›´ç®€å•çš„èšåˆå’Œæ±‡æ€» ğŸ“Š

-   seaborn ç®€åŒ–äº†ä½¿ç”¨èšåˆ/æ±‡æ€»æ•°æ®çš„ç»˜å›¾ã€‚
-   ç¤ºä¾‹ï¼šæ¯å¤©çš„å°è´¹ç™¾åˆ†æ¯”ã€‚

```{python}
import seaborn as sns # å¯¼å…¥seabornåº“

tips["tip_pct"] = tips["tip"] / (tips["total_bill"] - tips["tip"])
# æ·»åŠ ä¸€åˆ—"tip_pct"ï¼Œè®¡ç®—å°è´¹ç™¾åˆ†æ¯”ã€‚

sns.barplot(x="tip_pct", y="day", data=tips, orient="h")
# ä½¿ç”¨seabornçš„barplotç»˜åˆ¶æ¡å½¢å›¾ã€‚
# x="tip_pct": xè½´ä½¿ç”¨"tip_pct"åˆ—çš„æ•°æ®ã€‚
# y="day": yè½´ä½¿ç”¨"day"åˆ—çš„æ•°æ®ã€‚
# data=tips: æ•°æ®æ¥æºä¸ºtips DataFrameã€‚
# orient="h": æ°´å¹³æ˜¾ç¤ºæ¡å½¢å›¾ã€‚
```

## æ¯å¤©çš„å°è´¹ç™¾åˆ†æ¯”ï¼ˆå¸¦è¯¯å·®æ¡ï¼‰

::: {.callout-tip appearance="simple"}
![å›¾ 9-19. æ¯å¤©çš„å°è´¹ç™¾åˆ†æ¯”ï¼ˆå¸¦è¯¯å·®æ¡ï¼‰](fig9-19.png)
:::

-   `data`: pandas DataFrameã€‚
-   å…¶ä»–å‚æ•°ï¼šåˆ—åã€‚
-   æ¡å½¢ï¼š`tip_pct` çš„å¹³å‡å€¼ã€‚
-   é»‘çº¿ï¼š95% ç½®ä¿¡åŒºé—´ã€‚

## æŒ‰å…¶ä»–åˆ†ç±»å€¼æ‹†åˆ† ğŸŒˆ

-   `seaborn.barplot` ä¸­çš„ `hue` é€‰é¡¹ï¼šæŒ‰å¦ä¸€ä¸ªåˆ†ç±»å€¼æ‹†åˆ†ã€‚

```{python}
sns.barplot(x="tip_pct", y="day", hue="time", data=tips, orient="h")
# ä½¿ç”¨seabornçš„barplotç»˜åˆ¶æ¡å½¢å›¾ï¼Œå¹¶æŒ‰"time"åˆ—è¿›è¡Œåˆ†ç»„ã€‚
# hue="time": æ ¹æ®"time"åˆ—çš„å€¼å¯¹æ¡å½¢å›¾è¿›è¡Œç€è‰²åŒºåˆ†ã€‚
```

## æ¯å¤©å’Œæ¯æ—¶æ®µçš„å°è´¹ç™¾åˆ†æ¯”

::: {.callout-tip appearance="simple"}
![å›¾ 9-20. æ¯å¤©å’Œæ¯æ—¶æ®µçš„å°è´¹ç™¾åˆ†æ¯”](fig9-20.png)
:::

## seaborn å›¾è¡¨ç¾å­¦ ğŸ¨

-   seaborn è‡ªåŠ¨è°ƒæ•´å›¾è¡¨ç¾å­¦ï¼š
    -   è°ƒè‰²æ¿ã€‚
    -   å›¾è¡¨èƒŒæ™¯ã€‚
    -   ç½‘æ ¼çº¿é¢œè‰²ã€‚
-   `seaborn.set_style`ï¼šåœ¨å›¾è¡¨å¤–è§‚ä¹‹é—´åˆ‡æ¢ã€‚

```{python}
sns.set_style("whitegrid") # è®¾ç½®å›¾è¡¨æ ·å¼ä¸ºç™½è‰²ç½‘æ ¼èƒŒæ™¯
```

-   å¯¹äºç°åº¦ï¼Œè®¾ç½®ç°åº¦è°ƒè‰²æ¿ï¼š

```{python}
sns.set_palette("Greys_r") # è®¾ç½®è°ƒè‰²æ¿ä¸ºç°åº¦
```

## ç›´æ–¹å›¾å’Œå¯†åº¦å›¾ ğŸ“Š

-   **ç›´æ–¹å›¾**ï¼šå€¼é¢‘ç‡çš„ç¦»æ•£åŒ–æ˜¾ç¤ºã€‚
-   æ•°æ®ç‚¹è¢«åˆ†ç®±ï¼Œå¹¶ç»˜åˆ¶æ¯ä¸ªç®±ä¸­çš„è®¡æ•°ã€‚
-   `plot.hist`ï¼šåˆ›å»ºç›´æ–¹å›¾ã€‚

```{python}
tips["tip_pct"].plot.hist(bins=50)
# ç»˜åˆ¶"tip_pct"åˆ—çš„ç›´æ–¹å›¾ã€‚
# bins=50: å°†æ•°æ®åˆ†æˆ50ä¸ªæŸ±å­ã€‚
```

## å°è´¹ç™¾åˆ†æ¯”çš„ç›´æ–¹å›¾

::: {.callout-tip appearance="simple"}
![å›¾ 9-21. å°è´¹ç™¾åˆ†æ¯”çš„ç›´æ–¹å›¾](fig9-21.png)
:::

## å¯†åº¦å›¾ ğŸ“ˆ

-   **å¯†åº¦å›¾**ï¼šè¿ç»­æ¦‚ç‡åˆ†å¸ƒçš„ä¼°è®¡ã€‚
-   è¿‘ä¼¼ä¸ºæ ¸ï¼ˆä¾‹å¦‚ï¼Œæ­£æ€åˆ†å¸ƒï¼‰çš„æ··åˆã€‚
-   ä¹Ÿç§°ä¸ºæ ¸å¯†åº¦ä¼°è®¡ (KDE) å›¾ã€‚
-   `plot.density`ï¼šåˆ›å»ºå¯†åº¦å›¾ã€‚

```{python}
tips["tip_pct"].plot.density() # ç»˜åˆ¶"tip_pct"åˆ—çš„å¯†åº¦å›¾
```

## å°è´¹ç™¾åˆ†æ¯”çš„å¯†åº¦å›¾

::: {.callout-tip appearance="simple"}
![å›¾ 9-22. å°è´¹ç™¾åˆ†æ¯”çš„å¯†åº¦å›¾](fig9-22.png)
:::

::: {.callout-note}
å¯†åº¦å›¾éœ€è¦ SciPyï¼š `conda install scipy`
:::

## seaborn çš„ `histplot` ğŸ“Š

-   seaborn ç®€åŒ–äº†ç›´æ–¹å›¾å’Œå¯†åº¦å›¾ã€‚
-   `histplot`ï¼šåŒæ—¶ç»˜åˆ¶ç›´æ–¹å›¾å’Œè¿ç»­å¯†åº¦ä¼°è®¡ã€‚
-   ç¤ºä¾‹ï¼šåŒå³°åˆ†å¸ƒã€‚

```{python}
comp1 = np.random.standard_normal(200) # ç”Ÿæˆ200ä¸ªæ ‡å‡†æ­£æ€åˆ†å¸ƒçš„éšæœºæ•°
comp2 = 10 + 2 * np.random.standard_normal(200) # ç”Ÿæˆ200ä¸ªå‡å€¼ä¸º10ã€æ ‡å‡†å·®ä¸º2çš„æ­£æ€åˆ†å¸ƒéšæœºæ•°
values = pd.Series(np.concatenate([comp1, comp2])) # å°†ä¸¤ä¸ªæ•°ç»„è¿æ¥èµ·æ¥ï¼Œå¹¶è½¬æ¢ä¸ºSerieså¯¹è±¡
sns.histplot(values, bins=100, color="black")
# ä½¿ç”¨seabornçš„histplotç»˜åˆ¶ç›´æ–¹å›¾å’Œå¯†åº¦ä¼°è®¡ã€‚
# bins=100: å°†æ•°æ®åˆ†æˆ100ä¸ªæŸ±å­ã€‚
# color="black": è®¾ç½®é¢œè‰²ä¸ºé»‘è‰²ã€‚
```

## æ­£æ€æ··åˆçš„å½’ä¸€åŒ–ç›´æ–¹å›¾

::: {.callout-tip appearance="simple"}
![å›¾ 9-23. æ­£æ€æ··åˆçš„å½’ä¸€åŒ–ç›´æ–¹å›¾](fig9-23.png)
:::

## æ•£ç‚¹å›¾æˆ–ç‚¹å›¾ ğŸ”

-   æ£€æŸ¥ä¸¤ä¸ªä¸€ç»´æ•°æ®åºåˆ—ä¹‹é—´çš„å…³ç³»ã€‚
-   ç¤ºä¾‹ï¼šåŠ è½½å®è§‚ç»æµæ•°æ®ï¼Œè®¡ç®—å¯¹æ•°å·®ã€‚

```{python}
macro = pd.read_csv("examples/macrodata.csv") # ä»CSVæ–‡ä»¶è¯»å–å®è§‚ç»æµæ•°æ®
data = macro[["cpi", "m1", "tbilrate", "unemp"]] # é€‰æ‹©"cpi", "m1", "tbilrate", "unemp"å››åˆ—æ•°æ®
trans_data = np.log(data).diff().dropna()
# è®¡ç®—æ•°æ®çš„å¯¹æ•°å·®ã€‚
# np.log(data): å¯¹æ•°æ®å–å¯¹æ•°ã€‚
# .diff(): è®¡ç®—å·®åˆ†ã€‚
# .dropna(): åˆ é™¤åŒ…å«ç¼ºå¤±å€¼çš„è¡Œã€‚
```

## seaborn çš„ `regplot` ğŸ“ˆ

-   `regplot`ï¼šç»˜åˆ¶æ•£ç‚¹å›¾å¹¶æ‹Ÿåˆçº¿æ€§å›å½’çº¿ã€‚

```{python}
ax = sns.regplot(x="m1", y="unemp", data=trans_data)
# ä½¿ç”¨seabornçš„regplotç»˜åˆ¶æ•£ç‚¹å›¾ï¼Œå¹¶æ‹Ÿåˆçº¿æ€§å›å½’çº¿ã€‚
# x="m1": xè½´ä½¿ç”¨"m1"åˆ—çš„æ•°æ®ã€‚
# y="unemp": yè½´ä½¿ç”¨"unemp"åˆ—çš„æ•°æ®ã€‚
# data=trans_data: æ•°æ®æ¥æºä¸ºtrans_dataã€‚

ax.set_title("Changes in log(m1) versus log(unemp)") # æ·»åŠ å›¾è¡¨æ ‡é¢˜
```

## seaborn å›å½’/æ•£ç‚¹å›¾

::: {.callout-tip appearance="simple"}
![å›¾ 9-24. seaborn å›å½’/æ•£ç‚¹å›¾](fig9-24.png)
:::

## é…å¯¹å›¾æˆ–æ•£ç‚¹å›¾çŸ©é˜µ ğŸ”

-   æ¢ç´¢ä¸€ç»„å˜é‡ä¹‹é—´çš„æ•£ç‚¹å›¾ã€‚
-   `seaborn.pairplot`ï¼šåˆ›å»ºé…å¯¹å›¾ã€‚
-   æ”¯æŒå¯¹è§’çº¿ä¸Šçš„ç›´æ–¹å›¾/å¯†åº¦ä¼°è®¡ã€‚

```{python}
sns.pairplot(trans_data, diag_kind="kde", plot_kws={"alpha": 0.2})
# ä½¿ç”¨seabornçš„pairplotåˆ›å»ºé…å¯¹å›¾ã€‚
# diag_kind="kde": å¯¹è§’çº¿ä¸Šçš„å›¾è¡¨ç±»å‹ä¸ºæ ¸å¯†åº¦ä¼°è®¡ã€‚
# plot_kws={"alpha": 0.2}: è®¾ç½®æ•£ç‚¹å›¾çš„é€æ˜åº¦ä¸º0.2ã€‚
```

## Statsmodels å®è§‚æ•°æ®çš„é…å¯¹å›¾çŸ©é˜µ

::: {.callout-tip appearance="simple"}
![å›¾ 9-25. Statsmodels å®è§‚æ•°æ®çš„é…å¯¹å›¾çŸ©é˜µ](fig9-25.png)
:::

## `plot_kws` å‚æ•° âš™ï¸

-   å°†é…ç½®é€‰é¡¹ä¼ é€’ç»™å•ç‹¬çš„ç»˜å›¾è°ƒç”¨ã€‚
-   æŸ¥çœ‹ `seaborn.pairplot` æ–‡æ¡£å­—ç¬¦ä¸²äº†è§£è¯¦ç»†ä¿¡æ¯ã€‚

## åˆ†é¢ç½‘æ ¼å’Œåˆ†ç±»æ•°æ® ğŸ“Š

-   å¯è§†åŒ–å…·æœ‰è®¸å¤šåˆ†ç±»å˜é‡çš„æ•°æ®ã€‚
-   **åˆ†é¢ç½‘æ ¼**ï¼šäºŒç»´å¸ƒå±€ï¼Œæ•°æ®æ ¹æ®å˜é‡å€¼åœ¨å›¾è¡¨ä¹‹é—´æ‹†åˆ†ã€‚
-   `seaborn.catplot`ï¼šç®€åŒ–åˆ†é¢å›¾ã€‚

```{python}
sns.catplot(x="day", y="tip_pct", hue="time", col="smoker",
            kind="bar", data=tips[tips.tip_pct < 1])
# ä½¿ç”¨seabornçš„catplotåˆ›å»ºåˆ†é¢æ¡å½¢å›¾ã€‚
# x="day": xè½´ä½¿ç”¨"day"åˆ—çš„æ•°æ®ã€‚
# y="tip_pct": yè½´ä½¿ç”¨"tip_pct"åˆ—çš„æ•°æ®ã€‚
# hue="time": æ ¹æ®"time"åˆ—çš„å€¼å¯¹æ¡å½¢å›¾è¿›è¡Œç€è‰²åŒºåˆ†ã€‚
# col="smoker": æ ¹æ®"smoker"åˆ—çš„å€¼å°†å›¾è¡¨åˆ†æˆä¸åŒçš„åˆ—ã€‚
# kind="bar": å›¾è¡¨ç±»å‹ä¸ºæ¡å½¢å›¾ã€‚
# data=tips[tips.tip_pct < 1]: æ•°æ®æ¥æºä¸ºtips DataFrameä¸­"tip_pct"å°äº1çš„è¡Œã€‚
```

## æŒ‰å¤©/æ—¶é—´/å¸çƒŸè€…åˆ’åˆ†çš„å°è´¹ç™¾åˆ†æ¯”

::: {.callout-tip appearance="simple"}
![å›¾ 9-26. æŒ‰å¤©/æ—¶é—´/å¸çƒŸè€…åˆ’åˆ†çš„å°è´¹ç™¾åˆ†æ¯”](fig9-26.png)
:::

## æ‰©å±•åˆ†é¢ç½‘æ ¼ â•

-   æ¯ä¸ªæ—¶é—´å€¼æ·»åŠ ä¸€è¡Œï¼š

```{python}
sns.catplot(x="day", y="tip_pct", row="time",
            col="smoker", kind="bar", data=tips[tips.tip_pct < 1])
# ä½¿ç”¨seabornçš„catplotåˆ›å»ºåˆ†é¢æ¡å½¢å›¾ã€‚
# row="time": æ ¹æ®"time"åˆ—çš„å€¼å°†å›¾è¡¨åˆ†æˆä¸åŒçš„è¡Œã€‚
```

## æŒ‰æ—¶é—´/å¸çƒŸè€…æ‹†åˆ†çš„æ¯å¤©å°è´¹ç™¾åˆ†æ¯”

::: {.callout-tip appearance="simple"}
![å›¾ 9-27. æŒ‰æ—¶é—´/å¸çƒŸè€…æ‹†åˆ†çš„æ¯å¤©å°è´¹ç™¾åˆ†æ¯”](fig9-27.png)
:::

## `catplot` çš„å…¶ä»–å›¾è¡¨ç±»å‹ ğŸ“Š

-   `catplot` æ”¯æŒå…¶ä»–å›¾è¡¨ç±»å‹ï¼ˆä¾‹å¦‚ï¼Œç®±çº¿å›¾ï¼‰ã€‚
-   ç®±çº¿å›¾æ˜¾ç¤ºä¸­ä½æ•°ã€å››åˆ†ä½æ•°å’Œå¼‚å¸¸å€¼ã€‚

```{python}
sns.catplot(x="tip_pct", y="day", kind="box",
            data=tips[tips.tip_pct < 0.5])
# ä½¿ç”¨seabornçš„catplotåˆ›å»ºç®±çº¿å›¾ã€‚
# kind="box": å›¾è¡¨ç±»å‹ä¸ºç®±çº¿å›¾ã€‚
```

## æ¯å¤©å°è´¹ç™¾åˆ†æ¯”çš„ç®±çº¿å›¾

::: {.callout-tip appearance="simple"}
![å›¾ 9-28. æ¯å¤©å°è´¹ç™¾åˆ†æ¯”çš„ç®±çº¿å›¾](fig9-28.png)
:::

## `seaborn.FacetGrid` ğŸ§©

-   åˆ›å»ºè‡ªå®šä¹‰åˆ†é¢ç½‘æ ¼å›¾ã€‚
-   æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… seaborn æ–‡æ¡£ã€‚

## å…¶ä»– Python å¯è§†åŒ–å·¥å…· ğŸ› ï¸

-   åœ¨ Python ä¸­åˆ›å»ºå›¾å½¢çš„è®¸å¤šé€‰é¡¹ã€‚

```markdown
-   ä¸“æ³¨äº Web äº¤äº’å¼å›¾å½¢ï¼šAltairã€Bokehã€Plotlyã€‚
-   å¯¹äºé™æ€å›¾å½¢ï¼šä½¿ç”¨ matplotlib å’ŒåŸºäºå®ƒæ„å»ºçš„åº“ï¼ˆpandasã€seabornï¼‰ã€‚

## æ¨èé˜…è¯» ğŸ“š

-   *Fundamentals of Data Visualization* by Claus O. Wilke.
    -   å¯åœ¨çº¿é˜…è¯»æˆ–è´­ä¹°ï¼š[https://clauswilke.com/dataviz](https://clauswilke.com/dataviz)

## ç»“è®º

-   æœ¬ç« ä»‹ç»äº†ä½¿ç”¨ pandasã€matplotlib å’Œ seaborn è¿›è¡ŒåŸºæœ¬æ•°æ®å¯è§†åŒ–çš„æ–¹æ³•ã€‚
-   æœ‰æ•ˆçš„æ•°æ®å¯è§†åŒ–æ˜¯ä¸€ä¸ªæ´»è·ƒçš„ç ”ç©¶é¢†åŸŸã€‚
-   æ¢ç´¢æ›´å¤šèµ„æºä»¥äº†è§£æ›´å¤šä¿¡æ¯ã€‚

## æ€»ç»“

-   matplotlib æ˜¯ä¸€ä¸ªå¼ºå¤§è€Œçµæ´»çš„åº“ï¼Œç”¨äºåœ¨ Python ä¸­åˆ›å»ºé™æ€å›¾è¡¨ã€‚
-   pandas æä¾›äº†æ–¹ä¾¿çš„æ–¹æ³•æ¥ç»˜åˆ¶ `Series` å’Œ `DataFrame` å¯¹è±¡ã€‚
-   seaborn ç®€åŒ–äº†åˆ›å»ºè®¸å¤šå¸¸è§ç»Ÿè®¡å¯è§†åŒ–çš„è¿‡ç¨‹ï¼Œå¹¶ä¸ pandas è‰¯å¥½é›†æˆã€‚
-   æœ‰æ•ˆçš„æ•°æ®å¯è§†åŒ–å¯¹äºæ•°æ®åˆ†æå’Œæ²Ÿé€šè‡³å…³é‡è¦ã€‚

## æ€è€ƒä¸è®¨è®º ğŸ¤”

-   æ‚¨å¦‚ä½•å°†æœ¬ç« å­¦åˆ°çš„å¯è§†åŒ–æŠ€æœ¯åº”ç”¨åˆ°æ‚¨è‡ªå·±çš„æ•°æ®åˆ†æé¡¹ç›®ä¸­ï¼Ÿ
-   å¯¹äºä¸åŒçš„å¯è§†åŒ–ä»»åŠ¡ï¼Œä½¿ç”¨ matplotlibã€pandas å’Œ seaborn çš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ
-   æ‚¨å¦‚ä½•é€šè¿‡å¯è§†åŒ–æœ‰æ•ˆåœ°ä¼ è¾¾æ‚¨çš„å‘ç°ï¼Ÿ

## æ€è€ƒä¸è®¨è®ºï¼ˆç»­ï¼‰ğŸ¤”

- æ‚¨è¿˜æ¢ç´¢è¿‡å“ªäº›å…¶ä»– Python å¯è§†åŒ–å·¥å…·ï¼Œå®ƒä»¬ä¸ matplotlibã€pandas å’Œ seaborn ç›¸æ¯”å¦‚ä½•ï¼Ÿ
- åˆ›å»ºæ¸…æ™°ã€ä¿¡æ¯ä¸°å¯Œä¸”å…·æœ‰è§†è§‰å¸å¼•åŠ›çš„å›¾è¡¨æœ‰å“ªäº›æœ€ä½³å®è·µï¼Ÿ

## æ€è€ƒä¸è®¨è®ºï¼ˆç»­ï¼‰ğŸ¤”

- æ‚¨èƒ½æƒ³åˆ°åœ¨å“ªäº›æƒ…å†µä¸‹ï¼Œç‰¹å®šç±»å‹çš„å›¾è¡¨ï¼ˆä¾‹å¦‚ï¼Œç›´æ–¹å›¾ã€æ•£ç‚¹å›¾ã€ç®±çº¿å›¾ï¼‰æœ€é€‚åˆä¼ è¾¾æ•°æ®ä¸­çš„ç‰¹å®šè§è§£å—ï¼Ÿ
- æ‚¨å¦‚ä½•è‡ªå®šä¹‰ matplotlib å›¾è¡¨ä»¥å¢å¼ºå…¶æ¸…æ™°åº¦å’Œè§†è§‰æ•ˆæœï¼ˆä¾‹å¦‚ï¼Œè°ƒæ•´é¢œè‰²ã€æ ‡ç­¾ã€å›¾ä¾‹ï¼‰ï¼Ÿ


