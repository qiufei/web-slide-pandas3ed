---
title: "pandaså…¥é—¨"
---

## pandasç®€ä»‹ ğŸ¼

-   pandas æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ Python åº“ï¼Œç”¨äºæ•°æ®åˆ†æå’Œå¤„ç†ã€‚
-   å®ƒç±»ä¼¼äºç”µå­è¡¨æ ¼ç¨‹åºï¼Œä½†åŠŸèƒ½æ›´å¼ºå¤§ã€æ›´çµæ´»ã€‚
-   å®ƒå»ºç«‹åœ¨ NumPy ä¹‹ä¸Šï¼ŒNumPy æ˜¯ Python ä¸­å¦ä¸€ä¸ªé‡è¦çš„æ•°å€¼è®¡ç®—åº“ã€‚

## pandas æ ‡å¿—

![](https://pandas.pydata.org/static/img/pandas.svg)

::: {.callout-note}
å¯ä»¥æŠŠ pandas çœ‹ä½œæ˜¯æ‰“äº†å…´å¥‹å‰‚çš„ Excelï¼ğŸ’ª
:::

## ä¸ºä»€ä¹ˆé€‰æ‹© pandasï¼ŸğŸ¤”

-   **æ•°æ®ç»“æ„ï¼š** æä¾›ç›´è§‚çš„æ•°æ®ç»“æ„ï¼Œå¦‚ Seriesï¼ˆä¸€ç»´ï¼‰å’Œ DataFrameï¼ˆäºŒç»´ï¼‰ï¼Œä»¥é«˜æ•ˆå¤„ç†æ•°æ®ã€‚

## ä¸ºä»€ä¹ˆé€‰æ‹© pandasï¼ŸğŸ¤” (ç»­)

-   **æ•°æ®æ¸…æ´—ï¼š** æä¾›å¤„ç†ç¼ºå¤±æ•°æ®ã€è¿‡æ»¤å’Œè½¬æ¢æ•°æ®çš„å·¥å…·ã€‚

## ä¸ºä»€ä¹ˆé€‰æ‹© pandasï¼ŸğŸ¤” (ç»­)

-   **æ•°æ®åˆ†æï¼š** å¼ºå¤§çš„åˆ†ç»„ã€èšåˆå’Œç»Ÿè®¡åˆ†æåŠŸèƒ½ã€‚

## ä¸ºä»€ä¹ˆé€‰æ‹© pandasï¼ŸğŸ¤” (ç»­)

-   **é›†æˆï¼š** ä¸ NumPyã€SciPyã€scikit-learn å’Œ matplotlib ç­‰å…¶ä»– Python åº“æ— ç¼åä½œã€‚

## æ ¸å¿ƒæ¦‚å¿µï¼šæ•°æ®åˆ†æ ğŸ”

æ•°æ®åˆ†ææ˜¯å¯¹æ•°æ®è¿›è¡Œæ£€æŸ¥ã€æ¸…ç†ã€è½¬æ¢å’Œå»ºæ¨¡çš„è¿‡ç¨‹ï¼Œç›®çš„æ˜¯å‘ç°æœ‰ç”¨ä¿¡æ¯ã€å¾—å‡ºç»“è®ºå¹¶æ”¯æŒå†³ç­–ã€‚å®ƒæ¶‰åŠå‡ ä¸ªå…³é”®æ­¥éª¤ï¼š

## æ ¸å¿ƒæ¦‚å¿µï¼šæ•°æ®åˆ†æ ğŸ” (ç»­)

1.  **æ•°æ®æ”¶é›†ï¼š** ä»å„ç§æ¥æºæ”¶é›†æ•°æ®ã€‚
2.  **æ•°æ®æ¸…ç†ï¼š** å¤„ç†ç¼ºå¤±å€¼ã€çº æ­£é”™è¯¯å¹¶ç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚
3.  **æ•°æ®è½¬æ¢ï¼š** å°†æ•°æ®è½¬æ¢ä¸ºé€‚åˆåˆ†æçš„æ ¼å¼ï¼ˆä¾‹å¦‚ï¼Œç¼©æ”¾ã€è§„èŒƒåŒ–ï¼‰ã€‚

## æ ¸å¿ƒæ¦‚å¿µï¼šæ•°æ®åˆ†æ ğŸ” (ç»­)

4.  **æ•°æ®æ¢ç´¢ï¼š** ä½¿ç”¨æè¿°æ€§ç»Ÿè®¡å’Œå¯è§†åŒ–æ¥äº†è§£æ•°æ®çš„æ¨¡å¼å’Œç‰¹å¾ã€‚
5.  **æ•°æ®å»ºæ¨¡ï¼š** åº”ç”¨ç»Ÿè®¡æˆ–æœºå™¨å­¦ä¹ æŠ€æœ¯æ¥æå–è§è§£æˆ–è¿›è¡Œé¢„æµ‹ã€‚
6.  **è§£é‡Šå’ŒæŠ¥å‘Šï¼š** ä»¥æ¸…æ™°ç®€æ´çš„æ–¹å¼ä¼ è¾¾ç»“æœã€‚

## æ ¸å¿ƒæ¦‚å¿µï¼šæœºå™¨å­¦ä¹  ğŸ¤–

æœºå™¨å­¦ä¹ æ˜¯äººå·¥æ™ºèƒ½ (AI) çš„ä¸€ä¸ªå­é¢†åŸŸï¼Œä¸“æ³¨äºä½¿è®¡ç®—æœºèƒ½å¤Ÿä»æ•°æ®ä¸­å­¦ä¹ ï¼Œè€Œæ— éœ€æ˜¾å¼ç¼–ç¨‹ã€‚å…³é”®æ¦‚å¿µåŒ…æ‹¬ï¼š

## æ ¸å¿ƒæ¦‚å¿µï¼šæœºå™¨å­¦ä¹  ğŸ¤– (ç»­)

- **è®­ç»ƒæ•°æ®ï¼š** ç”¨äºè®­ç»ƒæœºå™¨å­¦ä¹ æ¨¡å‹çš„æ•°æ®é›†ã€‚
- **ç‰¹å¾ï¼š** æ•°æ®çš„å„ä¸ªå¯æµ‹é‡å±æ€§æˆ–ç‰¹å¾ï¼ˆä¾‹å¦‚ï¼Œè¡¨ä¸­çš„åˆ—ï¼‰ã€‚
- **æ¨¡å‹ï¼š** ä»è®­ç»ƒæ•°æ®ä¸­å­¦ä¹ æ¨¡å¼çš„æ•°å­¦è¡¨ç¤ºã€‚

## æ ¸å¿ƒæ¦‚å¿µï¼šæœºå™¨å­¦ä¹  ğŸ¤– (ç»­)

- **é¢„æµ‹ï¼š** ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹å¯¹æ–°çš„ã€æœªè§è¿‡çš„æ•°æ®è¿›è¡Œé¢„æµ‹ã€‚
- **ç›‘ç£å­¦ä¹ ï¼š** ä»æ ‡è®°æ•°æ®ï¼ˆå·²çŸ¥æ­£ç¡®è¾“å‡ºï¼‰ä¸­å­¦ä¹ ã€‚ç¤ºä¾‹ï¼šåˆ†ç±»ã€å›å½’ã€‚
- **æ— ç›‘ç£å­¦ä¹ ï¼š** ä»æœªæ ‡è®°æ•°æ®ï¼ˆæœªçŸ¥æ­£ç¡®è¾“å‡ºï¼‰ä¸­å­¦ä¹ ã€‚ç¤ºä¾‹ï¼šèšç±»ã€é™ç»´ã€‚

## æ ¸å¿ƒæ¦‚å¿µï¼šPython ğŸ

Python æ˜¯ä¸€ç§é€šç”¨çš„é«˜çº§ç¼–ç¨‹è¯­è¨€ï¼Œä»¥å…¶å¯è¯»æ€§å’Œå¹¿æ³›çš„åº“è€Œé—»åã€‚æ•°æ®åˆ†æçš„å…³é”®ç‰¹æ€§ï¼š

-   **æ˜“äºå­¦ä¹ ï¼š** æ¸…æ™°çš„è¯­æ³•ä½¿å…¶å¯¹åˆå­¦è€…å‹å¥½ã€‚

## æ ¸å¿ƒæ¦‚å¿µï¼šPython ğŸ (ç»­)

-   **åºå¤§çš„ç¤¾åŒºï¼š** å¹¿æ³›çš„åœ¨çº¿èµ„æºå’Œæ”¯æŒã€‚
-   **ä¸°å¯Œçš„åº“ç”Ÿæ€ç³»ç»Ÿï¼š** NumPyï¼ˆæ•°å€¼è®¡ç®—ï¼‰ã€pandasï¼ˆæ•°æ®å¤„ç†ï¼‰ã€scikit-learnï¼ˆæœºå™¨å­¦ä¹ ï¼‰ã€matplotlib/seabornï¼ˆå¯è§†åŒ–ï¼‰ã€‚

## æ ¸å¿ƒæ¦‚å¿µï¼šPython ğŸ (ç»­)

-   **è§£é‡Šå‹è¯­è¨€ï¼š** ä»£ç é€è¡Œæ‰§è¡Œï¼Œä¾¿äºæµ‹è¯•å’Œè°ƒè¯•ã€‚
-   **åŠ¨æ€ç±»å‹ï¼š** æ— éœ€æ˜¾å¼å£°æ˜å˜é‡ç±»å‹ã€‚

## å¯¼å…¥ pandas

```{python}
import pandas as pd  # å¯¼å…¥ pandasï¼Œå¹¶å°†å…¶åˆ«åä¸º 'pd'
import numpy as np   # å¯¼å…¥ NumPyï¼Œå¹¶å°†å…¶åˆ«åä¸º 'np'
```

-   æˆ‘ä»¬ä½¿ç”¨åˆ«å `pd` å¯¼å…¥ pandasï¼ˆæ ‡å‡†æƒ¯ä¾‹ï¼‰ã€‚
-   æˆ‘ä»¬ä¹Ÿå¯¼å…¥ NumPyï¼Œåˆ«åä¸º `np`ã€‚ pandas æ„å»ºåœ¨ NumPy ä¹‹ä¸Šã€‚

## pandas æ•°æ®ç»“æ„ï¼šSeries

-   Series æ˜¯ä¸€ä¸ªä¸€ç»´å¸¦æ ‡ç­¾çš„æ•°ç»„ã€‚å®ƒç±»ä¼¼äºç”µå­è¡¨æ ¼ä¸­çš„ä¸€åˆ—ã€‚
-   å®ƒå¯ä»¥ä¿å­˜ä»»ä½•ç±»å‹çš„æ•°æ®ï¼ˆæ•´æ•°ã€æµ®ç‚¹æ•°ã€å­—ç¬¦ä¸²ç­‰ï¼‰ã€‚
-   å®ƒæœ‰ä¸€ä¸ª *ç´¢å¼•*ï¼Œç”¨äºæ ‡è®°æ¯ä¸ªå…ƒç´ ã€‚

```{python}
obj = pd.Series([4, 7, -5, 3]) # ä»åˆ—è¡¨åˆ›å»ºä¸€ä¸ª Series
obj
```

## Seriesï¼šç´¢å¼•å’Œå€¼

```{python}
print(obj.array)  # è®¿é—®åº•å±‚æ•°æ® (PandasArray)
print(obj.index)  # è®¿é—®ç´¢å¼•ï¼ˆé»˜è®¤ä¸ºï¼š0, 1, 2, ...ï¼‰
```

::: {.callout-note}
`obj.array` è¿”å›æ•°æ®ã€‚ `obj.index` è¿”å›ç´¢å¼•ã€‚
:::

## å¸¦æœ‰è‡ªå®šä¹‰ç´¢å¼•çš„ Series

```{python}
obj2 = pd.Series([4, 7, -5, 3], index=['d', 'b', 'a', 'c']) # åˆ›å»ºä¸€ä¸ªå¸¦æœ‰è‡ªå®šä¹‰ç´¢å¼•çš„ Series
obj2
```

## Seriesï¼šè‡ªå®šä¹‰ç´¢å¼• (ç»­)

```{python}
obj2.index # è®¿é—®è‡ªå®šä¹‰ç´¢å¼•
```

::: {.callout-note}
ç°åœ¨ç´¢å¼•æ˜¯ ['d', 'b', 'a', 'c']ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›ç´¢å¼•æ¥è®¿é—®æ•°æ®ã€‚
:::

## è®¿é—® Series å…ƒç´ 

```{python}
obj2['a']  # é€šè¿‡ç´¢å¼•æ ‡ç­¾ 'a' è®¿é—®å…ƒç´ 
```

## è®¿é—® Series å…ƒç´  (ç»­)

```{python}
obj2['d'] = 6  # ä¿®æ”¹ç´¢å¼•æ ‡ç­¾ 'd' å¤„çš„å…ƒç´ 
```

## è®¿é—® Series å…ƒç´  (ç»­)

```{python}
obj2[['c', 'a', 'd']]  # ä½¿ç”¨æ ‡ç­¾åˆ—è¡¨è®¿é—®å¤šä¸ªå…ƒç´ 
```

::: {.callout-note}
æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç´¢å¼•æ ‡ç­¾åˆ—è¡¨æ¥é€‰æ‹©å­é›†ã€‚
:::

## è¿‡æ»¤ Series

```{python}
obj2[obj2 > 0]  # é€‰æ‹©å¤§äº 0 çš„å…ƒç´ ï¼ˆå¸ƒå°”ç´¢å¼•ï¼‰
```

## è¿‡æ»¤ Series (ç»­)

```{python}
obj2 * 2 # å°†æ¯ä¸ªå…ƒç´ ä¹˜ä»¥ 2
```

## è¿‡æ»¤ Series (ç»­)

```{python}
np.exp(obj2) # é€å…ƒç´ åº”ç”¨æŒ‡æ•°å‡½æ•°ï¼ˆæ¥è‡ª NumPyï¼‰
```

::: {.callout-note}
åœ¨è¿™äº›æ“ä½œæœŸé—´ï¼Œç´¢å¼•-å€¼çš„é“¾æ¥å…³ç³»ä¼šä¿ç•™ã€‚
:::

## Series ä½œä¸ºå›ºå®šé•¿åº¦çš„æœ‰åºå­—å…¸

```{python}
'b' in obj2  # æ£€æŸ¥ 'b' æ˜¯å¦åœ¨ç´¢å¼•ä¸­ï¼ˆç±»ä¼¼äºæ£€æŸ¥å­—å…¸ä¸­çš„é”®ï¼‰
```

## Series ä½œä¸ºå›ºå®šé•¿åº¦çš„æœ‰åºå­—å…¸ (ç»­)

```{python}
'e' in obj2  # æ£€æŸ¥ 'e' æ˜¯å¦åœ¨ç´¢å¼•ä¸­
```

::: {.callout-note}
Series ç±»ä¼¼äºå­—å…¸ï¼šé”®æ˜¯ç´¢å¼•æ ‡ç­¾ï¼Œå€¼æ˜¯æ•°æ®ã€‚
:::

## ä»å­—å…¸åˆ›å»º Series

```{python}
sdata = {'Ohio': 35000, 'Texas': 71000, 'Oregon': 16000, 'Utah': 5000}
obj3 = pd.Series(sdata) # ä»å­—å…¸åˆ›å»ºä¸€ä¸ª Series
obj3
```

## ä»å­—å…¸åˆ›å»º Series (ç»­)

```{python}
obj3.to_dict() #è½¬æ¢å›å­—å…¸
```

## Seriesï¼šå¤„ç†ç¼ºå¤±æ•°æ®

```{python}
states = ['California', 'Ohio', 'Oregon', 'Texas']
obj4 = pd.Series(sdata, index=states)  # ä½¿ç”¨æŒ‡å®šçš„ç´¢å¼•åˆ›å»ºä¸€ä¸ª Series
obj4
```

::: {.callout-note}
'California' æ˜¯ NaNï¼ˆNot a Numberï¼‰- å®ƒåœ¨ç´¢å¼•ä¸­ï¼Œä½†ä¸åœ¨ `sdata` ä¸­ã€‚'Utah' è¢«æ’é™¤ - å®ƒåœ¨ `sdata` ä¸­ï¼Œä½†ä¸åœ¨ç´¢å¼•ä¸­ã€‚
:::

## æ£€æµ‹ç¼ºå¤±æ•°æ®

```{python}
pd.isna(obj4)  # æ£€æŸ¥ç¼ºå¤±å€¼ (NaN) - è¿”å›ä¸€ä¸ªå¸ƒå°” Series
```

## æ£€æµ‹ç¼ºå¤±æ•°æ® (ç»­)

```{python}
pd.notna(obj4) # æ£€æŸ¥éç¼ºå¤±å€¼ - è¿”å›ä¸€ä¸ªå¸ƒå°” Series
```

::: {.callout-note}
`isna()` å’Œ `notna()` æ£€æµ‹ç¼ºå¤±å€¼ã€‚
:::

## Seriesï¼šè‡ªåŠ¨å¯¹é½

```{python}
obj3
```

## Seriesï¼šè‡ªåŠ¨å¯¹é½ (ç»­)

```{python}
obj4
```

## Seriesï¼šè‡ªåŠ¨å¯¹é½ (ç»­)

```{python}
obj3 + obj4  # å°†ä¸¤ä¸ª Series ç›¸åŠ ï¼›å€¼æŒ‰ç´¢å¼•æ ‡ç­¾å¯¹é½
```

::: {.callout-note}
æ•°æ®å¯¹é½æ˜¯è‡ªåŠ¨çš„ã€‚åœ¨æ ‡ç­¾ä¸åŒ¹é…çš„åœ°æ–¹å¼•å…¥ NaNã€‚
:::

## Seriesï¼š`name` å±æ€§

```{python}
obj4.name = 'population'  # è®¾ç½® Series çš„åç§°
obj4.index.name = 'state'  # è®¾ç½®ç´¢å¼•çš„åç§°
obj4
```

::: {.callout-note}
Series åŠå…¶ç´¢å¼•å¯ä»¥æœ‰åç§°ã€‚
:::

## å°±åœ°æ›´æ”¹ Series ç´¢å¼•

```{python}
obj
```

## å°±åœ°æ›´æ”¹ Series ç´¢å¼• (ç»­)

```{python}
obj.index = ['Bob', 'Steve', 'Jeff', 'Ryan']  # å°±åœ°ä¿®æ”¹ç´¢å¼•
obj
```

::: {.callout-note}
å¯ä»¥é€šè¿‡èµ‹å€¼æ›´æ”¹ç´¢å¼•ã€‚
:::

## pandas æ•°æ®ç»“æ„ï¼šDataFrame

-   DataFrame æ˜¯ä¸€ä¸ªäºŒç»´å¸¦æ ‡ç­¾çš„æ•°æ®ç»“æ„ã€‚ç±»ä¼¼äºç”µå­è¡¨æ ¼ã€‚
-   æœ‰è¡Œå’Œåˆ—ã€‚
-   æ¯åˆ—å¯ä»¥æœ‰ä¸åŒçš„ç±»å‹ã€‚
-   æœ‰è¡Œç´¢å¼•å’Œåˆ—ç´¢å¼•ã€‚

## åˆ›å»º DataFrame

```{python}
data = {'state': ['Ohio', 'Ohio', 'Ohio', 'Nevada', 'Nevada', 'Nevada'],
        'year': [2000, 2001, 2002, 2001, 2002, 2003],
        'pop': [1.5, 1.7, 3.6, 2.4, 2.9, 3.2]}
frame = pd.DataFrame(data) # ä»å­—å…¸ï¼ˆå€¼ä¸ºåˆ—è¡¨ï¼‰åˆ›å»ºä¸€ä¸ª DataFrame
frame
```

::: {.callout-note}
åˆ›å»º DataFrame çš„å¸¸ç”¨æ–¹æ³•ï¼šå­—å…¸ï¼Œå…¶å€¼ä¸ºåˆ—è¡¨ã€‚
:::

## DataFrameï¼š`head()` å’Œ `tail()`

```{python}
frame.head()  # æ˜¾ç¤ºå‰ 5 è¡Œ
```

## DataFrameï¼š`head()` å’Œ `tail()` (ç»­)

```{python}
frame.tail() # æ˜¾ç¤ºæœ€å 5 è¡Œ
```

## DataFrameï¼šæŒ‡å®šåˆ—é¡ºåº

```{python}
pd.DataFrame(data, columns=['year', 'state', 'pop']) # æŒ‡å®šåˆ—é¡ºåº
```

::: {.callout-note}
å¯ä»¥æŒ‡å®šåˆ—çš„é¡ºåºã€‚
:::

## DataFrameï¼šç¼ºå¤±æ•°æ®

```{python}
frame2 = pd.DataFrame(data, columns=['year', 'state', 'pop', 'debt']) # 'debt' æ˜¯ä¸€ä¸ªæ–°åˆ—
frame2
```

## DataFrameï¼šç¼ºå¤±æ•°æ® (ç»­)

```{python}
frame2.columns  # æ˜¾ç¤ºåˆ—å
```

::: {.callout-note}
'debt' åˆ—æœ‰ç¼ºå¤±å€¼ (NaN)ï¼Œå› ä¸ºå®ƒä¸åœ¨åŸå§‹æ•°æ®ä¸­ã€‚
:::

## æ£€ç´¢åˆ—

```{python}
frame2['state']  # æ£€ç´¢ 'state' åˆ—ï¼ˆç±»ä¼¼å­—å…¸çš„è¡¨ç¤ºæ³•ï¼‰
```

## æ£€ç´¢åˆ— (ç»­)

```{python}
frame2.year  # æ£€ç´¢ 'year' åˆ—ï¼ˆç±»ä¼¼å±æ€§çš„è®¿é—®ï¼‰
```

::: {.callout-note}
ä¸¤ç§æ–¹æ³•éƒ½è¿”å›ä¸€ä¸ª Seriesã€‚å±æ€§è®¿é—®ä»…é€‚ç”¨äºæœ‰æ•ˆçš„ Python å˜é‡åï¼ˆæ— ç©ºæ ¼ç­‰ï¼‰ã€‚
:::

## æ£€ç´¢è¡Œ

```{python}
frame2.loc[1]  # æŒ‰æ ‡ç­¾è®¿é—®è¡Œï¼ˆç´¢å¼• '1'ï¼‰
```

## æ£€ç´¢è¡Œ (ç»­)

```{python}
frame2.iloc[2]  # æŒ‰æ•´æ•°ä½ç½®è®¿é—®è¡Œï¼ˆç´¢å¼• 2ï¼‰
```

::: {.callout-note}
`loc` åŸºäºæ ‡ç­¾ã€‚`iloc` åŸºäºæ•´æ•°ä½ç½®ã€‚è¿™æ˜¯è‡³å…³é‡è¦çš„åŒºåˆ«ã€‚
:::

## ä¿®æ”¹åˆ—

```{python}
frame2['debt'] = 16.5  # å°†æ ‡é‡å€¼èµ‹ç»™ 'debt' åˆ—
frame2
```

## ä¿®æ”¹åˆ— (ç»­)

```{python}
frame2['debt'] = np.arange(6.)  # å°† NumPy æ•°ç»„èµ‹ç»™ 'debt' åˆ—
frame2
```

## èµ‹å€¼ Series

```{python}
val = pd.Series([-1.2, -1.5, -1.7], index=[2, 4, 5])  # åˆ›å»ºå¸¦æœ‰è‡ªå®šä¹‰ç´¢å¼•çš„ Series
frame2['debt'] = val  # å°† Series èµ‹ç»™ 'debt' åˆ—
frame2
```

::: {.callout-note}
æ ‡ç­¾å·²å¯¹é½ï¼`val` ä¸­çš„å€¼è¢«åˆ†é…ç»™ `frame2` ä¸­ç›¸åº”çš„ç´¢å¼•ã€‚åœ¨ç´¢å¼•ä¸åŒ¹é…çš„åœ°æ–¹å¡«å……ç¼ºå¤±å€¼ (NaN)ã€‚
:::

## åˆ›å»ºæ–°åˆ—

```{python}
frame2['eastern'] = frame2['state'] == 'Ohio'  # åˆ›å»ºä¸€ä¸ªæ–°åˆ— 'eastern'
frame2
```

::: {.callout-note}
èµ‹å€¼ç»™*ä¸å­˜åœ¨*çš„åˆ—ä¼šåˆ›å»ºä¸€ä¸ªæ–°åˆ—ã€‚
:::

## åˆ é™¤åˆ—

```{python}
del frame2['eastern']  # åˆ é™¤ 'eastern' åˆ—
frame2.columns
```

::: {.callout-note}
`del` å…³é”®å­—åˆ é™¤åˆ—ã€‚
:::

## ä»åµŒå¥—å­—å…¸åˆ›å»º DataFrame

```{python}
populations = {'Ohio': {2000: 1.5, 2001: 1.7, 2002: 3.6},
               'Nevada': {2001: 2.4, 2002: 2.9}}
frame3 = pd.DataFrame(populations) # ä»åµŒå¥—å­—å…¸åˆ›å»º DataFrame
frame3
```

::: {.callout-note}
å¤–å±‚é”®æˆä¸ºåˆ—ï¼Œå†…å±‚é”®æˆä¸ºè¡Œç´¢å¼•ã€‚
:::

## è½¬ç½® DataFrame

```{python}
frame3.T  # è½¬ç½® DataFrameï¼ˆäº¤æ¢è¡Œå’Œåˆ—ï¼‰
```

::: {.callout-note}
äº¤æ¢è¡Œå’Œåˆ—ã€‚
:::

## DataFrameï¼š`index.name` å’Œ `columns.name`

```{python}
frame3.index.name = 'year'    # è®¾ç½®è¡Œç´¢å¼•çš„åç§°
frame3.columns.name = 'state' # è®¾ç½®åˆ—ç´¢å¼•çš„åç§°
frame3
```

## DataFrameï¼š`to_numpy()`

```{python}
frame3.to_numpy()  # å°† DataFrame è½¬æ¢ä¸º NumPy æ•°ç»„
```

::: {.callout-note}
å°†æ•°æ®ä½œä¸ºäºŒç»´ NumPy æ•°ç»„è¿”å›ã€‚å¦‚æœå­˜åœ¨æ··åˆç±»å‹ï¼Œ`dtype` å°†é€‚åº”æ‰€æœ‰åˆ—ï¼Œé€šå¸¸ä¸º `object`ã€‚
:::

## ç´¢å¼•å¯¹è±¡

```{python}
obj = pd.Series(np.arange(3), index=['a', 'b', 'c'])
index = obj.index  # è·å– Index å¯¹è±¡
index
```

## ç´¢å¼•å¯¹è±¡ (ç»­)

```{python}
index[1:]  # å¯¹ Index å¯¹è±¡è¿›è¡Œåˆ‡ç‰‡ï¼ˆç±»ä¼¼äºåˆ—è¡¨ï¼‰
```

::: {.callout-note}
ç´¢å¼•å¯¹è±¡å­˜å‚¨è½´æ ‡ç­¾å’Œå…ƒæ•°æ®ã€‚å®ƒä»¬æ˜¯ä¸å¯å˜çš„ã€‚
:::

## ç´¢å¼•çš„ä¸å¯å˜æ€§

```{python}
#| eval: false

index[1] = 'd'  # TypeError: Index does not support mutable operations
```

::: {.callout-note}
ç´¢å¼•å¯¹è±¡åœ¨åˆ›å»ºå*ä¸èƒ½*æ›´æ”¹ã€‚
:::

## ç´¢å¼•ä½œä¸ºå›ºå®šå¤§å°çš„é›†åˆ

```{python}
frame3
```

## ç´¢å¼•ä½œä¸ºå›ºå®šå¤§å°çš„é›†åˆ (ç»­)

```{python}
'Ohio' in frame3.columns  # æ£€æŸ¥åˆ—æˆå‘˜èµ„æ ¼
```

## ç´¢å¼•ä½œä¸ºå›ºå®šå¤§å°çš„é›†åˆ (ç»­)

```{python}
2003 in frame3.index  # æ£€æŸ¥è¡Œç´¢å¼•æˆå‘˜èµ„æ ¼
```

## é‡æ–°ç´¢å¼•

-   `reindex` åˆ›å»ºä¸€ä¸ª*æ–°*å¯¹è±¡ï¼›æ•°æ®ä¼šæ ¹æ®æ–°ç´¢å¼•è¿›è¡Œè°ƒæ•´ã€‚

```{python}
obj = pd.Series([4.5, 7.2, -5.3, 3.6], index=['d', 'b', 'a', 'c'])
obj
```

## é‡æ–°ç´¢å¼• (ç»­)

```{python}
obj2 = obj.reindex(['a', 'b', 'c', 'd', 'e'])  # é‡æ–°ç´¢å¼• Series
obj2
```

::: {.callout-note}
`reindex` *åˆ›å»ºæ–°çš„ Series*ã€‚ä¸ºç¼ºå¤±çš„ç´¢å¼•å¼•å…¥ NaNã€‚
:::

## é‡æ–°ç´¢å¼•ï¼šæ’å€¼çš„ `method`

```{python}
obj3 = pd.Series(['blue', 'purple', 'yellow'], index=[0, 2, 4])
obj3
```

## é‡æ–°ç´¢å¼•ï¼šæ’å€¼çš„ `method` (ç»­)

```{python}
obj3.reindex(np.arange(6), method='ffill')  # å‰å‘å¡«å……ç¼ºå¤±å€¼
```

::: {.callout-note}
`ffill`ï¼ˆå‰å‘å¡«å……ï¼‰å°†æœ€åä¸€ä¸ªæœ‰æ•ˆå€¼å‘å‰ä¼ æ’­ã€‚
:::

## ä½¿ç”¨ DataFrame é‡æ–°ç´¢å¼•

```{python}
frame = pd.DataFrame(np.arange(9).reshape((3, 3)),
                     index=['a', 'c', 'd'],
                     columns=['Ohio', 'Texas', 'California'])
frame
```

## ä½¿ç”¨ DataFrame é‡æ–°ç´¢å¼• (ç»­)

```{python}
frame2 = frame.reindex(index=['a', 'b', 'c', 'd']) # é‡æ–°ç´¢å¼•è¡Œ
frame2
```

::: {.callout-note}
DataFrame ä¸Šçš„ `reindex` å¯ä»¥æ›´æ”¹è¡Œç´¢å¼•ã€åˆ—æˆ–ä¸¤è€…ã€‚
:::

## é‡æ–°ç´¢å¼•åˆ—

```{python}
states = ['Texas', 'Utah', 'California']
frame.reindex(columns=states)  # é‡æ–°ç´¢å¼•åˆ—
```

## åˆ é™¤æ¡ç›®

```{python}
obj = pd.Series(np.arange(5.), index=['a', 'b', 'c', 'd', 'e'])
obj
```

## åˆ é™¤æ¡ç›® (ç»­)

```{python}
new_obj = obj.drop('c')  # åˆ é™¤æ¡ç›® 'c'ï¼ˆåˆ›å»ºä¸€ä¸ªæ–°çš„ Seriesï¼‰
new_obj
```

## åˆ é™¤æ¡ç›® (ç»­)

```{python}
obj.drop(['d', 'c'])  # åˆ é™¤å¤šä¸ªæ¡ç›®
```

## ä» DataFrame ä¸­åˆ é™¤

```{python}
data = pd.DataFrame(np.arange(16).reshape((4, 4)),
                    index=['Ohio', 'Colorado', 'Utah', 'New York'],
                    columns=['one', 'two', 'three', 'four'])
data
```

## ä» DataFrame ä¸­åˆ é™¤ (ç»­)

```{python}
data.drop(index=['Colorado', 'Ohio'])  # æŒ‰ç´¢å¼•æ ‡ç­¾åˆ é™¤è¡Œ
```

## ä» DataFrame ä¸­åˆ é™¤ (ç»­)

```{python}
data.drop(columns=['two']) # æŒ‰åˆ—ååˆ é™¤åˆ—
```

## ä» DataFrame ä¸­åˆ é™¤ (ç»­)

```{python}
data.drop('two', axis=1) # ä½¿ç”¨ axis=1 åˆ é™¤åˆ—ï¼ˆä¸ä¸Šè¿°ç›¸åŒï¼‰
```

## ç´¢å¼•ã€é€‰æ‹©å’Œè¿‡æ»¤

```{python}
obj = pd.Series(np.arange(4.), index=['a', 'b', 'c', 'd'])
obj
```

## ç´¢å¼•ã€é€‰æ‹©å’Œè¿‡æ»¤ (ç»­)

```{python}
obj['b']  # æŒ‰æ ‡ç­¾é€‰æ‹©
```

## ç´¢å¼•ã€é€‰æ‹©å’Œè¿‡æ»¤ (ç»­)

```{python}
obj[1]  # æŒ‰æ•´æ•°ä½ç½®é€‰æ‹©
```

## ç´¢å¼•ã€é€‰æ‹©å’Œè¿‡æ»¤ (ç»­)

```{python}
obj[2:4]  # åˆ‡ç‰‡
```

## ç´¢å¼•ã€é€‰æ‹©å’Œè¿‡æ»¤ (ç»­)

```{python}
obj[['b', 'a', 'd']]  # é€‰æ‹©å¤šä¸ªæ ‡ç­¾
```

## ç´¢å¼•ã€é€‰æ‹©å’Œè¿‡æ»¤ (ç»­)

```{python}
obj[[1, 3]]  # é€‰æ‹©å¤šä¸ªæ•´æ•°ä½ç½®
```

## ç´¢å¼•ã€é€‰æ‹©å’Œè¿‡æ»¤ (ç»­)

```{python}
obj[obj < 2]  # å¸ƒå°”ç´¢å¼•
```

## ä½¿ç”¨ `loc` å’Œ `iloc` è¿›è¡Œç´¢å¼•

-   `loc`ï¼šæŒ‰*æ ‡ç­¾*é€‰æ‹©ã€‚
-   `iloc`ï¼šæŒ‰*æ•´æ•°ä½ç½®*é€‰æ‹©ã€‚

```{python}
obj.loc[['b', 'a', 'd']] # ä½¿ç”¨ loc æŒ‰æ ‡ç­¾é€‰æ‹©
```
## ä½¿ç”¨ `loc` å’Œ `iloc` è¿›è¡Œç´¢å¼•(ç»­)
```{python}
obj1 = pd.Series([1, 2, 3], index=[2, 0, 1])
obj2 = pd.Series([1, 2, 3], index=['a', 'b', 'c'])
```

## ä½¿ç”¨ `loc` å’Œ `iloc` è¿›è¡Œç´¢å¼•(ç»­)

```{python}
obj1[[0,1,2]] #å¦‚æœSeriesçš„ç´¢å¼•æ˜¯æ•´æ•°,åˆ™é»˜è®¤æŒ‰æ ‡ç­¾é€‰æ‹©
```

## ä½¿ç”¨ `loc` å’Œ `iloc` è¿›è¡Œç´¢å¼•(ç»­)

```{python}
#| eval: false
obj2.loc[[0, 1]] # ç´¢å¼•æ˜¯å­—ç¬¦ä¸²ï¼Œ0å’Œ1ä¸æ˜¯obj2çš„æ ‡ç­¾æ—¶ï¼Œä¼šå‡ºé”™
```
## ä½¿ç”¨ `loc` å’Œ `iloc` è¿›è¡Œç´¢å¼• (ç»­)

```{python}
obj1.iloc[[0, 1, 2]] # iloc ä½¿ç”¨æ•´æ•°ä½ç½®
```

## ä½¿ç”¨ `loc` å’Œ `iloc` è¿›è¡Œç´¢å¼• (ç»­)

```{python}
obj2.iloc[[0, 1, 2]] # iloc ä½¿ç”¨æ•´æ•°ä½ç½®
```

::: {.callout-note}
ä½¿ç”¨ `loc` å’Œ `iloc` å¯ä»¥é¿å…æ­§ä¹‰ï¼Œå°¤å…¶æ˜¯åœ¨ä½¿ç”¨æ•´æ•°ç´¢å¼•æ—¶ã€‚
:::

## ä½¿ç”¨æ ‡ç­¾åˆ‡ç‰‡ï¼ˆåŒ…å«ï¼‰

```{python}
obj2.loc['b':'c']  # åŒ…æ‹¬ç«¯ç‚¹ ('c')ï¼
```

## ä½¿ç”¨æ ‡ç­¾åˆ‡ç‰‡ï¼ˆåŒ…å«ï¼‰(ç»­)

```{python}
obj2.loc['b':'c'] = 5  # ä½¿ç”¨åŸºäºæ ‡ç­¾çš„åˆ‡ç‰‡èµ‹å€¼
obj2
```

::: {.callout-note}
ä½¿ç”¨ `loc` è¿›è¡Œæ ‡ç­¾åˆ‡ç‰‡*åŒ…æ‹¬*ç«¯ç‚¹ã€‚
:::

## ç´¢å¼•åˆ° DataFrame ä¸­

```{python}
data = pd.DataFrame(np.arange(16).reshape((4, 4)),
                    index=['Ohio', 'Colorado', 'Utah', 'New York'],
                    columns=['one', 'two', 'three', 'four'])
data
```

## ç´¢å¼•åˆ° DataFrame ä¸­ (ç»­)

```{python}
data['two']  # é€‰æ‹©åˆ— 'two'
```

## ç´¢å¼•åˆ° DataFrame ä¸­ (ç»­)

```{python}
data[['three', 'one']]  # é€‰æ‹©å¤šåˆ—
```

## DataFrameï¼šç´¢å¼•çš„ç‰¹æ®Šæƒ…å†µ

```{python}
data[:2]  # åˆ‡ç‰‡è¡Œï¼ˆé€‰æ‹©ç¬¬ 0 è¡Œå’Œç¬¬ 1 è¡Œï¼‰
```

## DataFrameï¼šç´¢å¼•çš„ç‰¹æ®Šæƒ…å†µ (ç»­)

```{python}
data[data['three'] > 5]  # å¸ƒå°”ç´¢å¼•ï¼ˆé€‰æ‹© 'three' > 5 çš„è¡Œï¼‰
```

## DataFrameï¼šå¸ƒå°”ç´¢å¼•

```{python}
data < 5  # é€å…ƒç´ æ¯”è¾ƒï¼ˆè¿”å›ä¸€ä¸ªå¸ƒå°” DataFrameï¼‰
```

## DataFrameï¼šå¸ƒå°”ç´¢å¼• (ç»­)

```{python}
data[data < 5] = 0  # å°†å°äº 5 çš„å€¼è®¾ç½®ä¸º 0
data
```

## ä½¿ç”¨ `loc` å’Œ `iloc` åœ¨ DataFrame ä¸Šè¿›è¡Œé€‰æ‹©

```{python}
data.loc['Colorado'] # æŒ‰æ ‡ç­¾é€‰æ‹©ä¸€è¡Œ
```

## ä½¿ç”¨ `loc` å’Œ `iloc` åœ¨ DataFrame ä¸Šè¿›è¡Œé€‰æ‹© (ç»­)

```{python}
data.loc[['Colorado', 'New York']] # æŒ‰æ ‡ç­¾é€‰æ‹©å¤šè¡Œ
```

## ä½¿ç”¨ `loc` å’Œ `iloc` åœ¨ DataFrame ä¸Šè¿›è¡Œé€‰æ‹© (ç»­)

```{python}
data.loc['Colorado', ['two', 'three']]  # æŒ‰æ ‡ç­¾é€‰æ‹©è¡Œå’Œåˆ—
```

## ä½¿ç”¨ `loc` å’Œ `iloc` åœ¨ DataFrame ä¸Šè¿›è¡Œé€‰æ‹© (ç»­)

```{python}
data.iloc[2] # æŒ‰ä½ç½®é€‰æ‹©ä¸€è¡Œ
```

## ä½¿ç”¨ `loc` å’Œ `iloc` åœ¨ DataFrame ä¸Šè¿›è¡Œé€‰æ‹© (ç»­)

```{python}
data.iloc[[2, 1]] # æŒ‰ä½ç½®é€‰æ‹©å¤šè¡Œ
```

## ä½¿ç”¨ `loc` å’Œ `iloc` åœ¨ DataFrame ä¸Šè¿›è¡Œé€‰æ‹© (ç»­)

```{python}
data.iloc[2, [3, 0, 1]] # æŒ‰ä½ç½®é€‰æ‹©è¡Œå’Œåˆ—
```

## ä½¿ç”¨ `loc` å’Œ `iloc` åœ¨ DataFrame ä¸Šè¿›è¡Œé€‰æ‹© (ç»­)

```{python}
data.iloc[[1, 2], [3, 0, 1]] # æŒ‰ä½ç½®é€‰æ‹©è¡Œå’Œåˆ—
```

## ç®—æœ¯å’Œæ•°æ®å¯¹é½

-   æ‰§è¡Œç®—æœ¯è¿ç®—æ—¶ï¼Œæ•°æ®æŒ‰ç´¢å¼•æ ‡ç­¾å¯¹é½ã€‚
-   åœ¨æ ‡ç­¾ä¸é‡å çš„åœ°æ–¹ä½¿ç”¨ NaNã€‚

```{python}
s1 = pd.Series([7.3, -2.5, 3.4, 1.5], index=['a', 'c', 'd', 'e'])
s2 = pd.Series([-2.1, 3.6, -1.5, 4, 3.1], index=['a', 'c', 'e', 'f', 'g'])
```

## ç®—æœ¯å’Œæ•°æ®å¯¹é½ (ç»­)

```{python}
s1
```


```{python}
s2
```

## ç®—æœ¯å’Œæ•°æ®å¯¹é½ (ç»­)

```{python}
s1 + s2  # Series ç›¸åŠ ï¼›æŒ‰ç´¢å¼•æ ‡ç­¾å¯¹é½
```

## DataFrame çš„ç®—æœ¯è¿ç®—

```{python}
df1 = pd.DataFrame(np.arange(9.).reshape((3, 3)), columns=list('bcd'),
                   index=['Ohio', 'Texas', 'Colorado'])
df2 = pd.DataFrame(np.arange(12.).reshape((4, 3)), columns=list('bde'),
                   index=['Utah', 'Ohio', 'Texas', 'Oregon'])
```

## DataFrame çš„ç®—æœ¯è¿ç®— (ç»­)

```{python}
df1
```

## DataFrame çš„ç®—æœ¯è¿ç®— (ç»­)

```{python}
df2
```

## DataFrame çš„ç®—æœ¯è¿ç®— (ç»­)

```{python}
df1 + df2  # DataFrame ç›¸åŠ ï¼›æŒ‰è¡Œå’Œåˆ—æ ‡ç­¾å¯¹é½
```

## å…·æœ‰å¡«å……å€¼çš„ç®—æœ¯æ–¹æ³•

```{python}
df1 = pd.DataFrame(np.arange(12.).reshape((3, 4)),
                   columns=list('abcd'))
df2 = pd.DataFrame(np.arange(20.).reshape((4, 5)),
                   columns=list('abcde'))
df2.loc[1, 'b'] = np.nan  # å¼•å…¥ä¸€ä¸ªç¼ºå¤±å€¼
```

## å…·æœ‰å¡«å……å€¼çš„ç®—æœ¯æ–¹æ³• (ç»­)

```{python}
df1
```

## å…·æœ‰å¡«å……å€¼çš„ç®—æœ¯æ–¹æ³• (ç»­)

```{python}
df2
```

## å…·æœ‰å¡«å……å€¼çš„ç®—æœ¯æ–¹æ³• (ç»­)

```{python}
df1 + df2  # ç›¸åŠ ï¼Œå¯èƒ½äº§ç”Ÿ NaN
```

::: {.callout-note}
NaN è¡¨ç¤ºç¼ºå¤±å€¼ã€‚
:::

## ä½¿ç”¨ `add` å’Œ `fill_value`

```{python}
df1.add(df2, fill_value=0)  # ç›¸åŠ ï¼Œåœ¨ç›¸åŠ *ä¹‹å‰*ç”¨ 0 å¡«å……ç¼ºå¤±å€¼
```

::: {.callout-note}
`fill_value` åœ¨è¿ç®—*ä¹‹å‰*æ›¿æ¢ç¼ºå¤±å€¼ã€‚
:::

## çµæ´»çš„ç®—æœ¯æ–¹æ³•

| æ–¹æ³•         | æè¿°                 |
| :----------- | :------------------- |
| `add, radd` | åŠ æ³• (+)             |
| `sub, rsub` | å‡æ³• (-)             |
| `div, rdiv` | é™¤æ³• (/)             |
| `mul, rmul` | ä¹˜æ³• (*)             |

::: {.callout-note}
`r` æ–¹æ³•ï¼šåè½¬å‚æ•°ï¼ˆä¾‹å¦‚ï¼Œ`1 / df1` ç­‰ä»·äº `df1.rdiv(1)`ï¼‰ã€‚
:::

## DataFrame å’Œ Series ä¹‹é—´çš„è¿ç®—

```{python}
frame = pd.DataFrame(np.arange(12.).reshape((4, 3)),
                     columns=list('bde'),
                     index=['Utah', 'Ohio', 'Texas', 'Oregon'])
series = frame.iloc[0] # è·å–ç¬¬ä¸€è¡Œ
```

## DataFrame å’Œ Series ä¹‹é—´çš„è¿ç®— (ç»­)

```{python}
frame
```

## DataFrame å’Œ Series ä¹‹é—´çš„è¿ç®— (ç»­)

```{python}
series
```

## DataFrame å’Œ Series ä¹‹é—´çš„è¿ç®— (ç»­)

```{python}
frame - series  # ä» DataFrame ä¸­å‡å» Seriesï¼ˆå¹¿æ’­ï¼‰
```

::: {.callout-note}
DataFrame å’Œ Series ä¹‹é—´çš„ç®—æœ¯è¿ç®—é»˜è®¤æ²¿è¡Œå¹¿æ’­ã€‚
:::

## è·¨åˆ—å¹¿æ’­

```{python}
series3 = frame['d']  # è·å– 'd' åˆ—
series3
```

## è·¨åˆ—å¹¿æ’­ (ç»­)

```{python}
frame.sub(series3, axis='index')  # åŒ¹é…ç´¢å¼•ï¼ˆè¡Œï¼‰ï¼Œè·¨åˆ—å¹¿æ’­
```

::: {.callout-note}
`axis='index'`ï¼ˆæˆ– `axis=0`ï¼‰è·¨åˆ—å¹¿æ’­ã€‚
:::

## å‡½æ•°åº”ç”¨å’Œæ˜ å°„

```{python}
frame = pd.DataFrame(np.random.standard_normal((4, 3)),
                     columns=list('bde'),
                     index=['Utah', 'Ohio', 'Texas', 'Oregon'])
frame
```

## å‡½æ•°åº”ç”¨å’Œæ˜ å°„ (ç»­)

```{python}
np.abs(frame)  # é€å…ƒç´ åº”ç”¨ NumPy çš„ç»å¯¹å€¼å‡½æ•° (ufunc)
```

## ä½¿ç”¨ `apply` åº”ç”¨å‡½æ•°

```{python}
def f1(x):
    return x.max() - x.min() # å®šä¹‰ä¸€ä¸ªå¯¹ Series è¿›è¡Œæ“ä½œçš„å‡½æ•°

frame.apply(f1)  # æ²¿åˆ—åº”ç”¨å‡½æ•°ï¼ˆé»˜è®¤è½´æ˜¯ 'index'ï¼‰
```

## ä½¿ç”¨ `apply` åº”ç”¨å‡½æ•° (ç»­)

```{python}
frame.apply(f1, axis='columns')  # æ²¿è¡Œåº”ç”¨å‡½æ•° (axis='columns')
```

## åº”ç”¨è¿”å› Series çš„å‡½æ•°

```{python}
def f2(x):
    # å®šä¹‰ä¸€ä¸ªè¿”å›å¸¦æœ‰ 'min' å’Œ 'max' çš„ Series çš„å‡½æ•°
    return pd.Series([x.min(), x.max()], index=['min', 'max'])

frame.apply(f2)
```

## ä½¿ç”¨ `applymap` è¿›è¡Œé€å…ƒç´ æ ¼å¼åŒ–

```{python}
def my_format(x):
    return f"{x:.2f}"  # å®šä¹‰ä¸€ä¸ªæ ¼å¼åŒ–å‡½æ•°

frame.applymap(my_format) # å¯¹ DataFrame é€å…ƒç´ åº”ç”¨
```

::: {.callout-note}
`applymap` ç”¨äº DataFrame çš„é€å…ƒç´ æ“ä½œï¼›`map` ç”¨äº Series çš„é€å…ƒç´ æ“ä½œã€‚
:::

## æ’åº

```{python}
obj = pd.Series(np.arange(4), index=['d', 'a', 'b', 'c'])
obj.sort_index()  # æŒ‰ç´¢å¼•æ ‡ç­¾æ’åº
```

## æ’åº (ç»­)

```{python}
frame = pd.DataFrame(np.arange(8).reshape((2, 4)),
                     index=['three', 'one'],
                     columns=['d', 'a', 'b', 'c'])
frame.sort_index() # æŒ‰è¡Œç´¢å¼•æ’åº
```

## æ’åº (ç»­)

```{python}
frame.sort_index(axis='columns') # æŒ‰åˆ—ç´¢å¼•æ’åº
```

## æ’åº (ç»­)

```{python}
frame.sort_index(axis='columns', ascending=False) # é™åºæ’åº
```

## æŒ‰å€¼æ’åº

```{python}
obj = pd.Series([4, 7, -3, 2])
obj.sort_values()  # æŒ‰å€¼æ’åº
```

## æŒ‰å€¼æ’åº (ç»­)

```{python}
obj = pd.Series([4, np.nan, 7, np.nan, -3, 2])
obj.sort_values()  # ç¼ºå¤±å€¼ (NaN) é»˜è®¤æ’åºåˆ°æœ«å°¾
```

## æŒ‰åˆ—å¯¹ DataFrame æ’åº

```{python}
frame = pd.DataFrame({'b': [4, 7, -3, 2], 'a': [0, 1, 0, 1]})
frame
```

## æŒ‰åˆ—å¯¹ DataFrame æ’åº (ç»­)

```{python}
frame.sort_values('b')  # æŒ‰ 'b' åˆ—æ’åº
```

## æŒ‰åˆ—å¯¹ DataFrame æ’åº (ç»­)

```{python}
frame.sort_values(['a', 'b'])  # æŒ‰å¤šåˆ—æ’åºï¼ˆå…ˆ 'a'ï¼Œå† 'b'ï¼‰
```

## æ’å

```{python}
obj = pd.Series([7, -5, 7, 4, 2, 0, 4])
obj.rank()  # åˆ†é…æ’åï¼ˆå¹³å±€ä½¿ç”¨å¹³å‡æ’åï¼‰
```

::: {.callout-note}
æ’åï¼šåˆ†é…ä» 1 åˆ°æœ‰æ•ˆæ•°æ®ç‚¹æ•°é‡çš„æ’åã€‚
:::

## æ’åæ–¹æ³•

| æ–¹æ³•      | æè¿°                                     |
| :-------- | :--------------------------------------- |
| `average` | é»˜è®¤ï¼šå¹³å±€ä½¿ç”¨å¹³å‡æ’å                    |
| `min`     | ä½¿ç”¨æœ€å°æ’å                            |
| `max`     | ä½¿ç”¨æœ€å¤§æ’å                            |
| `first`   | æŒ‰å€¼å‡ºç°çš„é¡ºåºæ’å                      |

## å…·æœ‰é‡å¤æ ‡ç­¾çš„è½´ç´¢å¼•

```{python}
obj = pd.Series(np.arange(5), index=['a', 'a', 'b', 'b', 'c'])
obj
```

## å…·æœ‰é‡å¤æ ‡ç­¾çš„è½´ç´¢å¼• (ç»­)

```{python}
obj.index.is_unique  # æ£€æŸ¥ç´¢å¼•æ ‡ç­¾æ˜¯å¦å”¯ä¸€
```

## å…·æœ‰é‡å¤æ ‡ç­¾çš„è½´ç´¢å¼• (ç»­)

```{python}
obj['a']  # è¿”å›ä¸€ä¸ª Seriesï¼ˆå› ä¸º 'a' é‡å¤ï¼‰
```

## å…·æœ‰é‡å¤æ ‡ç­¾çš„è½´ç´¢å¼• (ç»­)

```{python}
obj['c']  # è¿”å›ä¸€ä¸ªæ ‡é‡ï¼ˆå› ä¸º 'c' å”¯ä¸€ï¼‰
```

## æ±‡æ€»å’Œè®¡ç®—æè¿°æ€§ç»Ÿè®¡

```{python}
df = pd.DataFrame([[1.4, np.nan], [7.1, -4.5],
                   [np.nan, np.nan], [0.75, -1.3]],
                  index=['a', 'b', 'c', 'd'],
                  columns=['one', 'two'])
df
```

## æ±‡æ€»å’Œè®¡ç®—æè¿°æ€§ç»Ÿè®¡ (ç»­)

```{python}
df.sum()  # è®¡ç®—åˆ—æ€»å’Œ
```

## æ±‡æ€»å’Œè®¡ç®—æè¿°æ€§ç»Ÿè®¡ (ç»­)

```{python}
df.sum(axis='columns')  # è®¡ç®—è¡Œæ€»å’Œ
```

## å¤„ç†å½’çº¦ä¸­çš„ç¼ºå¤±å€¼

```{python}
df.sum(axis='index', skipna=False) # åœ¨è®¡ç®—ä¸­åŒ…å« NaN
```

## å¤„ç†å½’çº¦ä¸­çš„ç¼ºå¤±å€¼ (ç»­)

```{python}
df.mean(axis='columns') # è®¡ç®—å¹³å‡å€¼ï¼Œæ’é™¤ NaNï¼ˆé»˜è®¤ï¼‰
```

## æè¿°æ€§ç»Ÿè®¡ï¼šå½’çº¦æ–¹æ³•çš„é€‰é¡¹

| æ–¹æ³•        | æè¿°                                          |
| :---------- | :-------------------------------------------- |
| `axis`      | è½´ ('index' è¡¨ç¤ºè¡Œ, 'columns' è¡¨ç¤ºåˆ—)        |
| `skipna`    | æ’é™¤ç¼ºå¤±å€¼ (é»˜è®¤ä¸º True)                     |

## é—´æ¥ç»Ÿè®¡

```{python}
df.idxmax()  # æœ€å¤§å€¼çš„ç´¢å¼•æ ‡ç­¾ï¼ˆå¯¹äºæ¯åˆ—ï¼‰
```

## é—´æ¥ç»Ÿè®¡ (ç»­)

```{python}
df.cumsum()  # ç´¯ç§¯å’Œï¼ˆå¯¹äºæ¯åˆ—ï¼‰
```

## `describe()` æ–¹æ³•

```{python}
df.describe()  # ç”Ÿæˆæè¿°æ€§ç»Ÿè®¡
```

## `describe()` æ–¹æ³• (ç»­)

```{python}
obj = pd.Series(['a', 'a', 'b', 'c'] * 4)
obj.describe() # éæ•°å€¼æ•°æ®çš„æè¿°æ€§ç»Ÿè®¡
```

## æè¿°æ€§å’Œæ±‡æ€»ç»Ÿè®¡

| æ–¹æ³•             | æè¿°                                         |
| :----------------- | :------------------------------------------ |
| `count`            | é NA å€¼çš„æ•°é‡                              |
| `describe`         | è®¡ç®—ä¸€ç»„æ±‡æ€»ç»Ÿè®¡                            |
| `min, max`         | è®¡ç®—æœ€å°å€¼å’Œæœ€å¤§å€¼                          |
| `idxmin, idxmax`   | è®¡ç®—è¾¾åˆ°æœ€å°å€¼/æœ€å¤§å€¼çš„ç´¢å¼•æ ‡ç­¾          |
| `quantile`         | è®¡ç®—æ ·æœ¬åˆ†ä½æ•° (0 åˆ° 1)                     |
| `sum`              | æ±‚å’Œ                                        |
| `mean`             | å¹³å‡å€¼                                      |
| `median`           | ä¸­ä½æ•° (50% åˆ†ä½æ•°)                         |
| ...                | ...                                         |

## ç›¸å…³æ€§å’Œåæ–¹å·®
é¦–å…ˆåŠ è½½æ•°æ®

```{python}
price = pd.read_pickle('examples/yahoo_price.pkl')
volume = pd.read_pickle('examples/yahoo_volume.pkl')
```

## ç›¸å…³æ€§å’Œåæ–¹å·® (ç»­)

```{python}
returns = price.pct_change() # å˜åŒ–ç™¾åˆ†æ¯”
returns.tail()
```

## ç›¸å…³æ€§å’Œåæ–¹å·® (ç»­)

```{python}
returns['MSFT'].corr(returns['IBM']) # MSFT å’Œ IBM æ”¶ç›Šç‡ä¹‹é—´çš„ç›¸å…³æ€§
```

## ç›¸å…³æ€§å’Œåæ–¹å·® (ç»­)

```{python}
returns['MSFT'].cov(returns['IBM'])  # MSFT å’Œ IBM æ”¶ç›Šç‡ä¹‹é—´çš„åæ–¹å·®
```

::: {.callout-note}
`corr`ï¼šç›¸å…³æ€§ã€‚`cov`ï¼šåæ–¹å·®ã€‚
:::

## DataFrame ä¸Šçš„ `corr` å’Œ `cov`

```{python}
returns.corr()  # ç›¸å…³çŸ©é˜µ
```

## `corr` å’Œ `cov` on DataFrame (ç»­)

```{python}
returns.cov()  # åæ–¹å·®çŸ©é˜µ
```

## `corrwith` æ–¹æ³•

```{python}
returns.corrwith(returns['IBM'])  # ä¸ IBM æ”¶ç›Šç‡çš„æˆå¯¹ç›¸å…³æ€§
```

## `corrwith` æ–¹æ³• (ç»­)

```{python}
returns.corrwith(volume)  # ä¸æˆäº¤é‡çš„æˆå¯¹ç›¸å…³æ€§
```

::: {.callout-note}
è®¡ç®—æˆå¯¹ç›¸å…³æ€§ã€‚
:::

## å”¯ä¸€å€¼ã€å€¼è®¡æ•°å’Œæˆå‘˜èµ„æ ¼

```{python}
obj = pd.Series(['c', 'a', 'd', 'a', 'a', 'b', 'b', 'c', 'c'])
uniques = obj.unique()  # è·å–å”¯ä¸€å€¼
uniques
```

## å”¯ä¸€å€¼ã€å€¼è®¡æ•°å’Œæˆå‘˜èµ„æ ¼ (ç»­)

```{python}
obj.value_counts()  # è®¡ç®—æ¯ä¸ªå€¼çš„å‡ºç°æ¬¡æ•°
```
## å”¯ä¸€å€¼ã€å€¼è®¡æ•°å’Œæˆå‘˜èµ„æ ¼ (ç»­)

```{python}
pd.value_counts(obj.to_numpy(), sort=False) #ä½¿ç”¨pd.value_counts()
```

## `isin` æ–¹æ³•

```{python}
obj
```
## `isin` æ–¹æ³•(ç»­)

```{python}
mask = obj.isin(['b', 'c'])  # æ£€æŸ¥æ˜¯å¦å±äº ['b', 'c']
mask
```

## `isin` æ–¹æ³• (ç»­)

```{python}
obj[mask]  # é€‰æ‹© mask ä¸º True çš„å…ƒç´ 
```

::: {.callout-note}
`isin`ï¼šæ£€æŸ¥æˆå‘˜èµ„æ ¼ã€‚
:::



## æ€»ç»“

*   æˆ‘ä»¬å­¦ä¹ äº† pandas çš„åŸºç¡€æ•°æ®ç»“æ„ï¼š**Series** å’Œ **DataFrame**ã€‚
*   æŒæ¡äº†å…³é”®æ“ä½œï¼š**ç´¢å¼•**ã€**é€‰æ‹©**ã€**è¿‡æ»¤**ã€**ç®—æœ¯è¿ç®—**ã€**å‡½æ•°åº”ç”¨**ã€**æ’åº**ã€**æ’å**ä»¥åŠ**æè¿°æ€§ç»Ÿè®¡**ã€‚
*   äº†è§£äº†å¦‚ä½•**å¤„ç†ç¼ºå¤±æ•°æ®**ã€‚

## æ€è€ƒä¸è®¨è®º

*   å¯¹æ¯” pandas å’Œå…¶ä»–æ•°æ®åˆ†æå·¥å…· (ä¾‹å¦‚ Excel, R)ï¼Œå„è‡ªçš„ä¼˜åŠ¿å’ŒåŠ£åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ
*   åœ¨å®é™…å·¥ä½œä¸­ï¼Œæœ‰å“ªäº› pandas çš„åº”ç”¨åœºæ™¯ï¼Ÿ
*   pandas æœ‰å“ªäº›å±€é™æ€§ï¼Ÿ åœ¨ä»€ä¹ˆæƒ…å†µä¸‹åº”è¯¥é€‰æ‹©å…¶ä»–å·¥å…·ï¼Ÿ
*   æ•°æ®å¯¹é½å’Œå¹¿æ’­åœ¨ pandas ä¸­ä¸ºä½•å¦‚æ­¤é‡è¦ï¼Ÿ


